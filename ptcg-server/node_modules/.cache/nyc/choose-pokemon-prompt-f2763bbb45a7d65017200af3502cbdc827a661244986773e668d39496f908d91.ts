"use strict";function cov_himlme6x8(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-pokemon-prompt.ts";var hash="bdaa8d87bd1c8064657a4c8d9a847bc229f873a8";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-pokemon-prompt.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:71}},"2":{start:{line:4,column:17},end:{line:4,column:36}},"3":{start:{line:5,column:27},end:{line:5,column:65}},"4":{start:{line:6,column:21},end:{line:6,column:48}},"5":{start:{line:7,column:23},end:{line:7,column:52}},"6":{start:{line:8,column:22},end:{line:8,column:47}},"7":{start:{line:9,column:0},end:{line:9,column:51}},"8":{start:{line:12,column:8},end:{line:12,column:24}},"9":{start:{line:13,column:8},end:{line:13,column:31}},"10":{start:{line:14,column:8},end:{line:14,column:37}},"11":{start:{line:15,column:8},end:{line:15,column:27}},"12":{start:{line:16,column:8},end:{line:16,column:52}},"13":{start:{line:18,column:8},end:{line:23,column:20}},"14":{start:{line:26,column:8},end:{line:28,column:9}},"15":{start:{line:27,column:12},end:{line:27,column:26}},"16":{start:{line:29,column:23},end:{line:29,column:70}},"17":{start:{line:29,column:47},end:{line:29,column:69}},"18":{start:{line:30,column:25},end:{line:30,column:72}},"19":{start:{line:30,column:49},end:{line:30,column:71}},"20":{start:{line:31,column:8},end:{line:33,column:9}},"21":{start:{line:32,column:12},end:{line:32,column:95}},"22":{start:{line:34,column:8},end:{line:37,column:11}},"23":{start:{line:35,column:22},end:{line:35,column:103}},"24":{start:{line:36,column:12},end:{line:36,column:105}},"25":{start:{line:40,column:8},end:{line:42,column:9}},"26":{start:{line:41,column:12},end:{line:41,column:44}},"27":{start:{line:43,column:8},end:{line:45,column:9}},"28":{start:{line:44,column:12},end:{line:44,column:25}},"29":{start:{line:46,column:8},end:{line:48,column:9}},"30":{start:{line:46,column:36},end:{line:46,column:63}},"31":{start:{line:47,column:12},end:{line:47,column:25}},"32":{start:{line:49,column:23},end:{line:49,column:70}},"33":{start:{line:49,column:47},end:{line:49,column:69}},"34":{start:{line:50,column:8},end:{line:52,column:9}},"35":{start:{line:51,column:12},end:{line:51,column:25}},"36":{start:{line:53,column:24},end:{line:53,column:107}},"37":{start:{line:53,column:54},end:{line:53,column:106}},"38":{start:{line:54,column:8},end:{line:56,column:9}},"39":{start:{line:54,column:29},end:{line:54,column:48}},"40":{start:{line:55,column:12},end:{line:55,column:25}},"41":{start:{line:57,column:8},end:{line:57,column:20}},"42":{start:{line:60,column:0},end:{line:60,column:50}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:4},end:{line:11,column:5}},loc:{start:{line:11,column:63},end:{line:24,column:5}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:25,column:4},end:{line:25,column:5}},loc:{start:{line:25,column:26},end:{line:38,column:5}},line:25},"2":{name:"(anonymous_2)",decl:{start:{line:29,column:42},end:{line:29,column:43}},loc:{start:{line:29,column:47},end:{line:29,column:69}},line:29},"3":{name:"(anonymous_3)",decl:{start:{line:30,column:44},end:{line:30,column:45}},loc:{start:{line:30,column:49},end:{line:30,column:71}},line:30},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:26},end:{line:34,column:27}},loc:{start:{line:34,column:36},end:{line:37,column:9}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:39,column:4},end:{line:39,column:5}},loc:{start:{line:39,column:28},end:{line:58,column:5}},line:39},"6":{name:"(anonymous_6)",decl:{start:{line:46,column:24},end:{line:46,column:25}},loc:{start:{line:46,column:36},end:{line:46,column:63}},line:46},"7":{name:"(anonymous_7)",decl:{start:{line:49,column:42},end:{line:49,column:43}},loc:{start:{line:49,column:47},end:{line:49,column:69}},line:49},"8":{name:"(anonymous_8)",decl:{start:{line:53,column:49},end:{line:53,column:50}},loc:{start:{line:53,column:54},end:{line:53,column:106}},line:53},"9":{name:"(anonymous_9)",decl:{start:{line:54,column:24},end:{line:54,column:25}},loc:{start:{line:54,column:29},end:{line:54,column:48}},line:54}},branchMap:{"0":{loc:{start:{line:26,column:8},end:{line:28,column:9}},type:"if",locations:[{start:{line:26,column:8},end:{line:28,column:9}},{start:{line:26,column:8},end:{line:28,column:9}}],line:26},"1":{loc:{start:{line:31,column:8},end:{line:33,column:9}},type:"if",locations:[{start:{line:31,column:8},end:{line:33,column:9}},{start:{line:31,column:8},end:{line:33,column:9}}],line:31},"2":{loc:{start:{line:31,column:12},end:{line:31,column:58}},type:"binary-expr",locations:[{start:{line:31,column:12},end:{line:31,column:32}},{start:{line:31,column:36},end:{line:31,column:58}}],line:31},"3":{loc:{start:{line:35,column:22},end:{line:35,column:103}},type:"cond-expr",locations:[{start:{line:35,column:86},end:{line:35,column:92}},{start:{line:35,column:95},end:{line:35,column:103}}],line:35},"4":{loc:{start:{line:36,column:19},end:{line:36,column:104}},type:"cond-expr",locations:[{start:{line:36,column:72},end:{line:36,column:80}},{start:{line:36,column:83},end:{line:36,column:104}}],line:36},"5":{loc:{start:{line:40,column:8},end:{line:42,column:9}},type:"if",locations:[{start:{line:40,column:8},end:{line:42,column:9}},{start:{line:40,column:8},end:{line:42,column:9}}],line:40},"6":{loc:{start:{line:43,column:8},end:{line:45,column:9}},type:"if",locations:[{start:{line:43,column:8},end:{line:45,column:9}},{start:{line:43,column:8},end:{line:45,column:9}}],line:43},"7":{loc:{start:{line:43,column:12},end:{line:43,column:80}},type:"binary-expr",locations:[{start:{line:43,column:12},end:{line:43,column:44}},{start:{line:43,column:48},end:{line:43,column:80}}],line:43},"8":{loc:{start:{line:46,column:8},end:{line:48,column:9}},type:"if",locations:[{start:{line:46,column:8},end:{line:48,column:9}},{start:{line:46,column:8},end:{line:48,column:9}}],line:46},"9":{loc:{start:{line:50,column:8},end:{line:52,column:9}},type:"if",locations:[{start:{line:50,column:8},end:{line:52,column:9}},{start:{line:50,column:8},end:{line:52,column:9}}],line:50},"10":{loc:{start:{line:54,column:8},end:{line:56,column:9}},type:"if",locations:[{start:{line:54,column:8},end:{line:56,column:9}},{start:{line:54,column:8},end:{line:56,column:9}}],line:54}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-pokemon-prompt.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-pokemon-prompt.ts"],names:[],mappings:"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",sourcesContent:["import { Prompt } from './prompt';\nimport { PlayerType, SlotType, CardTarget } from '../actions/play-card-action';\nimport { PokemonCardList } from '../state/pokemon-card-list';\nimport { State } from '../state/state';\nimport { GameError } from '../../game-error';\nimport { GameMessage } from '../../game-message';\nimport { StateUtils } from '../state-utils';\n\nexport const ChoosePokemonPromptType = 'Choose pokemon';\n\nexport interface ChoosePokemonOptions {\n  min: number;\n  max: number;\n  allowCancel: boolean;\n  blocked: CardTarget[];\n}\n\nexport class ChoosePokemonPrompt extends Prompt<PokemonCardList[]> {\n\n  readonly type: string = ChoosePokemonPromptType;\n\n  public options: ChoosePokemonOptions;\n\n  constructor(\n    playerId: number,\n    public message: GameMessage,\n    public playerType: PlayerType,\n    public slots: SlotType[],\n    options?: Partial<ChoosePokemonOptions>\n  ) {\n    super(playerId);\n\n    // Default options\n    this.options = Object.assign({}, {\n      min: 1,\n      max: 1,\n      allowCancel: true,\n      blocked: []\n    }, options);\n  }\n\n  public decode(result: CardTarget[] | null, state: State): PokemonCardList[] | null {\n    if (result === null) {\n      return result;  // operation cancelled\n    }\n    const player = state.players.find(p => p.id === this.playerId);\n    const opponent = state.players.find(p => p.id !== this.playerId);\n    if (player === undefined || opponent === undefined) {\n      throw new GameError(GameMessage.INVALID_PROMPT_RESULT);\n    }\n    return result.map(target => {\n      const p = target.player === PlayerType.BOTTOM_PLAYER ? player : opponent;\n      return target.slot === SlotType.ACTIVE ? p.active : p.bench[target.index];\n    });\n  }\n\n  public validate(result: PokemonCardList[] | null, state: State): boolean {\n    if (result === null) {\n      return this.options.allowCancel;\n    }\n    if (result.length < this.options.min || result.length > this.options.max) {\n      return false;\n    }\n    if (result.some(cardList => cardList.cards.length === 0)) {\n      return false;\n    }\n    const player = state.players.find(p => p.id === this.playerId);\n    if (player === undefined) {\n      return false;\n    }\n    const blocked = this.options.blocked.map(b => StateUtils.getTarget(state, player, b));\n    if (result.some(r => blocked.includes(r))) {\n      return false;\n    }\n    return true;\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"bdaa8d87bd1c8064657a4c8d9a847bc229f873a8"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_himlme6x8=function(){return actualCoverage;};}return actualCoverage;}cov_himlme6x8();cov_himlme6x8().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_himlme6x8().s[1]++;exports.ChoosePokemonPrompt=exports.ChoosePokemonPromptType=void 0;const prompt_1=(cov_himlme6x8().s[2]++,require("./prompt"));const play_card_action_1=(cov_himlme6x8().s[3]++,require("../actions/play-card-action"));const game_error_1=(cov_himlme6x8().s[4]++,require("../../game-error"));const game_message_1=(cov_himlme6x8().s[5]++,require("../../game-message"));const state_utils_1=(cov_himlme6x8().s[6]++,require("../state-utils"));cov_himlme6x8().s[7]++;exports.ChoosePokemonPromptType='Choose pokemon';class ChoosePokemonPrompt extends(prompt_1.Prompt){constructor(playerId,message,playerType,slots,options){cov_himlme6x8().f[0]++;cov_himlme6x8().s[8]++;super(playerId);cov_himlme6x8().s[9]++;this.message=message;cov_himlme6x8().s[10]++;this.playerType=playerType;cov_himlme6x8().s[11]++;this.slots=slots;cov_himlme6x8().s[12]++;this.type=exports.ChoosePokemonPromptType;// Default options
cov_himlme6x8().s[13]++;this.options=Object.assign({},{min:1,max:1,allowCancel:true,blocked:[]},options);}decode(result,state){cov_himlme6x8().f[1]++;cov_himlme6x8().s[14]++;if(result===null){cov_himlme6x8().b[0][0]++;cov_himlme6x8().s[15]++;return result;// operation cancelled
}else{cov_himlme6x8().b[0][1]++;}const player=(cov_himlme6x8().s[16]++,state.players.find(p=>{cov_himlme6x8().f[2]++;cov_himlme6x8().s[17]++;return p.id===this.playerId;}));const opponent=(cov_himlme6x8().s[18]++,state.players.find(p=>{cov_himlme6x8().f[3]++;cov_himlme6x8().s[19]++;return p.id!==this.playerId;}));cov_himlme6x8().s[20]++;if((cov_himlme6x8().b[2][0]++,player===undefined)||(cov_himlme6x8().b[2][1]++,opponent===undefined)){cov_himlme6x8().b[1][0]++;cov_himlme6x8().s[21]++;throw new game_error_1.GameError(game_message_1.GameMessage.INVALID_PROMPT_RESULT);}else{cov_himlme6x8().b[1][1]++;}cov_himlme6x8().s[22]++;return result.map(target=>{cov_himlme6x8().f[4]++;const p=(cov_himlme6x8().s[23]++,target.player===play_card_action_1.PlayerType.BOTTOM_PLAYER?(cov_himlme6x8().b[3][0]++,player):(cov_himlme6x8().b[3][1]++,opponent));cov_himlme6x8().s[24]++;return target.slot===play_card_action_1.SlotType.ACTIVE?(cov_himlme6x8().b[4][0]++,p.active):(cov_himlme6x8().b[4][1]++,p.bench[target.index]);});}validate(result,state){cov_himlme6x8().f[5]++;cov_himlme6x8().s[25]++;if(result===null){cov_himlme6x8().b[5][0]++;cov_himlme6x8().s[26]++;return this.options.allowCancel;}else{cov_himlme6x8().b[5][1]++;}cov_himlme6x8().s[27]++;if((cov_himlme6x8().b[7][0]++,result.length<this.options.min)||(cov_himlme6x8().b[7][1]++,result.length>this.options.max)){cov_himlme6x8().b[6][0]++;cov_himlme6x8().s[28]++;return false;}else{cov_himlme6x8().b[6][1]++;}cov_himlme6x8().s[29]++;if(result.some(cardList=>{cov_himlme6x8().f[6]++;cov_himlme6x8().s[30]++;return cardList.cards.length===0;})){cov_himlme6x8().b[8][0]++;cov_himlme6x8().s[31]++;return false;}else{cov_himlme6x8().b[8][1]++;}const player=(cov_himlme6x8().s[32]++,state.players.find(p=>{cov_himlme6x8().f[7]++;cov_himlme6x8().s[33]++;return p.id===this.playerId;}));cov_himlme6x8().s[34]++;if(player===undefined){cov_himlme6x8().b[9][0]++;cov_himlme6x8().s[35]++;return false;}else{cov_himlme6x8().b[9][1]++;}const blocked=(cov_himlme6x8().s[36]++,this.options.blocked.map(b=>{cov_himlme6x8().f[8]++;cov_himlme6x8().s[37]++;return state_utils_1.StateUtils.getTarget(state,player,b);}));cov_himlme6x8().s[38]++;if(result.some(r=>{cov_himlme6x8().f[9]++;cov_himlme6x8().s[39]++;return blocked.includes(r);})){cov_himlme6x8().b[10][0]++;cov_himlme6x8().s[40]++;return false;}else{cov_himlme6x8().b[10][1]++;}cov_himlme6x8().s[41]++;return true;}}cov_himlme6x8().s[42]++;exports.ChoosePokemonPrompt=ChoosePokemonPrompt;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcHJvbXB0cy9jaG9vc2UtcG9rZW1vbi1wcm9tcHQudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvY2hvb3NlLXBva2Vtb24tcHJvbXB0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHFDQUFrQztBQUNsQyxrRUFBK0U7QUFHL0UsaURBQTZDO0FBQzdDLHFEQUFpRDtBQUNqRCxnREFBNEM7QUFFL0IsUUFBQSx1QkFBdUIsR0FBRyxnQkFBZ0IsQ0FBQztBQVN4RCxNQUFhLG1CQUFvQixTQUFRLGVBQXlCO0lBTWhFLFlBQ0UsUUFBZ0IsRUFDVCxPQUFvQixFQUNwQixVQUFzQixFQUN0QixLQUFpQixFQUN4QixPQUF1QztRQUV2QyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7UUFMVCxZQUFPLEdBQVAsT0FBTyxDQUFhO1FBQ3BCLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsVUFBSyxHQUFMLEtBQUssQ0FBWTtRQVJqQixTQUFJLEdBQVcsK0JBQXVCLENBQUM7UUFhOUMsa0JBQWtCO1FBQ2xCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUU7WUFDL0IsR0FBRyxFQUFFLENBQUM7WUFDTixHQUFHLEVBQUUsQ0FBQztZQUNOLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLE9BQU8sRUFBRSxFQUFFO1NBQ1osRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNkLENBQUM7SUFFTSxNQUFNLENBQUMsTUFBMkIsRUFBRSxLQUFZO1FBQ3JELElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtZQUNuQixPQUFPLE1BQU0sQ0FBQyxDQUFFLHNCQUFzQjtTQUN2QztRQUNELE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDL0QsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNqRSxJQUFJLE1BQU0sS0FBSyxTQUFTLElBQUksUUFBUSxLQUFLLFNBQVMsRUFBRTtZQUNsRCxNQUFNLElBQUksc0JBQVMsQ0FBQywwQkFBVyxDQUFDLHFCQUFxQixDQUFDLENBQUM7U0FDeEQ7UUFDRCxPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDekIsTUFBTSxDQUFDLEdBQUcsTUFBTSxDQUFDLE1BQU0sS0FBSyw2QkFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7WUFDekUsT0FBTyxNQUFNLENBQUMsSUFBSSxLQUFLLDJCQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1RSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFTSxRQUFRLENBQUMsTUFBZ0MsRUFBRSxLQUFZO1FBQzVELElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO1NBQ2pDO1FBQ0QsSUFBSSxNQUFNLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxJQUFJLE1BQU0sQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUU7WUFDeEUsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUNELElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxFQUFFO1lBQ3hELE9BQU8sS0FBSyxDQUFDO1NBQ2Q7UUFDRCxNQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQy9ELElBQUksTUFBTSxLQUFLLFNBQVMsRUFBRTtZQUN4QixPQUFPLEtBQUssQ0FBQztTQUNkO1FBQ0QsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsd0JBQVUsQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RGLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUN6QyxPQUFPLEtBQUssQ0FBQztTQUNkO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0NBRUY7QUE1REQsa0RBNERDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi9wcm9tcHQnO1xuaW1wb3J0IHsgUGxheWVyVHlwZSwgU2xvdFR5cGUsIENhcmRUYXJnZXQgfSBmcm9tICcuLi9hY3Rpb25zL3BsYXktY2FyZC1hY3Rpb24nO1xuaW1wb3J0IHsgUG9rZW1vbkNhcmRMaXN0IH0gZnJvbSAnLi4vc3RhdGUvcG9rZW1vbi1jYXJkLWxpc3QnO1xuaW1wb3J0IHsgU3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9zdGF0ZSc7XG5pbXBvcnQgeyBHYW1lRXJyb3IgfSBmcm9tICcuLi8uLi9nYW1lLWVycm9yJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IFN0YXRlVXRpbHMgfSBmcm9tICcuLi9zdGF0ZS11dGlscyc7XG5cbmV4cG9ydCBjb25zdCBDaG9vc2VQb2tlbW9uUHJvbXB0VHlwZSA9ICdDaG9vc2UgcG9rZW1vbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hvb3NlUG9rZW1vbk9wdGlvbnMge1xuICBtaW46IG51bWJlcjtcbiAgbWF4OiBudW1iZXI7XG4gIGFsbG93Q2FuY2VsOiBib29sZWFuO1xuICBibG9ja2VkOiBDYXJkVGFyZ2V0W107XG59XG5cbmV4cG9ydCBjbGFzcyBDaG9vc2VQb2tlbW9uUHJvbXB0IGV4dGVuZHMgUHJvbXB0PFBva2Vtb25DYXJkTGlzdFtdPiB7XG5cbiAgcmVhZG9ubHkgdHlwZTogc3RyaW5nID0gQ2hvb3NlUG9rZW1vblByb21wdFR5cGU7XG5cbiAgcHVibGljIG9wdGlvbnM6IENob29zZVBva2Vtb25PcHRpb25zO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBsYXllcklkOiBudW1iZXIsXG4gICAgcHVibGljIG1lc3NhZ2U6IEdhbWVNZXNzYWdlLFxuICAgIHB1YmxpYyBwbGF5ZXJUeXBlOiBQbGF5ZXJUeXBlLFxuICAgIHB1YmxpYyBzbG90czogU2xvdFR5cGVbXSxcbiAgICBvcHRpb25zPzogUGFydGlhbDxDaG9vc2VQb2tlbW9uT3B0aW9ucz5cbiAgKSB7XG4gICAgc3VwZXIocGxheWVySWQpO1xuXG4gICAgLy8gRGVmYXVsdCBvcHRpb25zXG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwge1xuICAgICAgbWluOiAxLFxuICAgICAgbWF4OiAxLFxuICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXG4gICAgICBibG9ja2VkOiBbXVxuICAgIH0sIG9wdGlvbnMpO1xuICB9XG5cbiAgcHVibGljIGRlY29kZShyZXN1bHQ6IENhcmRUYXJnZXRbXSB8IG51bGwsIHN0YXRlOiBTdGF0ZSk6IFBva2Vtb25DYXJkTGlzdFtdIHwgbnVsbCB7XG4gICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHJlc3VsdDsgIC8vIG9wZXJhdGlvbiBjYW5jZWxsZWRcbiAgICB9XG4gICAgY29uc3QgcGxheWVyID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gdGhpcy5wbGF5ZXJJZCk7XG4gICAgY29uc3Qgb3Bwb25lbnQgPSBzdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwLmlkICE9PSB0aGlzLnBsYXllcklkKTtcbiAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQgfHwgb3Bwb25lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTlZBTElEX1BST01QVF9SRVNVTFQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0Lm1hcCh0YXJnZXQgPT4ge1xuICAgICAgY29uc3QgcCA9IHRhcmdldC5wbGF5ZXIgPT09IFBsYXllclR5cGUuQk9UVE9NX1BMQVlFUiA/IHBsYXllciA6IG9wcG9uZW50O1xuICAgICAgcmV0dXJuIHRhcmdldC5zbG90ID09PSBTbG90VHlwZS5BQ1RJVkUgPyBwLmFjdGl2ZSA6IHAuYmVuY2hbdGFyZ2V0LmluZGV4XTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyB2YWxpZGF0ZShyZXN1bHQ6IFBva2Vtb25DYXJkTGlzdFtdIHwgbnVsbCwgc3RhdGU6IFN0YXRlKTogYm9vbGVhbiB7XG4gICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5hbGxvd0NhbmNlbDtcbiAgICB9XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPCB0aGlzLm9wdGlvbnMubWluIHx8IHJlc3VsdC5sZW5ndGggPiB0aGlzLm9wdGlvbnMubWF4KSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChyZXN1bHQuc29tZShjYXJkTGlzdCA9PiBjYXJkTGlzdC5jYXJkcy5sZW5ndGggPT09IDApKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHRoaXMucGxheWVySWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBibG9ja2VkID0gdGhpcy5vcHRpb25zLmJsb2NrZWQubWFwKGIgPT4gU3RhdGVVdGlscy5nZXRUYXJnZXQoc3RhdGUsIHBsYXllciwgYikpO1xuICAgIGlmIChyZXN1bHQuc29tZShyID0+IGJsb2NrZWQuaW5jbHVkZXMocikpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvY2hvb3NlLXBva2Vtb24tcHJvbXB0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJpeVhBbUJXO21RQW5CWCxLQUFBLENBQUEsUUFBQSx5QkFBQSxPQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsa0JBQUEseUJBQUEsT0FBQSxDQUFBLDZCQUFBLENBQUEsQ0FBQSxDQUdBLEtBQUEsQ0FBQSxZQUFBLHlCQUFBLE9BQUEsQ0FBQSxrQkFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsY0FBQSx5QkFBQSxPQUFBLENBQUEsb0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGFBQUEseUJBQUEsT0FBQSxDQUFBLGdCQUFBLENBQUEsQ0FBQSxDLHVCQUVhLE9BQUEsQ0FBQSx1QkFBQSxDQUEwQixnQkFBMUIsQ0FTYixLQUFhLENBQUEsbUJBQWIsU0FBeUMsUUFBQSxDQUFBLE1BQXpDLENBQWtFLENBTWhFLFdBQUEsQ0FDRSxRQURGLENBRVMsT0FGVCxDQUdTLFVBSFQsQ0FJUyxLQUpULENBS0UsT0FMRixDQUt5QywrQ0FFdkMsTUFBTSxRQUFOLEVBRnVDLHVCQUhoQyxLQUFBLE9BQUEsQ0FBQSxPQUFBLENBR2dDLHdCQUZoQyxLQUFBLFVBQUEsQ0FBQSxVQUFBLENBRWdDLHdCQURoQyxLQUFBLEtBQUEsQ0FBQSxLQUFBLENBQ2dDLHdCQVRoQyxLQUFBLElBQUEsQ0FBZSxPQUFBLENBQUEsdUJBQWYsQ0FhUDtBQUp1Qyx3QkFLdkMsS0FBSyxPQUFMLENBQWUsTUFBTSxDQUFDLE1BQVAsQ0FBYyxFQUFkLENBQWtCLENBQy9CLEdBQUcsQ0FBRSxDQUQwQixDQUUvQixHQUFHLENBQUUsQ0FGMEIsQ0FHL0IsV0FBVyxDQUFFLElBSGtCLENBSS9CLE9BQU8sQ0FBRSxFQUpzQixDQUFsQixD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ZjRELHdCQWtCNUQsTUFBTyxLQUFQLENBQ0QsQ0ExRCtELEMsd0JBQWxFLE9BQUEsQ0FBQSxtQkFBQSxDQUFBLG1CQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcm9tcHQgfSBmcm9tICcuL3Byb21wdCc7XG5pbXBvcnQgeyBQbGF5ZXJUeXBlLCBTbG90VHlwZSwgQ2FyZFRhcmdldCB9IGZyb20gJy4uL2FjdGlvbnMvcGxheS1jYXJkLWFjdGlvbic7XG5pbXBvcnQgeyBQb2tlbW9uQ2FyZExpc3QgfSBmcm9tICcuLi9zdGF0ZS9wb2tlbW9uLWNhcmQtbGlzdCc7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3N0YXRlJztcbmltcG9ydCB7IEdhbWVFcnJvciB9IGZyb20gJy4uLy4uL2dhbWUtZXJyb3InO1xuaW1wb3J0IHsgR2FtZU1lc3NhZ2UgfSBmcm9tICcuLi8uLi9nYW1lLW1lc3NhZ2UnO1xuaW1wb3J0IHsgU3RhdGVVdGlscyB9IGZyb20gJy4uL3N0YXRlLXV0aWxzJztcblxuZXhwb3J0IGNvbnN0IENob29zZVBva2Vtb25Qcm9tcHRUeXBlID0gJ0Nob29zZSBwb2tlbW9uJztcblxuZXhwb3J0IGludGVyZmFjZSBDaG9vc2VQb2tlbW9uT3B0aW9ucyB7XG4gIG1pbjogbnVtYmVyO1xuICBtYXg6IG51bWJlcjtcbiAgYWxsb3dDYW5jZWw6IGJvb2xlYW47XG4gIGJsb2NrZWQ6IENhcmRUYXJnZXRbXTtcbn1cblxuZXhwb3J0IGNsYXNzIENob29zZVBva2Vtb25Qcm9tcHQgZXh0ZW5kcyBQcm9tcHQ8UG9rZW1vbkNhcmRMaXN0W10+IHtcblxuICByZWFkb25seSB0eXBlOiBzdHJpbmcgPSBDaG9vc2VQb2tlbW9uUHJvbXB0VHlwZTtcblxuICBwdWJsaWMgb3B0aW9uczogQ2hvb3NlUG9rZW1vbk9wdGlvbnM7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcGxheWVySWQ6IG51bWJlcixcbiAgICBwdWJsaWMgbWVzc2FnZTogR2FtZU1lc3NhZ2UsXG4gICAgcHVibGljIHBsYXllclR5cGU6IFBsYXllclR5cGUsXG4gICAgcHVibGljIHNsb3RzOiBTbG90VHlwZVtdLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPENob29zZVBva2Vtb25PcHRpb25zPlxuICApIHtcbiAgICBzdXBlcihwbGF5ZXJJZCk7XG5cbiAgICAvLyBEZWZhdWx0IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgICBtaW46IDEsXG4gICAgICBtYXg6IDEsXG4gICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcbiAgICAgIGJsb2NrZWQ6IFtdXG4gICAgfSwgb3B0aW9ucyk7XG4gIH1cblxuICBwdWJsaWMgZGVjb2RlKHJlc3VsdDogQ2FyZFRhcmdldFtdIHwgbnVsbCwgc3RhdGU6IFN0YXRlKTogUG9rZW1vbkNhcmRMaXN0W10gfCBudWxsIHtcbiAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gcmVzdWx0OyAgLy8gb3BlcmF0aW9uIGNhbmNlbGxlZFxuICAgIH1cbiAgICBjb25zdCBwbGF5ZXIgPSBzdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSB0aGlzLnBsYXllcklkKTtcbiAgICBjb25zdCBvcHBvbmVudCA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgIT09IHRoaXMucGxheWVySWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCB8fCBvcHBvbmVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklOVkFMSURfUFJPTVBUX1JFU1VMVCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQubWFwKHRhcmdldCA9PiB7XG4gICAgICBjb25zdCBwID0gdGFyZ2V0LnBsYXllciA9PT0gUGxheWVyVHlwZS5CT1RUT01fUExBWUVSID8gcGxheWVyIDogb3Bwb25lbnQ7XG4gICAgICByZXR1cm4gdGFyZ2V0LnNsb3QgPT09IFNsb3RUeXBlLkFDVElWRSA/IHAuYWN0aXZlIDogcC5iZW5jaFt0YXJnZXQuaW5kZXhdO1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHZhbGlkYXRlKHJlc3VsdDogUG9rZW1vbkNhcmRMaXN0W10gfCBudWxsLCBzdGF0ZTogU3RhdGUpOiBib29sZWFuIHtcbiAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmFsbG93Q2FuY2VsO1xuICAgIH1cbiAgICBpZiAocmVzdWx0Lmxlbmd0aCA8IHRoaXMub3B0aW9ucy5taW4gfHwgcmVzdWx0Lmxlbmd0aCA+IHRoaXMub3B0aW9ucy5tYXgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHJlc3VsdC5zb21lKGNhcmRMaXN0ID0+IGNhcmRMaXN0LmNhcmRzLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgcGxheWVyID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gdGhpcy5wbGF5ZXJJZCk7XG4gICAgaWYgKHBsYXllciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGJsb2NrZWQgPSB0aGlzLm9wdGlvbnMuYmxvY2tlZC5tYXAoYiA9PiBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCBiKSk7XG4gICAgaWYgKHJlc3VsdC5zb21lKHIgPT4gYmxvY2tlZC5pbmNsdWRlcyhyKSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxufVxuIl19