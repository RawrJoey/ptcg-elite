"use strict";function cov_3fje8wkfl(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/attack-effect.ts";var hash="6a6ef146c07482efd336d5b7b351710b760f2009";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/attack-effect.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:31}},"2":{start:{line:4,column:21},end:{line:4,column:48}},"3":{start:{line:5,column:23},end:{line:5,column:52}},"4":{start:{line:6,column:25},end:{line:6,column:61}},"5":{start:{line:7,column:23},end:{line:7,column:57}},"6":{start:{line:8,column:22},end:{line:8,column:47}},"7":{start:{line:10,column:4},end:{line:23,column:5}},"8":{start:{line:11,column:23},end:{line:11,column:36}},"9":{start:{line:12,column:28},end:{line:12,column:51}},"10":{start:{line:13,column:8},end:{line:15,column:9}},"11":{start:{line:14,column:12},end:{line:14,column:88}},"12":{start:{line:16,column:23},end:{line:16,column:49}},"13":{start:{line:17,column:8},end:{line:17,column:32}},"14":{start:{line:18,column:8},end:{line:22,column:9}},"15":{start:{line:19,column:38},end:{line:19,column:105}},"16":{start:{line:20,column:12},end:{line:20,column:53}},"17":{start:{line:21,column:12},end:{line:21,column:57}},"18":{start:{line:24,column:4},end:{line:35,column:5}},"19":{start:{line:25,column:21},end:{line:25,column:40}},"20":{start:{line:26,column:30},end:{line:26,column:91}},"21":{start:{line:27,column:8},end:{line:27,column:45}},"22":{start:{line:28,column:8},end:{line:28,column:59}},"23":{start:{line:29,column:8},end:{line:29,column:63}},"24":{start:{line:30,column:8},end:{line:30,column:57}},"25":{start:{line:31,column:27},end:{line:31,column:91}},"26":{start:{line:32,column:8},end:{line:32,column:42}},"27":{start:{line:33,column:8},end:{line:33,column:54}},"28":{start:{line:34,column:8},end:{line:34,column:21}},"29":{start:{line:36,column:4},end:{line:44,column:5}},"30":{start:{line:37,column:23},end:{line:37,column:36}},"31":{start:{line:38,column:28},end:{line:38,column:51}},"32":{start:{line:39,column:8},end:{line:41,column:9}},"33":{start:{line:40,column:12},end:{line:40,column:88}},"34":{start:{line:42,column:23},end:{line:42,column:49}},"35":{start:{line:43,column:8},end:{line:43,column:32}},"36":{start:{line:45,column:4},end:{line:51,column:5}},"37":{start:{line:46,column:23},end:{line:46,column:36}},"38":{start:{line:47,column:22},end:{line:47,column:34}},"39":{start:{line:48,column:22},end:{line:48,column:71}},"40":{start:{line:49,column:8},end:{line:49,column:49}},"41":{start:{line:50,column:8},end:{line:50,column:21}},"42":{start:{line:52,column:4},end:{line:56,column:5}},"43":{start:{line:53,column:23},end:{line:53,column:36}},"44":{start:{line:54,column:8},end:{line:54,column:72}},"45":{start:{line:55,column:8},end:{line:55,column:21}},"46":{start:{line:57,column:4},end:{line:63,column:5}},"47":{start:{line:58,column:23},end:{line:58,column:36}},"48":{start:{line:59,column:22},end:{line:59,column:71}},"49":{start:{line:60,column:27},end:{line:60,column:86}},"50":{start:{line:61,column:8},end:{line:61,column:54}},"51":{start:{line:62,column:8},end:{line:62,column:21}},"52":{start:{line:64,column:4},end:{line:73,column:5}},"53":{start:{line:65,column:23},end:{line:65,column:36}},"54":{start:{line:66,column:8},end:{line:68,column:11}},"55":{start:{line:67,column:12},end:{line:67,column:43}},"56":{start:{line:69,column:8},end:{line:71,column:9}},"57":{start:{line:70,column:12},end:{line:70,column:54}},"58":{start:{line:72,column:8},end:{line:72,column:21}},"59":{start:{line:74,column:4},end:{line:80,column:5}},"60":{start:{line:75,column:23},end:{line:75,column:36}},"61":{start:{line:76,column:8},end:{line:78,column:11}},"62":{start:{line:77,column:12},end:{line:77,column:46}},"63":{start:{line:79,column:8},end:{line:79,column:21}},"64":{start:{line:81,column:4},end:{line:81,column:17}},"65":{start:{line:83,column:0},end:{line:83,column:38}}},fnMap:{"0":{name:"attackReducer",decl:{start:{line:9,column:9},end:{line:9,column:22}},loc:{start:{line:9,column:45},end:{line:82,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:66,column:41},end:{line:66,column:42}},loc:{start:{line:66,column:47},end:{line:68,column:9}},line:66},"2":{name:"(anonymous_2)",decl:{start:{line:76,column:41},end:{line:76,column:42}},loc:{start:{line:76,column:47},end:{line:78,column:9}},line:76}},branchMap:{"0":{loc:{start:{line:10,column:4},end:{line:23,column:5}},type:"if",locations:[{start:{line:10,column:4},end:{line:23,column:5}},{start:{line:10,column:4},end:{line:23,column:5}}],line:10},"1":{loc:{start:{line:13,column:8},end:{line:15,column:9}},type:"if",locations:[{start:{line:13,column:8},end:{line:15,column:9}},{start:{line:13,column:8},end:{line:15,column:9}}],line:13},"2":{loc:{start:{line:18,column:8},end:{line:22,column:9}},type:"if",locations:[{start:{line:18,column:8},end:{line:22,column:9}},{start:{line:18,column:8},end:{line:22,column:9}}],line:18},"3":{loc:{start:{line:24,column:4},end:{line:35,column:5}},type:"if",locations:[{start:{line:24,column:4},end:{line:35,column:5}},{start:{line:24,column:4},end:{line:35,column:5}}],line:24},"4":{loc:{start:{line:36,column:4},end:{line:44,column:5}},type:"if",locations:[{start:{line:36,column:4},end:{line:44,column:5}},{start:{line:36,column:4},end:{line:44,column:5}}],line:36},"5":{loc:{start:{line:39,column:8},end:{line:41,column:9}},type:"if",locations:[{start:{line:39,column:8},end:{line:41,column:9}},{start:{line:39,column:8},end:{line:41,column:9}}],line:39},"6":{loc:{start:{line:45,column:4},end:{line:51,column:5}},type:"if",locations:[{start:{line:45,column:4},end:{line:51,column:5}},{start:{line:45,column:4},end:{line:51,column:5}}],line:45},"7":{loc:{start:{line:52,column:4},end:{line:56,column:5}},type:"if",locations:[{start:{line:52,column:4},end:{line:56,column:5}},{start:{line:52,column:4},end:{line:56,column:5}}],line:52},"8":{loc:{start:{line:57,column:4},end:{line:63,column:5}},type:"if",locations:[{start:{line:57,column:4},end:{line:63,column:5}},{start:{line:57,column:4},end:{line:63,column:5}}],line:57},"9":{loc:{start:{line:64,column:4},end:{line:73,column:5}},type:"if",locations:[{start:{line:64,column:4},end:{line:73,column:5}},{start:{line:64,column:4},end:{line:73,column:5}}],line:64},"10":{loc:{start:{line:69,column:8},end:{line:71,column:9}},type:"if",locations:[{start:{line:69,column:8},end:{line:71,column:9}},{start:{line:69,column:8},end:{line:71,column:9}}],line:69},"11":{loc:{start:{line:74,column:4},end:{line:80,column:5}},type:"if",locations:[{start:{line:74,column:4},end:{line:80,column:5}},{start:{line:74,column:4},end:{line:80,column:5}}],line:74}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/attack-effect.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/attack-effect.ts"],names:[],mappings:"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",sourcesContent:["import { GameError } from '../../game-error';\nimport { GameMessage } from '../../game-message';\nimport { Effect } from '../effects/effect';\nimport { State } from '../state/state';\nimport { StoreLike } from '../store-like';\nimport { PutDamageEffect, DealDamageEffect, DiscardCardsEffect,\n  AddMarkerEffect, HealTargetEffect, AddSpecialConditionsEffect,\n  RemoveSpecialConditionsEffect, ApplyWeaknessEffect, AfterDamageEffect,\n  PutCountersEffect } from '../effects/attack-effects';\nimport { HealEffect } from '../effects/game-effects';\nimport { StateUtils } from '../state-utils';\n\nexport function attackReducer(store: StoreLike, state: State, effect: Effect): State {\n\n  if (effect instanceof PutDamageEffect) {\n    const target = effect.target;\n    const pokemonCard = target.getPokemonCard();\n    if (pokemonCard === undefined) {\n      throw new GameError(GameMessage.ILLEGAL_ACTION);\n    }\n\n    const damage = Math.max(0, effect.damage);\n    target.damage += damage;\n\n    if (damage > 0) {\n      const afterDamageEffect = new AfterDamageEffect(effect.attackEffect, damage);\n      afterDamageEffect.target = effect.target;\n      store.reduceEffect(state, afterDamageEffect);\n    }\n  }\n\n  if (effect instanceof DealDamageEffect) {\n    const base = effect.attackEffect;\n\n    const applyWeakness = new ApplyWeaknessEffect(base, effect.damage);\n    applyWeakness.target = effect.target;\n    applyWeakness.ignoreWeakness = base.ignoreWeakness;\n    applyWeakness.ignoreResistance = base.ignoreResistance;\n    state = store.reduceEffect(state, applyWeakness);\n\n    const dealDamage = new PutDamageEffect(base, applyWeakness.damage);\n    dealDamage.target = effect.target;\n    state = store.reduceEffect(state, dealDamage);\n\n    return state;\n  }\n\n  if (effect instanceof PutCountersEffect) {\n    const target = effect.target;\n    const pokemonCard = target.getPokemonCard();\n    if (pokemonCard === undefined) {\n      throw new GameError(GameMessage.ILLEGAL_ACTION);\n    }\n\n    const damage = Math.max(0, effect.damage);\n    target.damage += damage;\n  }\n\n  if (effect instanceof DiscardCardsEffect) {\n    const target = effect.target;\n    const cards = effect.cards;\n    const owner = StateUtils.findOwner(state, target);\n    target.moveCardsTo(cards, owner.discard);\n    return state;\n  }\n\n  if (effect instanceof AddMarkerEffect) {\n    const target = effect.target;\n    target.marker.addMarker(effect.markerName, effect.markerSource);\n    return state;\n  }\n\n  if (effect instanceof HealTargetEffect) {\n    const target = effect.target;\n    const owner = StateUtils.findOwner(state, target);\n    const healEffect = new HealEffect(owner, target, effect.damage);\n    state = store.reduceEffect(state, healEffect);\n    return state;\n  }\n\n  if (effect instanceof AddSpecialConditionsEffect) {\n    const target = effect.target;\n    effect.specialConditions.forEach(sp => {\n      target.addSpecialCondition(sp);\n    });\n    if (effect.poisonDamage !== undefined) {\n      target.poisonDamage = effect.poisonDamage;\n    }\n    return state;\n  }\n\n  if (effect instanceof RemoveSpecialConditionsEffect) {\n    const target = effect.target;\n    effect.specialConditions.forEach(sp => {\n      target.removeSpecialCondition(sp);\n    });\n    return state;\n  }\n\n  return state;\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6a6ef146c07482efd336d5b7b351710b760f2009"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_3fje8wkfl=function(){return actualCoverage;};}return actualCoverage;}cov_3fje8wkfl();cov_3fje8wkfl().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_3fje8wkfl().s[1]++;exports.attackReducer=void 0;const game_error_1=(cov_3fje8wkfl().s[2]++,require("../../game-error"));const game_message_1=(cov_3fje8wkfl().s[3]++,require("../../game-message"));const attack_effects_1=(cov_3fje8wkfl().s[4]++,require("../effects/attack-effects"));const game_effects_1=(cov_3fje8wkfl().s[5]++,require("../effects/game-effects"));const state_utils_1=(cov_3fje8wkfl().s[6]++,require("../state-utils"));function attackReducer(store,state,effect){cov_3fje8wkfl().f[0]++;cov_3fje8wkfl().s[7]++;if(effect instanceof attack_effects_1.PutDamageEffect){cov_3fje8wkfl().b[0][0]++;const target=(cov_3fje8wkfl().s[8]++,effect.target);const pokemonCard=(cov_3fje8wkfl().s[9]++,target.getPokemonCard());cov_3fje8wkfl().s[10]++;if(pokemonCard===undefined){cov_3fje8wkfl().b[1][0]++;cov_3fje8wkfl().s[11]++;throw new game_error_1.GameError(game_message_1.GameMessage.ILLEGAL_ACTION);}else{cov_3fje8wkfl().b[1][1]++;}const damage=(cov_3fje8wkfl().s[12]++,Math.max(0,effect.damage));cov_3fje8wkfl().s[13]++;target.damage+=damage;cov_3fje8wkfl().s[14]++;if(damage>0){cov_3fje8wkfl().b[2][0]++;const afterDamageEffect=(cov_3fje8wkfl().s[15]++,new attack_effects_1.AfterDamageEffect(effect.attackEffect,damage));cov_3fje8wkfl().s[16]++;afterDamageEffect.target=effect.target;cov_3fje8wkfl().s[17]++;store.reduceEffect(state,afterDamageEffect);}else{cov_3fje8wkfl().b[2][1]++;}}else{cov_3fje8wkfl().b[0][1]++;}cov_3fje8wkfl().s[18]++;if(effect instanceof attack_effects_1.DealDamageEffect){cov_3fje8wkfl().b[3][0]++;const base=(cov_3fje8wkfl().s[19]++,effect.attackEffect);const applyWeakness=(cov_3fje8wkfl().s[20]++,new attack_effects_1.ApplyWeaknessEffect(base,effect.damage));cov_3fje8wkfl().s[21]++;applyWeakness.target=effect.target;cov_3fje8wkfl().s[22]++;applyWeakness.ignoreWeakness=base.ignoreWeakness;cov_3fje8wkfl().s[23]++;applyWeakness.ignoreResistance=base.ignoreResistance;cov_3fje8wkfl().s[24]++;state=store.reduceEffect(state,applyWeakness);const dealDamage=(cov_3fje8wkfl().s[25]++,new attack_effects_1.PutDamageEffect(base,applyWeakness.damage));cov_3fje8wkfl().s[26]++;dealDamage.target=effect.target;cov_3fje8wkfl().s[27]++;state=store.reduceEffect(state,dealDamage);cov_3fje8wkfl().s[28]++;return state;}else{cov_3fje8wkfl().b[3][1]++;}cov_3fje8wkfl().s[29]++;if(effect instanceof attack_effects_1.PutCountersEffect){cov_3fje8wkfl().b[4][0]++;const target=(cov_3fje8wkfl().s[30]++,effect.target);const pokemonCard=(cov_3fje8wkfl().s[31]++,target.getPokemonCard());cov_3fje8wkfl().s[32]++;if(pokemonCard===undefined){cov_3fje8wkfl().b[5][0]++;cov_3fje8wkfl().s[33]++;throw new game_error_1.GameError(game_message_1.GameMessage.ILLEGAL_ACTION);}else{cov_3fje8wkfl().b[5][1]++;}const damage=(cov_3fje8wkfl().s[34]++,Math.max(0,effect.damage));cov_3fje8wkfl().s[35]++;target.damage+=damage;}else{cov_3fje8wkfl().b[4][1]++;}cov_3fje8wkfl().s[36]++;if(effect instanceof attack_effects_1.DiscardCardsEffect){cov_3fje8wkfl().b[6][0]++;const target=(cov_3fje8wkfl().s[37]++,effect.target);const cards=(cov_3fje8wkfl().s[38]++,effect.cards);const owner=(cov_3fje8wkfl().s[39]++,state_utils_1.StateUtils.findOwner(state,target));cov_3fje8wkfl().s[40]++;target.moveCardsTo(cards,owner.discard);cov_3fje8wkfl().s[41]++;return state;}else{cov_3fje8wkfl().b[6][1]++;}cov_3fje8wkfl().s[42]++;if(effect instanceof attack_effects_1.AddMarkerEffect){cov_3fje8wkfl().b[7][0]++;const target=(cov_3fje8wkfl().s[43]++,effect.target);cov_3fje8wkfl().s[44]++;target.marker.addMarker(effect.markerName,effect.markerSource);cov_3fje8wkfl().s[45]++;return state;}else{cov_3fje8wkfl().b[7][1]++;}cov_3fje8wkfl().s[46]++;if(effect instanceof attack_effects_1.HealTargetEffect){cov_3fje8wkfl().b[8][0]++;const target=(cov_3fje8wkfl().s[47]++,effect.target);const owner=(cov_3fje8wkfl().s[48]++,state_utils_1.StateUtils.findOwner(state,target));const healEffect=(cov_3fje8wkfl().s[49]++,new game_effects_1.HealEffect(owner,target,effect.damage));cov_3fje8wkfl().s[50]++;state=store.reduceEffect(state,healEffect);cov_3fje8wkfl().s[51]++;return state;}else{cov_3fje8wkfl().b[8][1]++;}cov_3fje8wkfl().s[52]++;if(effect instanceof attack_effects_1.AddSpecialConditionsEffect){cov_3fje8wkfl().b[9][0]++;const target=(cov_3fje8wkfl().s[53]++,effect.target);cov_3fje8wkfl().s[54]++;effect.specialConditions.forEach(sp=>{cov_3fje8wkfl().f[1]++;cov_3fje8wkfl().s[55]++;target.addSpecialCondition(sp);});cov_3fje8wkfl().s[56]++;if(effect.poisonDamage!==undefined){cov_3fje8wkfl().b[10][0]++;cov_3fje8wkfl().s[57]++;target.poisonDamage=effect.poisonDamage;}else{cov_3fje8wkfl().b[10][1]++;}cov_3fje8wkfl().s[58]++;return state;}else{cov_3fje8wkfl().b[9][1]++;}cov_3fje8wkfl().s[59]++;if(effect instanceof attack_effects_1.RemoveSpecialConditionsEffect){cov_3fje8wkfl().b[11][0]++;const target=(cov_3fje8wkfl().s[60]++,effect.target);cov_3fje8wkfl().s[61]++;effect.specialConditions.forEach(sp=>{cov_3fje8wkfl().f[2]++;cov_3fje8wkfl().s[62]++;target.removeSpecialCondition(sp);});cov_3fje8wkfl().s[63]++;return state;}else{cov_3fje8wkfl().b[11][1]++;}cov_3fje8wkfl().s[64]++;return state;}cov_3fje8wkfl().s[65]++;exports.attackReducer=attackReducer;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvZWZmZWN0LXJlZHVjZXJzL2F0dGFjay1lZmZlY3QudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL2VmZmVjdC1yZWR1Y2Vycy9hdHRhY2stZWZmZWN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLGlEQUE2QztBQUM3QyxxREFBaUQ7QUFJakQsOERBR3VEO0FBQ3ZELDBEQUFxRDtBQUNyRCxnREFBNEM7QUFFNUMsU0FBZ0IsYUFBYSxDQUFDLEtBQWdCLEVBQUUsS0FBWSxFQUFFLE1BQWM7SUFFMUUsSUFBSSxNQUFNLFlBQVksZ0NBQWUsRUFBRTtRQUNyQyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO1FBQzdCLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUM1QyxJQUFJLFdBQVcsS0FBSyxTQUFTLEVBQUU7WUFDN0IsTUFBTSxJQUFJLHNCQUFTLENBQUMsMEJBQVcsQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUNqRDtRQUVELE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMxQyxNQUFNLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQztRQUV4QixJQUFJLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDZCxNQUFNLGlCQUFpQixHQUFHLElBQUksa0NBQWlCLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxNQUFNLENBQUMsQ0FBQztZQUM3RSxpQkFBaUIsQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztZQUN6QyxLQUFLLENBQUMsWUFBWSxDQUFDLEtBQUssRUFBRSxp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Q0FBQyxtQkFBbUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNqQyxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksTUFBTSxDQUFDLFlBQVksS0FBSyxTQUFTLEVBQUU7WUFDckMsTUFBTSxDQUFDLFlBQVksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDO1NBQzNDO1FBQ0QsT0FBTyxLQUFLLENBQUM7S0FDZDtJQUVELElBQUksTUFBTSxZQUFZLDhDQUE2QixFQUFFO1FBQ25ELE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDN0IsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRTtZQUNwQyxNQUFNLENBQUMsc0JBQXNCLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFDSCxPQUFPLEtBQUssQ0FBQztLQUNkO0lBRUQsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBeEZELHNDQXdGQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdhbWVFcnJvciB9IGZyb20gJy4uLy4uL2dhbWUtZXJyb3InO1xuaW1wb3J0IHsgR2FtZU1lc3NhZ2UgfSBmcm9tICcuLi8uLi9nYW1lLW1lc3NhZ2UnO1xuaW1wb3J0IHsgRWZmZWN0IH0gZnJvbSAnLi4vZWZmZWN0cy9lZmZlY3QnO1xuaW1wb3J0IHsgU3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9zdGF0ZSc7XG5pbXBvcnQgeyBTdG9yZUxpa2UgfSBmcm9tICcuLi9zdG9yZS1saWtlJztcbmltcG9ydCB7IFB1dERhbWFnZUVmZmVjdCwgRGVhbERhbWFnZUVmZmVjdCwgRGlzY2FyZENhcmRzRWZmZWN0LFxuICBBZGRNYXJrZXJFZmZlY3QsIEhlYWxUYXJnZXRFZmZlY3QsIEFkZFNwZWNpYWxDb25kaXRpb25zRWZmZWN0LFxuICBSZW1vdmVTcGVjaWFsQ29uZGl0aW9uc0VmZmVjdCwgQXBwbHlXZWFrbmVzc0VmZmVjdCwgQWZ0ZXJEYW1hZ2VFZmZlY3QsXG4gIFB1dENvdW50ZXJzRWZmZWN0IH0gZnJvbSAnLi4vZWZmZWN0cy9hdHRhY2stZWZmZWN0cyc7XG5pbXBvcnQgeyBIZWFsRWZmZWN0IH0gZnJvbSAnLi4vZWZmZWN0cy9nYW1lLWVmZmVjdHMnO1xuaW1wb3J0IHsgU3RhdGVVdGlscyB9IGZyb20gJy4uL3N0YXRlLXV0aWxzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGF0dGFja1JlZHVjZXIoc3RvcmU6IFN0b3JlTGlrZSwgc3RhdGU6IFN0YXRlLCBlZmZlY3Q6IEVmZmVjdCk6IFN0YXRlIHtcblxuICBpZiAoZWZmZWN0IGluc3RhbmNlb2YgUHV0RGFtYWdlRWZmZWN0KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZWZmZWN0LnRhcmdldDtcbiAgICBjb25zdCBwb2tlbW9uQ2FyZCA9IHRhcmdldC5nZXRQb2tlbW9uQ2FyZCgpO1xuICAgIGlmIChwb2tlbW9uQ2FyZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklMTEVHQUxfQUNUSU9OKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYW1hZ2UgPSBNYXRoLm1heCgwLCBlZmZlY3QuZGFtYWdlKTtcbiAgICB0YXJnZXQuZGFtYWdlICs9IGRhbWFnZTtcblxuICAgIGlmIChkYW1hZ2UgPiAwKSB7XG4gICAgICBjb25zdCBhZnRlckRhbWFnZUVmZmVjdCA9IG5ldyBBZnRlckRhbWFnZUVmZmVjdChlZmZlY3QuYXR0YWNrRWZmZWN0LCBkYW1hZ2UpO1xuICAgICAgYWZ0ZXJEYW1hZ2VFZmZlY3QudGFyZ2V0ID0gZWZmZWN0LnRhcmdldDtcbiAgICAgIHN0b3JlLnJlZHVjZUVmZmVjdChzdGF0ZSwgYWZ0ZXJEYW1hZ2VFZmZlY3QpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChlZmZlY3QgaW5zdGFuY2VvZiBEZWFsRGFtYWdlRWZmZWN0KSB7XG4gICAgY29uc3QgYmFzZSA9IGVmZmVjdC5hdHRhY2tFZmZlY3Q7XG5cbiAgICBjb25zdCBhcHBseVdlYWtuZXNzID0gbmV3IEFwcGx5V2Vha25lc3NFZmZlY3QoYmFzZSwgZWZmZWN0LmRhbWFnZSk7XG4gICAgYXBwbHlXZWFrbmVzcy50YXJnZXQgPSBlZmZlY3QudGFyZ2V0O1xuICAgIGFwcGx5V2Vha25lc3MuaWdub3JlV2Vha25lc3MgPSBiYXNlLmlnbm9yZVdlYWtuZXNzO1xuICAgIGFwcGx5V2Vha25lc3MuaWdub3JlUmVzaXN0YW5jZSA9IGJhc2UuaWdub3JlUmVzaXN0YW5jZTtcbiAgICBzdGF0ZSA9IHN0b3JlLnJlZHVjZUVmZmVjdChzdGF0ZSwgYXBwbHlXZWFrbmVzcyk7XG5cbiAgICBjb25zdCBkZWFsRGFtYWdlID0gbmV3IFB1dERhbWFnZUVmZmVjdChiYXNlLCBhcHBseVdlYWtuZXNzLmRhbWFnZSk7XG4gICAgZGVhbERhbWFnZS50YXJnZXQgPSBlZmZlY3QudGFyZ2V0O1xuICAgIHN0YXRlID0gc3RvcmUucmVkdWNlRWZmZWN0KHN0YXRlLCBkZWFsRGFtYWdlKTtcblxuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIGlmIChlZmZlY3QgaW5zdGFuY2VvZiBQdXRDb3VudGVyc0VmZmVjdCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgY29uc3QgcG9rZW1vbkNhcmQgPSB0YXJnZXQuZ2V0UG9rZW1vbkNhcmQoKTtcbiAgICBpZiAocG9rZW1vbkNhcmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTExFR0FMX0FDVElPTik7XG4gICAgfVxuXG4gICAgY29uc3QgZGFtYWdlID0gTWF0aC5tYXgoMCwgZWZmZWN0LmRhbWFnZSk7XG4gICAgdGFyZ2V0LmRhbWFnZSArPSBkYW1hZ2U7XG4gIH1cblxuICBpZiAoZWZmZWN0IGluc3RhbmNlb2YgRGlzY2FyZENhcmRzRWZmZWN0KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZWZmZWN0LnRhcmdldDtcbiAgICBjb25zdCBjYXJkcyA9IGVmZmVjdC5jYXJkcztcbiAgICBjb25zdCBvd25lciA9IFN0YXRlVXRpbHMuZmluZE93bmVyKHN0YXRlLCB0YXJnZXQpO1xuICAgIHRhcmdldC5tb3ZlQ2FyZHNUbyhjYXJkcywgb3duZXIuZGlzY2FyZCk7XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgaWYgKGVmZmVjdCBpbnN0YW5jZW9mIEFkZE1hcmtlckVmZmVjdCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgdGFyZ2V0Lm1hcmtlci5hZGRNYXJrZXIoZWZmZWN0Lm1hcmtlck5hbWUsIGVmZmVjdC5tYXJrZXJTb3VyY2UpO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIGlmIChlZmZlY3QgaW5zdGFuY2VvZiBIZWFsVGFyZ2V0RWZmZWN0KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZWZmZWN0LnRhcmdldDtcbiAgICBjb25zdCBvd25lciA9IFN0YXRlVXRpbHMuZmluZE93bmVyKHN0YXRlLCB0YXJnZXQpO1xuICAgIGNvbnN0IGhlYWxFZmZlY3QgPSBuZXcgSGVhbEVmZmVjdChvd25lciwgdGFyZ2V0LCBlZmZlY3QuZGFtYWdlKTtcbiAgICBzdGF0ZSA9IHN0b3JlLnJlZHVjZUVmZmVjdChzdGF0ZSwgaGVhbEVmZmVjdCk7XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgaWYgKGVmZmVjdCBpbnN0YW5jZW9mIEFkZFNwZWNpYWxDb25kaXRpb25zRWZmZWN0KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZWZmZWN0LnRhcmdldDtcbiAgICBlZmZlY3Quc3BlY2lhbENvbmRpdGlvbnMuZm9yRWFjaChzcCA9PiB7XG4gICAgICB0YXJnZXQuYWRkU3BlY2lhbENvbmRpdGlvbihzcCk7XG4gICAgfSk7XG4gICAgaWYgKGVmZmVjdC5wb2lzb25EYW1hZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGFyZ2V0LnBvaXNvbkRhbWFnZSA9IGVmZmVjdC5wb2lzb25EYW1hZ2U7XG4gICAgfVxuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIGlmIChlZmZlY3QgaW5zdGFuY2VvZiBSZW1vdmVTcGVjaWFsQ29uZGl0aW9uc0VmZmVjdCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgZWZmZWN0LnNwZWNpYWxDb25kaXRpb25zLmZvckVhY2goc3AgPT4ge1xuICAgICAgdGFyZ2V0LnJlbW92ZVNwZWNpYWxDb25kaXRpb24oc3ApO1xuICAgIH0pO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHJldHVybiBzdGF0ZTtcbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL2VmZmVjdC1yZWR1Y2Vycy9hdHRhY2stZWZmZWN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJ5NWJBcUJJOzZOQXJCSixLQUFBLENBQUEsWUFBQSx5QkFBQSxPQUFBLENBQUEsa0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGNBQUEseUJBQUEsT0FBQSxDQUFBLG9CQUFBLENBQUEsQ0FBQSxDQUlBLEtBQUEsQ0FBQSxnQkFBQSx5QkFBQSxPQUFBLENBQUEsMkJBQUEsQ0FBQSxDQUFBLENBSUEsS0FBQSxDQUFBLGNBQUEseUJBQUEsT0FBQSxDQUFBLHlCQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxhQUFBLHlCQUFBLE9BQUEsQ0FBQSxnQkFBQSxDQUFBLENBQUEsQ0FFQSxRQUFnQixDQUFBLGFBQWhCLENBQThCLEtBQTlCLENBQWdELEtBQWhELENBQThELE1BQTlELENBQTRFLCtDQUUxRSxHQUFJLE1BQU0sV0FBWSxDQUFBLGdCQUFBLENBQUEsZUFBdEIsQ0FBdUMsMkJBQ3JDLEtBQU0sQ0FBQSxNQUFNLHlCQUFHLE1BQU0sQ0FBQyxNQUFWLENBQVosQ0FDQSxLQUFNLENBQUEsV0FBVyx5QkFBRyxNQUFNLENBQUMsY0FBUCxFQUFILENBQWpCLENBRnFDLHdCQUdyQyxHQUFJLFdBQVcsR0FBSyxTQUFwQixDQUErQixtREFDN0IsS0FBTSxJQUFJLENBQUEsWUFBQSxDQUFBLFNBQUosQ0FBYyxjQUFBLENBQUEsV0FBQSxDQUFZLGNBQTFCLENBQU4sQ0FDRCxDQUZELGdDQUlBLEtBQU0sQ0FBQSxNQUFNLDBCQUFHLElBQUksQ0FBQyxHQUFMLENBQVMsQ0FBVCxDQUFZLE1BQU0sQ0FBQyxNQUFuQixDQUFILENBQVosQ0FQcUMsd0JBUXJDLE1BQU0sQ0FBQyxNQUFQLEVBQWlCLE1BQWpCLENBUnFDLHdCQVVy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QUFBLGdCQUFBLENBQUEsNkJBQXRCLENBQXFELDRCQUNuRCxLQUFNLENBQUEsTUFBTSwwQkFBRyxNQUFNLENBQUMsTUFBVixDQUFaLENBRG1ELHdCQUVuRCxNQUFNLENBQUMsaUJBQVAsQ0FBeUIsT0FBekIsQ0FBaUMsRUFBRSxFQUFHLGdEQUNwQyxNQUFNLENBQUMsc0JBQVAsQ0FBOEIsRUFBOUIsRUFDRCxDQUZELEVBRm1ELHdCQUtuRCxNQUFPLENBQUEsS0FBUCxDQUNELENBTkQsaUNBL0UwRSx3QkF1RjFFLE1BQU8sQ0FBQSxLQUFQLENBQ0QsQyx3QkF4RkQsT0FBQSxDQUFBLGFBQUEsQ0FBQSxhQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHYW1lRXJyb3IgfSBmcm9tICcuLi8uLi9nYW1lLWVycm9yJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IEVmZmVjdCB9IGZyb20gJy4uL2VmZmVjdHMvZWZmZWN0JztcbmltcG9ydCB7IFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvc3RhdGUnO1xuaW1wb3J0IHsgU3RvcmVMaWtlIH0gZnJvbSAnLi4vc3RvcmUtbGlrZSc7XG5pbXBvcnQgeyBQdXREYW1hZ2VFZmZlY3QsIERlYWxEYW1hZ2VFZmZlY3QsIERpc2NhcmRDYXJkc0VmZmVjdCxcbiAgQWRkTWFya2VyRWZmZWN0LCBIZWFsVGFyZ2V0RWZmZWN0LCBBZGRTcGVjaWFsQ29uZGl0aW9uc0VmZmVjdCxcbiAgUmVtb3ZlU3BlY2lhbENvbmRpdGlvbnNFZmZlY3QsIEFwcGx5V2Vha25lc3NFZmZlY3QsIEFmdGVyRGFtYWdlRWZmZWN0LFxuICBQdXRDb3VudGVyc0VmZmVjdCB9IGZyb20gJy4uL2VmZmVjdHMvYXR0YWNrLWVmZmVjdHMnO1xuaW1wb3J0IHsgSGVhbEVmZmVjdCB9IGZyb20gJy4uL2VmZmVjdHMvZ2FtZS1lZmZlY3RzJztcbmltcG9ydCB7IFN0YXRlVXRpbHMgfSBmcm9tICcuLi9zdGF0ZS11dGlscyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBhdHRhY2tSZWR1Y2VyKHN0b3JlOiBTdG9yZUxpa2UsIHN0YXRlOiBTdGF0ZSwgZWZmZWN0OiBFZmZlY3QpOiBTdGF0ZSB7XG5cbiAgaWYgKGVmZmVjdCBpbnN0YW5jZW9mIFB1dERhbWFnZUVmZmVjdCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgY29uc3QgcG9rZW1vbkNhcmQgPSB0YXJnZXQuZ2V0UG9rZW1vbkNhcmQoKTtcbiAgICBpZiAocG9rZW1vbkNhcmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTExFR0FMX0FDVElPTik7XG4gICAgfVxuXG4gICAgY29uc3QgZGFtYWdlID0gTWF0aC5tYXgoMCwgZWZmZWN0LmRhbWFnZSk7XG4gICAgdGFyZ2V0LmRhbWFnZSArPSBkYW1hZ2U7XG5cbiAgICBpZiAoZGFtYWdlID4gMCkge1xuICAgICAgY29uc3QgYWZ0ZXJEYW1hZ2VFZmZlY3QgPSBuZXcgQWZ0ZXJEYW1hZ2VFZmZlY3QoZWZmZWN0LmF0dGFja0VmZmVjdCwgZGFtYWdlKTtcbiAgICAgIGFmdGVyRGFtYWdlRWZmZWN0LnRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgICBzdG9yZS5yZWR1Y2VFZmZlY3Qoc3RhdGUsIGFmdGVyRGFtYWdlRWZmZWN0KTtcbiAgICB9XG4gIH1cblxuICBpZiAoZWZmZWN0IGluc3RhbmNlb2YgRGVhbERhbWFnZUVmZmVjdCkge1xuICAgIGNvbnN0IGJhc2UgPSBlZmZlY3QuYXR0YWNrRWZmZWN0O1xuXG4gICAgY29uc3QgYXBwbHlXZWFrbmVzcyA9IG5ldyBBcHBseVdlYWtuZXNzRWZmZWN0KGJhc2UsIGVmZmVjdC5kYW1hZ2UpO1xuICAgIGFwcGx5V2Vha25lc3MudGFyZ2V0ID0gZWZmZWN0LnRhcmdldDtcbiAgICBhcHBseVdlYWtuZXNzLmlnbm9yZVdlYWtuZXNzID0gYmFzZS5pZ25vcmVXZWFrbmVzcztcbiAgICBhcHBseVdlYWtuZXNzLmlnbm9yZVJlc2lzdGFuY2UgPSBiYXNlLmlnbm9yZVJlc2lzdGFuY2U7XG4gICAgc3RhdGUgPSBzdG9yZS5yZWR1Y2VFZmZlY3Qoc3RhdGUsIGFwcGx5V2Vha25lc3MpO1xuXG4gICAgY29uc3QgZGVhbERhbWFnZSA9IG5ldyBQdXREYW1hZ2VFZmZlY3QoYmFzZSwgYXBwbHlXZWFrbmVzcy5kYW1hZ2UpO1xuICAgIGRlYWxEYW1hZ2UudGFyZ2V0ID0gZWZmZWN0LnRhcmdldDtcbiAgICBzdGF0ZSA9IHN0b3JlLnJlZHVjZUVmZmVjdChzdGF0ZSwgZGVhbERhbWFnZSk7XG5cbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBpZiAoZWZmZWN0IGluc3RhbmNlb2YgUHV0Q291bnRlcnNFZmZlY3QpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBlZmZlY3QudGFyZ2V0O1xuICAgIGNvbnN0IHBva2Vtb25DYXJkID0gdGFyZ2V0LmdldFBva2Vtb25DYXJkKCk7XG4gICAgaWYgKHBva2Vtb25DYXJkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSUxMRUdBTF9BQ1RJT04pO1xuICAgIH1cblxuICAgIGNvbnN0IGRhbWFnZSA9IE1hdGgubWF4KDAsIGVmZmVjdC5kYW1hZ2UpO1xuICAgIHRhcmdldC5kYW1hZ2UgKz0gZGFtYWdlO1xuICB9XG5cbiAgaWYgKGVmZmVjdCBpbnN0YW5jZW9mIERpc2NhcmRDYXJkc0VmZmVjdCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgY29uc3QgY2FyZHMgPSBlZmZlY3QuY2FyZHM7XG4gICAgY29uc3Qgb3duZXIgPSBTdGF0ZVV0aWxzLmZpbmRPd25lcihzdGF0ZSwgdGFyZ2V0KTtcbiAgICB0YXJnZXQubW92ZUNhcmRzVG8oY2FyZHMsIG93bmVyLmRpc2NhcmQpO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIGlmIChlZmZlY3QgaW5zdGFuY2VvZiBBZGRNYXJrZXJFZmZlY3QpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBlZmZlY3QudGFyZ2V0O1xuICAgIHRhcmdldC5tYXJrZXIuYWRkTWFya2VyKGVmZmVjdC5tYXJrZXJOYW1lLCBlZmZlY3QubWFya2VyU291cmNlKTtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBpZiAoZWZmZWN0IGluc3RhbmNlb2YgSGVhbFRhcmdldEVmZmVjdCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgY29uc3Qgb3duZXIgPSBTdGF0ZVV0aWxzLmZpbmRPd25lcihzdGF0ZSwgdGFyZ2V0KTtcbiAgICBjb25zdCBoZWFsRWZmZWN0ID0gbmV3IEhlYWxFZmZlY3Qob3duZXIsIHRhcmdldCwgZWZmZWN0LmRhbWFnZSk7XG4gICAgc3RhdGUgPSBzdG9yZS5yZWR1Y2VFZmZlY3Qoc3RhdGUsIGhlYWxFZmZlY3QpO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIGlmIChlZmZlY3QgaW5zdGFuY2VvZiBBZGRTcGVjaWFsQ29uZGl0aW9uc0VmZmVjdCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGVmZmVjdC50YXJnZXQ7XG4gICAgZWZmZWN0LnNwZWNpYWxDb25kaXRpb25zLmZvckVhY2goc3AgPT4ge1xuICAgICAgdGFyZ2V0LmFkZFNwZWNpYWxDb25kaXRpb24oc3ApO1xuICAgIH0pO1xuICAgIGlmIChlZmZlY3QucG9pc29uRGFtYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRhcmdldC5wb2lzb25EYW1hZ2UgPSBlZmZlY3QucG9pc29uRGFtYWdlO1xuICAgIH1cbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBpZiAoZWZmZWN0IGluc3RhbmNlb2YgUmVtb3ZlU3BlY2lhbENvbmRpdGlvbnNFZmZlY3QpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBlZmZlY3QudGFyZ2V0O1xuICAgIGVmZmVjdC5zcGVjaWFsQ29uZGl0aW9ucy5mb3JFYWNoKHNwID0+IHtcbiAgICAgIHRhcmdldC5yZW1vdmVTcGVjaWFsQ29uZGl0aW9uKHNwKTtcbiAgICB9KTtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICByZXR1cm4gc3RhdGU7XG59XG4iXX0=