"use strict";function cov_1xyb74zab3(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-attack-prompt.ts";var hash="ed02fae463ef8b9ed7628ac24e198cceb0f46814";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-attack-prompt.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:69}},"2":{start:{line:4,column:21},end:{line:4,column:48}},"3":{start:{line:5,column:23},end:{line:5,column:52}},"4":{start:{line:6,column:17},end:{line:6,column:36}},"5":{start:{line:7,column:0},end:{line:7,column:49}},"6":{start:{line:10,column:8},end:{line:10,column:24}},"7":{start:{line:11,column:8},end:{line:11,column:31}},"8":{start:{line:12,column:8},end:{line:12,column:27}},"9":{start:{line:13,column:8},end:{line:13,column:51}},"10":{start:{line:15,column:8},end:{line:19,column:20}},"11":{start:{line:22,column:8},end:{line:24,column:9}},"12":{start:{line:23,column:12},end:{line:23,column:26}},"13":{start:{line:25,column:22},end:{line:25,column:34}},"14":{start:{line:26,column:8},end:{line:28,column:9}},"15":{start:{line:27,column:12},end:{line:27,column:95}},"16":{start:{line:29,column:21},end:{line:29,column:38}},"17":{start:{line:30,column:23},end:{line:30,column:71}},"18":{start:{line:30,column:46},end:{line:30,column:70}},"19":{start:{line:31,column:8},end:{line:33,column:9}},"20":{start:{line:32,column:12},end:{line:32,column:95}},"21":{start:{line:34,column:8},end:{line:34,column:22}},"22":{start:{line:37,column:8},end:{line:39,column:9}},"23":{start:{line:38,column:12},end:{line:38,column:44}},"24":{start:{line:40,column:24},end:{line:45,column:10}},"25":{start:{line:41,column:25},end:{line:41,column:44}},"26":{start:{line:42,column:12},end:{line:44,column:13}},"27":{start:{line:43,column:16},end:{line:43,column:67}},"28":{start:{line:43,column:46},end:{line:43,column:65}},"29":{start:{line:46,column:8},end:{line:48,column:9}},"30":{start:{line:47,column:12},end:{line:47,column:25}},"31":{start:{line:49,column:8},end:{line:49,column:64}},"32":{start:{line:49,column:36},end:{line:49,column:62}},"33":{start:{line:52,column:0},end:{line:52,column:48}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:4},end:{line:9,column:5}},loc:{start:{line:9,column:51},end:{line:20,column:5}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:4},end:{line:21,column:5}},loc:{start:{line:21,column:26},end:{line:35,column:5}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:30,column:41},end:{line:30,column:42}},loc:{start:{line:30,column:46},end:{line:30,column:70}},line:30},"3":{name:"(anonymous_3)",decl:{start:{line:36,column:4},end:{line:36,column:5}},loc:{start:{line:36,column:21},end:{line:50,column:5}},line:36},"4":{name:"(anonymous_4)",decl:{start:{line:40,column:49},end:{line:40,column:50}},loc:{start:{line:40,column:54},end:{line:45,column:9}},line:40},"5":{name:"(anonymous_5)",decl:{start:{line:43,column:41},end:{line:43,column:42}},loc:{start:{line:43,column:46},end:{line:43,column:65}},line:43},"6":{name:"(anonymous_6)",decl:{start:{line:49,column:31},end:{line:49,column:32}},loc:{start:{line:49,column:36},end:{line:49,column:62}},line:49}},branchMap:{"0":{loc:{start:{line:22,column:8},end:{line:24,column:9}},type:"if",locations:[{start:{line:22,column:8},end:{line:24,column:9}},{start:{line:22,column:8},end:{line:24,column:9}}],line:22},"1":{loc:{start:{line:26,column:8},end:{line:28,column:9}},type:"if",locations:[{start:{line:26,column:8},end:{line:28,column:9}},{start:{line:26,column:8},end:{line:28,column:9}}],line:26},"2":{loc:{start:{line:26,column:12},end:{line:26,column:51}},type:"binary-expr",locations:[{start:{line:26,column:12},end:{line:26,column:21}},{start:{line:26,column:25},end:{line:26,column:51}}],line:26},"3":{loc:{start:{line:31,column:8},end:{line:33,column:9}},type:"if",locations:[{start:{line:31,column:8},end:{line:33,column:9}},{start:{line:31,column:8},end:{line:33,column:9}}],line:31},"4":{loc:{start:{line:37,column:8},end:{line:39,column:9}},type:"if",locations:[{start:{line:37,column:8},end:{line:39,column:9}},{start:{line:37,column:8},end:{line:39,column:9}}],line:37},"5":{loc:{start:{line:42,column:12},end:{line:44,column:13}},type:"if",locations:[{start:{line:42,column:12},end:{line:44,column:13}},{start:{line:42,column:12},end:{line:44,column:13}}],line:42},"6":{loc:{start:{line:42,column:16},end:{line:42,column:36}},type:"binary-expr",locations:[{start:{line:42,column:16},end:{line:42,column:20}},{start:{line:42,column:24},end:{line:42,column:36}}],line:42},"7":{loc:{start:{line:46,column:8},end:{line:48,column:9}},type:"if",locations:[{start:{line:46,column:8},end:{line:48,column:9}},{start:{line:46,column:8},end:{line:48,column:9}}],line:46}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-attack-prompt.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-attack-prompt.ts"],names:[],mappings:";;;AAAA,iDAA6C;AAC7C,qDAAiD;AACjD,qCAAkC;AAKrB,QAAA,sBAAsB,GAAG,eAAe,CAAC;AAUtD,MAAa,kBAAmB,SAAQ,eAAc;IAMpD,YACE,QAAgB,EACT,OAAoB,EACpB,KAAoB,EAC3B,OAAsC;QAEtC,KAAK,CAAC,QAAQ,CAAC,CAAC;QAJT,YAAO,GAAP,OAAO,CAAa;QACpB,UAAK,GAAL,KAAK,CAAe;QAPpB,SAAI,GAAW,8BAAsB,CAAC;QAY7C,kBAAkB;QAClB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE;YAC/B,WAAW,EAAE,KAAK;YAClB,cAAc,EAAE,0BAAW,CAAC,iBAAiB;YAC7C,OAAO,EAAE,EAAE;SACZ,EAAE,OAAO,CAAC,CAAC;IACd,CAAC;IAEM,MAAM,CAAC,MAAqC,EAAE,KAAY;QAC/D,IAAI,MAAM,KAAK,IAAI,EAAE;YACnB,OAAO,MAAM,CAAC,CAAE,sBAAsB;SACvC;QACD,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;QAC3B,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;YAC3C,MAAM,IAAI,sBAAS,CAAC,0BAAW,CAAC,qBAAqB,CAAC,CAAC;SACxD;QACD,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC/B,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,MAAM,CAAC,CAAC;QAChE,IAAI,MAAM,KAAK,SAAS,EAAE;YACxB,MAAM,IAAI,sBAAS,CAAC,0BAAW,CAAC,qBAAqB,CAAC,CAAC;SACxD;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAEM,QAAQ,CAAC,MAAqB;QACnC,IAAI,MAAM,KAAK,IAAI,EAAE;YACnB,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAE,sBAAsB;SACzD;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;YAC3C,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YACjC,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;gBACxB,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC;aACpD;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YAC5B,OAAO,KAAK,CAAC;SACd;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;IAC1D,CAAC;CAEF;AAzDD,gDAyDC",sourcesContent:["import { GameError } from '../../game-error';\nimport { GameMessage } from '../../game-message';\nimport { Prompt } from './prompt';\nimport { State } from '../state/state';\nimport { PokemonCard } from '../card/pokemon-card';\nimport { Attack } from '../card/pokemon-types';\n\nexport const ChooseAttackPromptType = 'Choose attack';\n\nexport interface ChooseAttackOptions {\n  allowCancel: boolean;\n  blockedMessage: GameMessage;\n  blocked: { index: number; attack: string }[];\n}\n\nexport type ChooseAttackResultType = {index: number, attack: string};\n\nexport class ChooseAttackPrompt extends Prompt<Attack> {\n\n  readonly type: string = ChooseAttackPromptType;\n\n  public options: ChooseAttackOptions;\n\n  constructor(\n    playerId: number,\n    public message: GameMessage,\n    public cards: PokemonCard[],\n    options?: Partial<ChooseAttackOptions>\n  ) {\n    super(playerId);\n\n    // Default options\n    this.options = Object.assign({}, {\n      allowCancel: false,\n      blockedMessage: GameMessage.NOT_ENOUGH_ENERGY,\n      blocked: []\n    }, options);\n  }\n\n  public decode(result: ChooseAttackResultType | null, state: State): Attack | null {\n    if (result === null) {\n      return result;  // operation cancelled\n    }\n    const index = result.index;\n    if (index < 0 || index >= this.cards.length) {\n      throw new GameError(GameMessage.INVALID_PROMPT_RESULT);\n    }\n    const card = this.cards[index];\n    const attack = card.attacks.find(a => a.name === result.attack);\n    if (attack === undefined) {\n      throw new GameError(GameMessage.INVALID_PROMPT_RESULT);\n    }\n    return attack;\n  }\n\n  public validate(result: Attack | null): boolean {\n    if (result === null) {\n      return this.options.allowCancel;  // operation cancelled\n    }\n\n    const blocked = this.options.blocked.map(b => {\n      const card = this.cards[b.index];\n      if (card && card.attacks) {\n        return card.attacks.find(a => a.name === b.attack);\n      }\n    });\n\n    if (blocked.includes(result)) {\n      return false;\n    }\n\n    return this.cards.some(c => c.attacks.includes(result));\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ed02fae463ef8b9ed7628ac24e198cceb0f46814"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1xyb74zab3=function(){return actualCoverage;};}return actualCoverage;}cov_1xyb74zab3();cov_1xyb74zab3().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1xyb74zab3().s[1]++;exports.ChooseAttackPrompt=exports.ChooseAttackPromptType=void 0;const game_error_1=(cov_1xyb74zab3().s[2]++,require("../../game-error"));const game_message_1=(cov_1xyb74zab3().s[3]++,require("../../game-message"));const prompt_1=(cov_1xyb74zab3().s[4]++,require("./prompt"));cov_1xyb74zab3().s[5]++;exports.ChooseAttackPromptType='Choose attack';class ChooseAttackPrompt extends(prompt_1.Prompt){constructor(playerId,message,cards,options){cov_1xyb74zab3().f[0]++;cov_1xyb74zab3().s[6]++;super(playerId);cov_1xyb74zab3().s[7]++;this.message=message;cov_1xyb74zab3().s[8]++;this.cards=cards;cov_1xyb74zab3().s[9]++;this.type=exports.ChooseAttackPromptType;// Default options
cov_1xyb74zab3().s[10]++;this.options=Object.assign({},{allowCancel:false,blockedMessage:game_message_1.GameMessage.NOT_ENOUGH_ENERGY,blocked:[]},options);}decode(result,state){cov_1xyb74zab3().f[1]++;cov_1xyb74zab3().s[11]++;if(result===null){cov_1xyb74zab3().b[0][0]++;cov_1xyb74zab3().s[12]++;return result;// operation cancelled
}else{cov_1xyb74zab3().b[0][1]++;}const index=(cov_1xyb74zab3().s[13]++,result.index);cov_1xyb74zab3().s[14]++;if((cov_1xyb74zab3().b[2][0]++,index<0)||(cov_1xyb74zab3().b[2][1]++,index>=this.cards.length)){cov_1xyb74zab3().b[1][0]++;cov_1xyb74zab3().s[15]++;throw new game_error_1.GameError(game_message_1.GameMessage.INVALID_PROMPT_RESULT);}else{cov_1xyb74zab3().b[1][1]++;}const card=(cov_1xyb74zab3().s[16]++,this.cards[index]);const attack=(cov_1xyb74zab3().s[17]++,card.attacks.find(a=>{cov_1xyb74zab3().f[2]++;cov_1xyb74zab3().s[18]++;return a.name===result.attack;}));cov_1xyb74zab3().s[19]++;if(attack===undefined){cov_1xyb74zab3().b[3][0]++;cov_1xyb74zab3().s[20]++;throw new game_error_1.GameError(game_message_1.GameMessage.INVALID_PROMPT_RESULT);}else{cov_1xyb74zab3().b[3][1]++;}cov_1xyb74zab3().s[21]++;return attack;}validate(result){cov_1xyb74zab3().f[3]++;cov_1xyb74zab3().s[22]++;if(result===null){cov_1xyb74zab3().b[4][0]++;cov_1xyb74zab3().s[23]++;return this.options.allowCancel;// operation cancelled
}else{cov_1xyb74zab3().b[4][1]++;}const blocked=(cov_1xyb74zab3().s[24]++,this.options.blocked.map(b=>{cov_1xyb74zab3().f[4]++;const card=(cov_1xyb74zab3().s[25]++,this.cards[b.index]);cov_1xyb74zab3().s[26]++;if((cov_1xyb74zab3().b[6][0]++,card)&&(cov_1xyb74zab3().b[6][1]++,card.attacks)){cov_1xyb74zab3().b[5][0]++;cov_1xyb74zab3().s[27]++;return card.attacks.find(a=>{cov_1xyb74zab3().f[5]++;cov_1xyb74zab3().s[28]++;return a.name===b.attack;});}else{cov_1xyb74zab3().b[5][1]++;}}));cov_1xyb74zab3().s[29]++;if(blocked.includes(result)){cov_1xyb74zab3().b[7][0]++;cov_1xyb74zab3().s[30]++;return false;}else{cov_1xyb74zab3().b[7][1]++;}cov_1xyb74zab3().s[31]++;return this.cards.some(c=>{cov_1xyb74zab3().f[6]++;cov_1xyb74zab3().s[32]++;return c.attacks.includes(result);});}}cov_1xyb74zab3().s[33]++;exports.ChooseAttackPrompt=ChooseAttackPrompt;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcHJvbXB0cy9jaG9vc2UtYXR0YWNrLXByb21wdC50cyIsInNvdXJjZXMiOlsiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcHJvbXB0cy9jaG9vc2UtYXR0YWNrLXByb21wdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxpREFBNkM7QUFDN0MscURBQWlEO0FBQ2pELHFDQUFrQztBQUtyQixRQUFBLHNCQUFzQixHQUFHLGVBQWUsQ0FBQztBQVV0RCxNQUFhLGtCQUFtQixTQUFRLGVBQWM7SUFNcEQsWUFDRSxRQUFnQixFQUNULE9BQW9CLEVBQ3BCLEtBQW9CLEVBQzNCLE9BQXNDO1FBRXRDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUpULFlBQU8sR0FBUCxPQUFPLENBQWE7UUFDcEIsVUFBSyxHQUFMLEtBQUssQ0FBZTtRQVBwQixTQUFJLEdBQVcsOEJBQXNCLENBQUM7UUFZN0Msa0JBQWtCO1FBQ2xCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUU7WUFDL0IsV0FBVyxFQUFFLEtBQUs7WUFDbEIsY0FBYyxFQUFFLDBCQUFXLENBQUMsaUJBQWlCO1lBQzdDLE9BQU8sRUFBRSxFQUFFO1NBQ1osRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNkLENBQUM7SUFFTSxNQUFNLENBQUMsTUFBcUMsRUFBRSxLQUFZO1FBQy9ELElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtZQUNuQixPQUFPLE1BQU0sQ0FBQyxDQUFFLHNCQUFzQjtTQUN2QztRQUNELE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDM0IsSUFBSSxLQUFLLEdBQUcsQ0FBQyxJQUFJLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtZQUMzQyxNQUFNLElBQUksc0JBQVMsQ0FBQywwQkFBVyxDQUFDLHFCQUFxQixDQUFDLENBQUM7U0FDeEQ7UUFDRCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQy9CLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDaEUsSUFBSSxNQUFNLEtBQUssU0FBUyxFQUFFO1lBQ3hCLE1BQU0sSUFBSSxzQkFBUyxDQUFDLDBCQUFXLENBQUMscUJBQXFCLENBQUMsQ0FBQztTQUN4RDtRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFTSxRQUFRLENBQUMsTUFBcUI7UUFDbkMsSUFBSSxNQUFNLEtBQUssSUFBSSxFQUFFO1lBQ25CLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBRSxzQkFBc0I7U0FDekQ7UUFFRCxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDM0MsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDakMsSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtnQkFDeEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQ3BEO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLE9BQU8sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDNUIsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUVELE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQzFELENBQUM7Q0FFRjtBQXpERCxnREF5REMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHYW1lRXJyb3IgfSBmcm9tICcuLi8uLi9nYW1lLWVycm9yJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IFByb21wdCB9IGZyb20gJy4vcHJvbXB0JztcbmltcG9ydCB7IFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvc3RhdGUnO1xuaW1wb3J0IHsgUG9rZW1vbkNhcmQgfSBmcm9tICcuLi9jYXJkL3Bva2Vtb24tY2FyZCc7XG5pbXBvcnQgeyBBdHRhY2sgfSBmcm9tICcuLi9jYXJkL3Bva2Vtb24tdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgQ2hvb3NlQXR0YWNrUHJvbXB0VHlwZSA9ICdDaG9vc2UgYXR0YWNrJztcblxuZXhwb3J0IGludGVyZmFjZSBDaG9vc2VBdHRhY2tPcHRpb25zIHtcbiAgYWxsb3dDYW5jZWw6IGJvb2xlYW47XG4gIGJsb2NrZWRNZXNzYWdlOiBHYW1lTWVzc2FnZTtcbiAgYmxvY2tlZDogeyBpbmRleDogbnVtYmVyOyBhdHRhY2s6IHN0cmluZyB9W107XG59XG5cbmV4cG9ydCB0eXBlIENob29zZUF0dGFja1Jlc3VsdFR5cGUgPSB7aW5kZXg6IG51bWJlciwgYXR0YWNrOiBzdHJpbmd9O1xuXG5leHBvcnQgY2xhc3MgQ2hvb3NlQXR0YWNrUHJvbXB0IGV4dGVuZHMgUHJvbXB0PEF0dGFjaz4ge1xuXG4gIHJlYWRvbmx5IHR5cGU6IHN0cmluZyA9IENob29zZUF0dGFja1Byb21wdFR5cGU7XG5cbiAgcHVibGljIG9wdGlvbnM6IENob29zZUF0dGFja09wdGlvbnM7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcGxheWVySWQ6IG51bWJlcixcbiAgICBwdWJsaWMgbWVzc2FnZTogR2FtZU1lc3NhZ2UsXG4gICAgcHVibGljIGNhcmRzOiBQb2tlbW9uQ2FyZFtdLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPENob29zZUF0dGFja09wdGlvbnM+XG4gICkge1xuICAgIHN1cGVyKHBsYXllcklkKTtcblxuICAgIC8vIERlZmF1bHQgb3B0aW9uc1xuICAgIHRoaXMub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIHtcbiAgICAgIGFsbG93Q2FuY2VsOiBmYWxzZSxcbiAgICAgIGJsb2NrZWRNZXNzYWdlOiBHYW1lTWVzc2FnZS5OT1RfRU5PVUdIX0VORVJHWSxcbiAgICAgIGJsb2NrZWQ6IFtdXG4gICAgfSwgb3B0aW9ucyk7XG4gIH1cblxuICBwdWJsaWMgZGVjb2RlKHJlc3VsdDogQ2hvb3NlQXR0YWNrUmVzdWx0VHlwZSB8IG51bGwsIHN0YXRlOiBTdGF0ZSk6IEF0dGFjayB8IG51bGwge1xuICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiByZXN1bHQ7ICAvLyBvcGVyYXRpb24gY2FuY2VsbGVkXG4gICAgfVxuICAgIGNvbnN0IGluZGV4ID0gcmVzdWx0LmluZGV4O1xuICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5jYXJkcy5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSU5WQUxJRF9QUk9NUFRfUkVTVUxUKTtcbiAgICB9XG4gICAgY29uc3QgY2FyZCA9IHRoaXMuY2FyZHNbaW5kZXhdO1xuICAgIGNvbnN0IGF0dGFjayA9IGNhcmQuYXR0YWNrcy5maW5kKGEgPT4gYS5uYW1lID09PSByZXN1bHQuYXR0YWNrKTtcbiAgICBpZiAoYXR0YWNrID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSU5WQUxJRF9QUk9NUFRfUkVTVUxUKTtcbiAgICB9XG4gICAgcmV0dXJuIGF0dGFjaztcbiAgfVxuXG4gIHB1YmxpYyB2YWxpZGF0ZShyZXN1bHQ6IEF0dGFjayB8IG51bGwpOiBib29sZWFuIHtcbiAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmFsbG93Q2FuY2VsOyAgLy8gb3BlcmF0aW9uIGNhbmNlbGxlZFxuICAgIH1cblxuICAgIGNvbnN0IGJsb2NrZWQgPSB0aGlzLm9wdGlvbnMuYmxvY2tlZC5tYXAoYiA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5jYXJkc1tiLmluZGV4XTtcbiAgICAgIGlmIChjYXJkICYmIGNhcmQuYXR0YWNrcykge1xuICAgICAgICByZXR1cm4gY2FyZC5hdHRhY2tzLmZpbmQoYSA9PiBhLm5hbWUgPT09IGIuYXR0YWNrKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChibG9ja2VkLmluY2x1ZGVzKHJlc3VsdCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jYXJkcy5zb21lKGMgPT4gYy5hdHRhY2tzLmluY2x1ZGVzKHJlc3VsdCkpO1xuICB9XG5cbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvY2hvb3NlLWF0dGFjay1wcm9tcHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Im02U0FpQ007cVFBakNOLEtBQUEsQ0FBQSxZQUFBLDBCQUFBLE9BQUEsQ0FBQSxrQkFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsY0FBQSwwQkFBQSxPQUFBLENBQUEsb0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLFFBQUEsMEJBQUEsT0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLEMsd0JBS2EsT0FBQSxDQUFBLHNCQUFBLENBQXlCLGVBQXpCLENBVWIsS0FBYSxDQUFBLGtCQUFiLFNBQXdDLFFBQUEsQ0FBQSxNQUF4QyxDQUFzRCxDQU1wRCxXQUFBLENBQ0UsUUFERixDQUVTLE9BRlQsQ0FHUyxLQUhULENBSUUsT0FKRixDQUl3QyxpREFFdEMsTUFBTSxRQUFOLEVBRnNDLHdCQUYvQixLQUFBLE9BQUEsQ0FBQSxPQUFBLENBRStCLHdCQUQvQixLQUFBLEtBQUEsQ0FBQSxLQUFBLENBQytCLHdCQVIvQixLQUFBLElBQUEsQ0FBZSxPQUFBLENBQUEsc0JBQWYsQ0FZUDtBQUpzQyx5QkFLdEMsS0FBSyxPQUFMLENBQWUsTUFBTSxDQUFDLE1BQVAsQ0FBYyxFQUFkLENBQWtCLENBQy9CLFdBQVcsQ0FBRSxLQURrQixDQUUvQixjQUFjLENBQUUsY0FBQSxDQUFBLFdBQUEsQ0FBWSxpQkFGRyxDQUcvQixPQUFPLENBQUUsRUFIc0IsQ0FBbEIsQ0FJWixPQUpZLENBQWYsQ0FLRCxDQUVNLE1BQU0sQ0FBQyxNQUFELENBQXdDLEtBQXhDLENBQW9ELGtEQUMvRCxHQUFJLE1BQU0sR0FBSyxJQUFmLENBQXFCLHFEQUNuQixNQUFPLENBQUEsTUFBUCxDQUFnQjtBQUNqQixDQUZELGlDQUdBLEtBQU0sQ0FBQSxLQUFLLDJCQUFHLE1BQU0sQ0FBQyxLQUFWLENBQVgsQ0FKK0QseUJBSy9ELEdBQUksNEJBQUEsS0FBSyxDQUFHLENBQVIsK0JBQWEsS0FBSyxFQUFJLEtBQUssS0FBTCxDQUFXLE1BQWpDLENBQUosQ0FBNkMscURBQzNDLEtBQU0sSUFBSSxDQUFBLFlBQUEsQ0FBQSxTQUFKLENBQWMsY0FBQSxDQUFBLFdBQUEsQ0FBWSxxQkFBMUIsQ0FBTixDQUNELENBRkQsaUNBR0EsS0FBTSxDQUFBLElBQUksMkJBQUcsS0FBSyxLQUFMLENBQVcsS0FBWCxDQUFILENBQVYsQ0FDQSxLQUFNLENBQUEsTUFBTSwyQkFBRyxJQUFJLENBQUMsT0FBTCxDQUFhLElBQWIsQ0FBa0IsQ0FBQyxFQUFJLHdEQUFBLENBQUEsQ0FBQyxDQUFDLElBQUYsR0FBVyxNQUFNLENBQUMsTUFBbEIsQ0FBd0IsQ0FBL0MsQ0FBSCxDQUFaLENBVCtELHlCQVUvRCxHQUFJLE1BQU0sR0FBSyxTQUFmLENBQTBCLHFEQUN4QixLQUFNLElBQUksQ0FBQSxZQUFBLENBQUEsU0FBSixDQUFjLGNBQUEsQ0FBQSxXQUFBLENBQVkscUJBQTFCLENBQU4sQ0FDRCxDQUZELGlDQVYrRCx5QkFhL0QsTUFBTyxDQUFBLE1BQVAsQ0FDRCxDQUVNLFFBQVEsQ0FBQyxNQUFELENBQXNCLGtEQUNuQyxHQUFJLE1BQU0sR0FBSyxJQUFmLENBQXFCLHFEQUNuQixNQUFPLE1BQUssT0FBTCxDQUFhLFdBQXBCLENBQWtDO0FBQ25DLENBRkQsaUNBSUEsS0FBTSxDQUFBLE9BQU8sMkJBQUcsS0FBSyxPQUFMLENBQWEsT0FBYixDQUFxQixHQUFyQixDQUF5QixDQUFDLEVBQUcseUJBQzNDLEtBQU0sQ0FBQSxJQUFJLDJCQUFHLEtBQUssS0FBTCxDQUFXLENBQUMsQ0FBQyxLQUFiLENBQUgsQ0FBVixDQUQyQyx5QkFFM0MsR0FBSSw0QkFBQSxJQUFJLCtCQUFJLElBQUksQ0FBQyxPQUFULENBQVIsQ0FBMEIscURBQ3hCLE1BQU8sQ0FBQSxJQUFJLENBQUMsT0FBTCxDQUFhLElBQWIsQ0FBa0IsQ0FBQyxFQUFJLHdEQUFBLENBQUEsQ0FBQyxDQUFDLElBQUYsR0FBVyxDQUFDLENBQUMsTUFBYixDQUFtQixDQUExQyxDQUFQLENBQ0QsQ0FGRCxpQ0FHRCxDQUxlLENBQUgsQ0FBYixDQUxtQyx5QkFZbkMsR0FBSSxPQUFPLENBQUMsUUFBUixDQUFpQixNQUFqQixDQUFKLENBQThCLHFEQUM1QixNQUFPLE1BQVAsQ0FDRCxDQUZELGlDQVptQyx5QkFnQm5DLE1BQU8sTUFBSyxLQUFMLENBQVcsSUFBWCxDQUFnQixDQUFDLEVBQUksd0RBQUEsQ0FBQSxDQUFDLENBQUMsT0FBRixDQUFVLFFBQVYsQ0FBbUIsTUFBbkIsRUFBMEIsQ0FBL0MsQ0FBUCxDQUNELENBdkRtRCxDLHlCQUF0RCxPQUFBLENBQUEsa0JBQUEsQ0FBQSxrQkFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR2FtZUVycm9yIH0gZnJvbSAnLi4vLi4vZ2FtZS1lcnJvcic7XG5pbXBvcnQgeyBHYW1lTWVzc2FnZSB9IGZyb20gJy4uLy4uL2dhbWUtbWVzc2FnZSc7XG5pbXBvcnQgeyBQcm9tcHQgfSBmcm9tICcuL3Byb21wdCc7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3N0YXRlJztcbmltcG9ydCB7IFBva2Vtb25DYXJkIH0gZnJvbSAnLi4vY2FyZC9wb2tlbW9uLWNhcmQnO1xuaW1wb3J0IHsgQXR0YWNrIH0gZnJvbSAnLi4vY2FyZC9wb2tlbW9uLXR5cGVzJztcblxuZXhwb3J0IGNvbnN0IENob29zZUF0dGFja1Byb21wdFR5cGUgPSAnQ2hvb3NlIGF0dGFjayc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hvb3NlQXR0YWNrT3B0aW9ucyB7XG4gIGFsbG93Q2FuY2VsOiBib29sZWFuO1xuICBibG9ja2VkTWVzc2FnZTogR2FtZU1lc3NhZ2U7XG4gIGJsb2NrZWQ6IHsgaW5kZXg6IG51bWJlcjsgYXR0YWNrOiBzdHJpbmcgfVtdO1xufVxuXG5leHBvcnQgdHlwZSBDaG9vc2VBdHRhY2tSZXN1bHRUeXBlID0ge2luZGV4OiBudW1iZXIsIGF0dGFjazogc3RyaW5nfTtcblxuZXhwb3J0IGNsYXNzIENob29zZUF0dGFja1Byb21wdCBleHRlbmRzIFByb21wdDxBdHRhY2s+IHtcblxuICByZWFkb25seSB0eXBlOiBzdHJpbmcgPSBDaG9vc2VBdHRhY2tQcm9tcHRUeXBlO1xuXG4gIHB1YmxpYyBvcHRpb25zOiBDaG9vc2VBdHRhY2tPcHRpb25zO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBsYXllcklkOiBudW1iZXIsXG4gICAgcHVibGljIG1lc3NhZ2U6IEdhbWVNZXNzYWdlLFxuICAgIHB1YmxpYyBjYXJkczogUG9rZW1vbkNhcmRbXSxcbiAgICBvcHRpb25zPzogUGFydGlhbDxDaG9vc2VBdHRhY2tPcHRpb25zPlxuICApIHtcbiAgICBzdXBlcihwbGF5ZXJJZCk7XG5cbiAgICAvLyBEZWZhdWx0IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgICBhbGxvd0NhbmNlbDogZmFsc2UsXG4gICAgICBibG9ja2VkTWVzc2FnZTogR2FtZU1lc3NhZ2UuTk9UX0VOT1VHSF9FTkVSR1ksXG4gICAgICBibG9ja2VkOiBbXVxuICAgIH0sIG9wdGlvbnMpO1xuICB9XG5cbiAgcHVibGljIGRlY29kZShyZXN1bHQ6IENob29zZUF0dGFja1Jlc3VsdFR5cGUgfCBudWxsLCBzdGF0ZTogU3RhdGUpOiBBdHRhY2sgfCBudWxsIHtcbiAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gcmVzdWx0OyAgLy8gb3BlcmF0aW9uIGNhbmNlbGxlZFxuICAgIH1cbiAgICBjb25zdCBpbmRleCA9IHJlc3VsdC5pbmRleDtcbiAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMuY2FyZHMubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklOVkFMSURfUFJPTVBUX1JFU1VMVCk7XG4gICAgfVxuICAgIGNvbnN0IGNhcmQgPSB0aGlzLmNhcmRzW2luZGV4XTtcbiAgICBjb25zdCBhdHRhY2sgPSBjYXJkLmF0dGFja3MuZmluZChhID0+IGEubmFtZSA9PT0gcmVzdWx0LmF0dGFjayk7XG4gICAgaWYgKGF0dGFjayA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklOVkFMSURfUFJPTVBUX1JFU1VMVCk7XG4gICAgfVxuICAgIHJldHVybiBhdHRhY2s7XG4gIH1cblxuICBwdWJsaWMgdmFsaWRhdGUocmVzdWx0OiBBdHRhY2sgfCBudWxsKTogYm9vbGVhbiB7XG4gICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5hbGxvd0NhbmNlbDsgIC8vIG9wZXJhdGlvbiBjYW5jZWxsZWRcbiAgICB9XG5cbiAgICBjb25zdCBibG9ja2VkID0gdGhpcy5vcHRpb25zLmJsb2NrZWQubWFwKGIgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IHRoaXMuY2FyZHNbYi5pbmRleF07XG4gICAgICBpZiAoY2FyZCAmJiBjYXJkLmF0dGFja3MpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQuYXR0YWNrcy5maW5kKGEgPT4gYS5uYW1lID09PSBiLmF0dGFjayk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoYmxvY2tlZC5pbmNsdWRlcyhyZXN1bHQpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY2FyZHMuc29tZShjID0+IGMuYXR0YWNrcy5pbmNsdWRlcyhyZXN1bHQpKTtcbiAgfVxuXG59XG4iXX0=