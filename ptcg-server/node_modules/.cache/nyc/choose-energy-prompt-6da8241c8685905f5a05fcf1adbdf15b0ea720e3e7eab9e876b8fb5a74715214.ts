"use strict";function cov_1u0zd7s42t(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-energy-prompt.ts";var hash="b81ea43a80857d6965526e4dd7c2dea84840af60";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-energy-prompt.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:69}},"2":{start:{line:4,column:21},end:{line:4,column:50}},"3":{start:{line:5,column:17},end:{line:5,column:36}},"4":{start:{line:6,column:22},end:{line:6,column:47}},"5":{start:{line:7,column:0},end:{line:7,column:49}},"6":{start:{line:10,column:8},end:{line:10,column:24}},"7":{start:{line:11,column:8},end:{line:11,column:31}},"8":{start:{line:12,column:8},end:{line:12,column:29}},"9":{start:{line:13,column:8},end:{line:13,column:25}},"10":{start:{line:14,column:8},end:{line:14,column:51}},"11":{start:{line:16,column:8},end:{line:18,column:20}},"12":{start:{line:19,column:8},end:{line:21,column:9}},"13":{start:{line:20,column:12},end:{line:20,column:52}},"14":{start:{line:24,column:8},end:{line:26,column:9}},"15":{start:{line:25,column:12},end:{line:25,column:24}},"16":{start:{line:27,column:23},end:{line:27,column:34}},"17":{start:{line:28,column:8},end:{line:28,column:50}},"18":{start:{line:28,column:35},end:{line:28,column:48}},"19":{start:{line:31,column:8},end:{line:33,column:9}},"20":{start:{line:32,column:12},end:{line:32,column:44}},"21":{start:{line:34,column:8},end:{line:36,column:9}},"22":{start:{line:35,column:12},end:{line:35,column:25}},"23":{start:{line:37,column:8},end:{line:37,column:20}},"24":{start:{line:40,column:23},end:{line:40,column:40}},"25":{start:{line:41,column:25},end:{line:41,column:44}},"26":{start:{line:42,column:22},end:{line:42,column:82}},"27":{start:{line:42,column:44},end:{line:42,column:81}},"28":{start:{line:43,column:31},end:{line:43,column:59}},"29":{start:{line:44,column:8},end:{line:75,column:9}},"30":{start:{line:45,column:25},end:{line:45,column:33}},"31":{start:{line:46,column:24},end:{line:46,column:74}},"32":{start:{line:46,column:48},end:{line:46,column:73}},"33":{start:{line:47,column:12},end:{line:50,column:13}},"34":{start:{line:49,column:16},end:{line:49,column:96}},"35":{start:{line:49,column:48},end:{line:49,column:94}},"36":{start:{line:51,column:12},end:{line:74,column:13}},"37":{start:{line:53,column:32},end:{line:53,column:47}},"38":{start:{line:54,column:16},end:{line:54,column:42}},"39":{start:{line:55,column:16},end:{line:65,column:19}},"40":{start:{line:56,column:20},end:{line:64,column:21}},"41":{start:{line:57,column:24},end:{line:57,column:38}},"42":{start:{line:60,column:34},end:{line:60,column:50}},"43":{start:{line:61,column:24},end:{line:63,column:25}},"44":{start:{line:62,column:28},end:{line:62,column:47}},"45":{start:{line:69,column:16},end:{line:69,column:30}},"46":{start:{line:70,column:37},end:{line:70,column:57}},"47":{start:{line:71,column:16},end:{line:73,column:17}},"48":{start:{line:72,column:20},end:{line:72,column:51}},"49":{start:{line:76,column:25},end:{line:76,column:26}},"50":{start:{line:77,column:8},end:{line:79,column:9}},"51":{start:{line:78,column:12},end:{line:78,column:49}},"52":{start:{line:80,column:34},end:{line:80,column:74}},"53":{start:{line:81,column:8},end:{line:86,column:9}},"54":{start:{line:81,column:21},end:{line:81,column:22}},"55":{start:{line:82,column:33},end:{line:82,column:80}},"56":{start:{line:83,column:12},end:{line:85,column:13}},"57":{start:{line:84,column:16},end:{line:84,column:47}},"58":{start:{line:87,column:8},end:{line:87,column:22}},"59":{start:{line:90,column:0},end:{line:90,column:48}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:4},end:{line:9,column:5}},loc:{start:{line:9,column:58},end:{line:22,column:5}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:23,column:4},end:{line:23,column:5}},loc:{start:{line:23,column:19},end:{line:29,column:5}},line:23},"2":{name:"(anonymous_2)",decl:{start:{line:28,column:26},end:{line:28,column:27}},loc:{start:{line:28,column:35},end:{line:28,column:48}},line:28},"3":{name:"(anonymous_3)",decl:{start:{line:30,column:4},end:{line:30,column:5}},loc:{start:{line:30,column:21},end:{line:38,column:5}},line:30},"4":{name:"(anonymous_4)",decl:{start:{line:39,column:4},end:{line:39,column:5}},loc:{start:{line:39,column:27},end:{line:88,column:5}},line:39},"5":{name:"(anonymous_5)",decl:{start:{line:42,column:39},end:{line:42,column:40}},loc:{start:{line:42,column:44},end:{line:42,column:81}},line:42},"6":{name:"(anonymous_6)",decl:{start:{line:46,column:43},end:{line:46,column:44}},loc:{start:{line:46,column:48},end:{line:46,column:73}},line:46},"7":{name:"(anonymous_7)",decl:{start:{line:49,column:43},end:{line:49,column:44}},loc:{start:{line:49,column:48},end:{line:49,column:94}},line:49},"8":{name:"(anonymous_8)",decl:{start:{line:55,column:41},end:{line:55,column:42}},loc:{start:{line:55,column:46},end:{line:65,column:17}},line:55}},branchMap:{"0":{loc:{start:{line:19,column:8},end:{line:21,column:9}},type:"if",locations:[{start:{line:19,column:8},end:{line:21,column:9}},{start:{line:19,column:8},end:{line:21,column:9}}],line:19},"1":{loc:{start:{line:24,column:8},end:{line:26,column:9}},type:"if",locations:[{start:{line:24,column:8},end:{line:26,column:9}},{start:{line:24,column:8},end:{line:26,column:9}}],line:24},"2":{loc:{start:{line:31,column:8},end:{line:33,column:9}},type:"if",locations:[{start:{line:31,column:8},end:{line:33,column:9}},{start:{line:31,column:8},end:{line:33,column:9}}],line:31},"3":{loc:{start:{line:34,column:8},end:{line:36,column:9}},type:"if",locations:[{start:{line:34,column:8},end:{line:36,column:9}},{start:{line:34,column:8},end:{line:36,column:9}}],line:34},"4":{loc:{start:{line:44,column:15},end:{line:44,column:54}},type:"binary-expr",locations:[{start:{line:44,column:15},end:{line:44,column:31}},{start:{line:44,column:35},end:{line:44,column:54}}],line:44},"5":{loc:{start:{line:47,column:12},end:{line:50,column:13}},type:"if",locations:[{start:{line:47,column:12},end:{line:50,column:13}},{start:{line:47,column:12},end:{line:50,column:13}}],line:47},"6":{loc:{start:{line:51,column:12},end:{line:74,column:13}},type:"if",locations:[{start:{line:51,column:12},end:{line:74,column:13}},{start:{line:51,column:12},end:{line:74,column:13}}],line:51},"7":{loc:{start:{line:56,column:20},end:{line:64,column:21}},type:"if",locations:[{start:{line:56,column:20},end:{line:64,column:21}},{start:{line:56,column:20},end:{line:64,column:21}}],line:56},"8":{loc:{start:{line:56,column:24},end:{line:56,column:75}},type:"binary-expr",locations:[{start:{line:56,column:24},end:{line:56,column:55}},{start:{line:56,column:59},end:{line:56,column:75}}],line:56},"9":{loc:{start:{line:61,column:24},end:{line:63,column:25}},type:"if",locations:[{start:{line:61,column:24},end:{line:63,column:25}},{start:{line:61,column:24},end:{line:63,column:25}}],line:61},"10":{loc:{start:{line:71,column:16},end:{line:73,column:17}},type:"if",locations:[{start:{line:71,column:16},end:{line:73,column:17}},{start:{line:71,column:16},end:{line:73,column:17}}],line:71},"11":{loc:{start:{line:83,column:12},end:{line:85,column:13}},type:"if",locations:[{start:{line:83,column:12},end:{line:85,column:13}},{start:{line:83,column:12},end:{line:85,column:13}}],line:83}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-energy-prompt.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/choose-energy-prompt.ts"],names:[],mappings:"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",sourcesContent:["import { Card } from '../card/card';\nimport { CardType } from '../card/card-types';\nimport { GameMessage } from '../../game-message';\nimport { Prompt } from './prompt';\nimport { StateUtils } from '../state-utils';\n\nexport const ChooseEnergyPromptType = 'Choose energy';\n\nexport interface ChooseEnergyOptions {\n  allowCancel: boolean;\n}\n\nexport type EnergyMap = { card: Card, provides: CardType[] }\n\nexport class ChooseEnergyPrompt extends Prompt<EnergyMap[]> {\n\n  readonly type: string = ChooseEnergyPromptType;\n\n  public options: ChooseEnergyOptions;\n\n  constructor(\n    playerId: number,\n    public message: GameMessage,\n    public energy: EnergyMap[],\n    public cost: CardType[],\n    options?: Partial<ChooseEnergyOptions>\n  ) {\n    super(playerId);\n\n    // Default options\n    this.options = Object.assign({}, {\n      allowCancel: true\n    }, options);\n\n    if (this.options.allowCancel === false) {\n      this.cost = this.getCostThatCanBePaid();\n    }\n  }\n\n  public decode(result: number[] | null): EnergyMap[] | null {\n    if (result === null) {\n      return null;\n    }\n    const energy: EnergyMap[] = this.energy;\n    return result.map(index => energy[index]);\n  }\n\n  public validate(result: EnergyMap[] | null): boolean {\n    if (result === null) {\n      return this.options.allowCancel;\n    }\n    if (!StateUtils.checkExactEnergy(result, this.cost)) {\n      return false;\n    }\n    return true;\n  }\n\n  private getCostThatCanBePaid(): CardType[] {\n    const result: CardType[] = this.cost.slice();\n    const provides = this.energy.slice();\n    const costs: CardType[] = this.cost.filter(c => c !== CardType.COLORLESS);\n    const colorlessCount = result.length - costs.length;\n\n    while (costs.length > 0 && provides.length > 0) {\n      const cost = costs[0];\n      let index = provides.findIndex(p => p.provides.includes(cost));\n\n      if (index === -1) {\n        // concrete energy not found, try to use rainbow energies\n        index = provides.findIndex(p => p.provides.includes(CardType.ANY));\n      }\n\n      if (index !== -1) {\n        // Energy can be paid, so remove that energy from the provides\n        const provide = provides[index];\n        provides.splice(index, 1);\n\n        provide.provides.forEach(c => {\n          if (c === CardType.ANY && costs.length > 0) {\n            costs.shift();\n          } else {\n            const i = costs.indexOf(c);\n            if (i !== -1) {\n              costs.splice(i, 1);\n            }\n          }\n        });\n\n      } else {\n        // Impossible to pay for this cost\n        costs.shift();\n        const costToDelete = result.indexOf(cost);\n        if (costToDelete !== -1) {\n          result.splice(costToDelete, 1);\n        }\n      }\n    }\n\n    let energyLeft = 0;\n    for (const energy of provides) {\n      energyLeft += energy.provides.length;\n    }\n\n    const colorlessToDelete = Math.max(0, colorlessCount - energyLeft);\n    for (let i = 0; i < colorlessToDelete; i++) {\n      const costToDelete = result.indexOf(CardType.COLORLESS);\n      if (costToDelete !== -1) {\n        result.splice(costToDelete, 1);\n      }\n    }\n\n    return result;\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b81ea43a80857d6965526e4dd7c2dea84840af60"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1u0zd7s42t=function(){return actualCoverage;};}return actualCoverage;}cov_1u0zd7s42t();cov_1u0zd7s42t().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1u0zd7s42t().s[1]++;exports.ChooseEnergyPrompt=exports.ChooseEnergyPromptType=void 0;const card_types_1=(cov_1u0zd7s42t().s[2]++,require("../card/card-types"));const prompt_1=(cov_1u0zd7s42t().s[3]++,require("./prompt"));const state_utils_1=(cov_1u0zd7s42t().s[4]++,require("../state-utils"));cov_1u0zd7s42t().s[5]++;exports.ChooseEnergyPromptType='Choose energy';class ChooseEnergyPrompt extends(prompt_1.Prompt){constructor(playerId,message,energy,cost,options){cov_1u0zd7s42t().f[0]++;cov_1u0zd7s42t().s[6]++;super(playerId);cov_1u0zd7s42t().s[7]++;this.message=message;cov_1u0zd7s42t().s[8]++;this.energy=energy;cov_1u0zd7s42t().s[9]++;this.cost=cost;cov_1u0zd7s42t().s[10]++;this.type=exports.ChooseEnergyPromptType;// Default options
cov_1u0zd7s42t().s[11]++;this.options=Object.assign({},{allowCancel:true},options);cov_1u0zd7s42t().s[12]++;if(this.options.allowCancel===false){cov_1u0zd7s42t().b[0][0]++;cov_1u0zd7s42t().s[13]++;this.cost=this.getCostThatCanBePaid();}else{cov_1u0zd7s42t().b[0][1]++;}}decode(result){cov_1u0zd7s42t().f[1]++;cov_1u0zd7s42t().s[14]++;if(result===null){cov_1u0zd7s42t().b[1][0]++;cov_1u0zd7s42t().s[15]++;return null;}else{cov_1u0zd7s42t().b[1][1]++;}const energy=(cov_1u0zd7s42t().s[16]++,this.energy);cov_1u0zd7s42t().s[17]++;return result.map(index=>{cov_1u0zd7s42t().f[2]++;cov_1u0zd7s42t().s[18]++;return energy[index];});}validate(result){cov_1u0zd7s42t().f[3]++;cov_1u0zd7s42t().s[19]++;if(result===null){cov_1u0zd7s42t().b[2][0]++;cov_1u0zd7s42t().s[20]++;return this.options.allowCancel;}else{cov_1u0zd7s42t().b[2][1]++;}cov_1u0zd7s42t().s[21]++;if(!state_utils_1.StateUtils.checkExactEnergy(result,this.cost)){cov_1u0zd7s42t().b[3][0]++;cov_1u0zd7s42t().s[22]++;return false;}else{cov_1u0zd7s42t().b[3][1]++;}cov_1u0zd7s42t().s[23]++;return true;}getCostThatCanBePaid(){cov_1u0zd7s42t().f[4]++;const result=(cov_1u0zd7s42t().s[24]++,this.cost.slice());const provides=(cov_1u0zd7s42t().s[25]++,this.energy.slice());const costs=(cov_1u0zd7s42t().s[26]++,this.cost.filter(c=>{cov_1u0zd7s42t().f[5]++;cov_1u0zd7s42t().s[27]++;return c!==card_types_1.CardType.COLORLESS;}));const colorlessCount=(cov_1u0zd7s42t().s[28]++,result.length-costs.length);cov_1u0zd7s42t().s[29]++;while((cov_1u0zd7s42t().b[4][0]++,costs.length>0)&&(cov_1u0zd7s42t().b[4][1]++,provides.length>0)){const cost=(cov_1u0zd7s42t().s[30]++,costs[0]);let index=(cov_1u0zd7s42t().s[31]++,provides.findIndex(p=>{cov_1u0zd7s42t().f[6]++;cov_1u0zd7s42t().s[32]++;return p.provides.includes(cost);}));cov_1u0zd7s42t().s[33]++;if(index===-1){cov_1u0zd7s42t().b[5][0]++;cov_1u0zd7s42t().s[34]++;// concrete energy not found, try to use rainbow energies
index=provides.findIndex(p=>{cov_1u0zd7s42t().f[7]++;cov_1u0zd7s42t().s[35]++;return p.provides.includes(card_types_1.CardType.ANY);});}else{cov_1u0zd7s42t().b[5][1]++;}cov_1u0zd7s42t().s[36]++;if(index!==-1){cov_1u0zd7s42t().b[6][0]++;// Energy can be paid, so remove that energy from the provides
const provide=(cov_1u0zd7s42t().s[37]++,provides[index]);cov_1u0zd7s42t().s[38]++;provides.splice(index,1);cov_1u0zd7s42t().s[39]++;provide.provides.forEach(c=>{cov_1u0zd7s42t().f[8]++;cov_1u0zd7s42t().s[40]++;if((cov_1u0zd7s42t().b[8][0]++,c===card_types_1.CardType.ANY)&&(cov_1u0zd7s42t().b[8][1]++,costs.length>0)){cov_1u0zd7s42t().b[7][0]++;cov_1u0zd7s42t().s[41]++;costs.shift();}else{cov_1u0zd7s42t().b[7][1]++;const i=(cov_1u0zd7s42t().s[42]++,costs.indexOf(c));cov_1u0zd7s42t().s[43]++;if(i!==-1){cov_1u0zd7s42t().b[9][0]++;cov_1u0zd7s42t().s[44]++;costs.splice(i,1);}else{cov_1u0zd7s42t().b[9][1]++;}}});}else{cov_1u0zd7s42t().b[6][1]++;cov_1u0zd7s42t().s[45]++;// Impossible to pay for this cost
costs.shift();const costToDelete=(cov_1u0zd7s42t().s[46]++,result.indexOf(cost));cov_1u0zd7s42t().s[47]++;if(costToDelete!==-1){cov_1u0zd7s42t().b[10][0]++;cov_1u0zd7s42t().s[48]++;result.splice(costToDelete,1);}else{cov_1u0zd7s42t().b[10][1]++;}}}let energyLeft=(cov_1u0zd7s42t().s[49]++,0);cov_1u0zd7s42t().s[50]++;for(const energy of provides){cov_1u0zd7s42t().s[51]++;energyLeft+=energy.provides.length;}const colorlessToDelete=(cov_1u0zd7s42t().s[52]++,Math.max(0,colorlessCount-energyLeft));cov_1u0zd7s42t().s[53]++;for(let i=(cov_1u0zd7s42t().s[54]++,0);i<colorlessToDelete;i++){const costToDelete=(cov_1u0zd7s42t().s[55]++,result.indexOf(card_types_1.CardType.COLORLESS));cov_1u0zd7s42t().s[56]++;if(costToDelete!==-1){cov_1u0zd7s42t().b[11][0]++;cov_1u0zd7s42t().s[57]++;result.splice(costToDelete,1);}else{cov_1u0zd7s42t().b[11][1]++;}}cov_1u0zd7s42t().s[58]++;return result;}}cov_1u0zd7s42t().s[59]++;exports.ChooseEnergyPrompt=ChooseEnergyPrompt;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcHJvbXB0cy9jaG9vc2UtZW5lcmd5LXByb21wdC50cyIsInNvdXJjZXMiOlsiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcHJvbXB0cy9jaG9vc2UtZW5lcmd5LXByb21wdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxtREFBOEM7QUFFOUMscUNBQWtDO0FBQ2xDLGdEQUE0QztBQUUvQixRQUFBLHNCQUFzQixHQUFHLGVBQWUsQ0FBQztBQVF0RCxNQUFhLGtCQUFtQixTQUFRLGVBQW1CO0lBTXpELFlBQ0UsUUFBZ0IsRUFDVCxPQUFvQixFQUNwQixNQUFtQixFQUNuQixJQUFnQixFQUN2QixPQUFzQztRQUV0QyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7UUFMVCxZQUFPLEdBQVAsT0FBTyxDQUFhO1FBQ3BCLFdBQU0sR0FBTixNQUFNLENBQWE7UUFDbkIsU0FBSSxHQUFKLElBQUksQ0FBWTtRQVJoQixTQUFJLEdBQVcsOEJBQXNCLENBQUM7UUFhN0Msa0JBQWtCO1FBQ2xCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUU7WUFDL0IsV0FBVyxFQUFFLElBQUk7U0FDbEIsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUVaLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEtBQUssS0FBSyxFQUFFO1lBQ3RDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7U0FDekM7SUFDSCxDQUFDO0lBRU0sTUFBTSxDQUFDLE1BQXVCO1FBQ25DLElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsTUFBTSxN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QU0sTUFBTSxJQUFJLFFBQVEsRUFBRTtZQUM3QixVQUFVLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUM7U0FDdEM7UUFFRCxNQUFNLGlCQUFpQixHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLGNBQWMsR0FBRyxVQUFVLENBQUMsQ0FBQztRQUNuRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsaUJBQWlCLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDMUMsTUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxxQkFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3hELElBQUksWUFBWSxLQUFLLENBQUMsQ0FBQyxFQUFFO2dCQUN2QixNQUFNLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQzthQUNoQztTQUNGO1FBRUQsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztDQUVGO0FBcEdELGdEQW9HQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENhcmQgfSBmcm9tICcuLi9jYXJkL2NhcmQnO1xuaW1wb3J0IHsgQ2FyZFR5cGUgfSBmcm9tICcuLi9jYXJkL2NhcmQtdHlwZXMnO1xuaW1wb3J0IHsgR2FtZU1lc3NhZ2UgfSBmcm9tICcuLi8uLi9nYW1lLW1lc3NhZ2UnO1xuaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi9wcm9tcHQnO1xuaW1wb3J0IHsgU3RhdGVVdGlscyB9IGZyb20gJy4uL3N0YXRlLXV0aWxzJztcblxuZXhwb3J0IGNvbnN0IENob29zZUVuZXJneVByb21wdFR5cGUgPSAnQ2hvb3NlIGVuZXJneSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hvb3NlRW5lcmd5T3B0aW9ucyB7XG4gIGFsbG93Q2FuY2VsOiBib29sZWFuO1xufVxuXG5leHBvcnQgdHlwZSBFbmVyZ3lNYXAgPSB7IGNhcmQ6IENhcmQsIHByb3ZpZGVzOiBDYXJkVHlwZVtdIH1cblxuZXhwb3J0IGNsYXNzIENob29zZUVuZXJneVByb21wdCBleHRlbmRzIFByb21wdDxFbmVyZ3lNYXBbXT4ge1xuXG4gIHJlYWRvbmx5IHR5cGU6IHN0cmluZyA9IENob29zZUVuZXJneVByb21wdFR5cGU7XG5cbiAgcHVibGljIG9wdGlvbnM6IENob29zZUVuZXJneU9wdGlvbnM7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcGxheWVySWQ6IG51bWJlcixcbiAgICBwdWJsaWMgbWVzc2FnZTogR2FtZU1lc3NhZ2UsXG4gICAgcHVibGljIGVuZXJneTogRW5lcmd5TWFwW10sXG4gICAgcHVibGljIGNvc3Q6IENhcmRUeXBlW10sXG4gICAgb3B0aW9ucz86IFBhcnRpYWw8Q2hvb3NlRW5lcmd5T3B0aW9ucz5cbiAgKSB7XG4gICAgc3VwZXIocGxheWVySWQpO1xuXG4gICAgLy8gRGVmYXVsdCBvcHRpb25zXG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwge1xuICAgICAgYWxsb3dDYW5jZWw6IHRydWVcbiAgICB9LCBvcHRpb25zKTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuYWxsb3dDYW5jZWwgPT09IGZhbHNlKSB7XG4gICAgICB0aGlzLmNvc3QgPSB0aGlzLmdldENvc3RUaGF0Q2FuQmVQYWlkKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGRlY29kZShyZXN1bHQ6IG51bWJlcltdIHwgbnVsbCk6IEVuZXJneU1hcFtdIHwgbnVsbCB7XG4gICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IGVuZXJneTogRW5lcmd5TWFwW10gPSB0aGlzLmVuZXJneTtcbiAgICByZXR1cm4gcmVzdWx0Lm1hcChpbmRleCA9PiBlbmVyZ3lbaW5kZXhdKTtcbiAgfVxuXG4gIHB1YmxpYyB2YWxpZGF0ZShyZXN1bHQ6IEVuZXJneU1hcFtdIHwgbnVsbCk6IGJvb2xlYW4ge1xuICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYWxsb3dDYW5jZWw7XG4gICAgfVxuICAgIGlmICghU3RhdGVVdGlscy5jaGVja0V4YWN0RW5lcmd5KHJlc3VsdCwgdGhpcy5jb3N0KSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q29zdFRoYXRDYW5CZVBhaWQoKTogQ2FyZFR5cGVbXSB7XG4gICAgY29uc3QgcmVzdWx0OiBDYXJkVHlwZVtdID0gdGhpcy5jb3N0LnNsaWNlKCk7XG4gICAgY29uc3QgcHJvdmlkZXMgPSB0aGlzLmVuZXJneS5zbGljZSgpO1xuICAgIGNvbnN0IGNvc3RzOiBDYXJkVHlwZVtdID0gdGhpcy5jb3N0LmZpbHRlcihjID0+IGMgIT09IENhcmRUeXBlLkNPTE9STEVTUyk7XG4gICAgY29uc3QgY29sb3JsZXNzQ291bnQgPSByZXN1bHQubGVuZ3RoIC0gY29zdHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGNvc3RzLmxlbmd0aCA+IDAgJiYgcHJvdmlkZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgY29zdCA9IGNvc3RzWzBdO1xuICAgICAgbGV0IGluZGV4ID0gcHJvdmlkZXMuZmluZEluZGV4KHAgPT4gcC5wcm92aWRlcy5pbmNsdWRlcyhjb3N0KSk7XG5cbiAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgLy8gY29uY3JldGUgZW5lcmd5IG5vdCBmb3VuZCwgdHJ5IHRvIHVzZSByYWluYm93IGVuZXJnaWVzXG4gICAgICAgIGluZGV4ID0gcHJvdmlkZXMuZmluZEluZGV4KHAgPT4gcC5wcm92aWRlcy5pbmNsdWRlcyhDYXJkVHlwZS5BTlkpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAvLyBFbmVyZ3kgY2FuIGJlIHBhaWQsIHNvIHJlbW92ZSB0aGF0IGVuZXJneSBmcm9tIHRoZSBwcm92aWRlc1xuICAgICAgICBjb25zdCBwcm92aWRlID0gcHJvdmlkZXNbaW5kZXhdO1xuICAgICAgICBwcm92aWRlcy5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICAgIHByb3ZpZGUucHJvdmlkZXMuZm9yRWFjaChjID0+IHtcbiAgICAgICAgICBpZiAoYyA9PT0gQ2FyZFR5cGUuQU5ZICYmIGNvc3RzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvc3RzLnNoaWZ0KCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBjb3N0cy5pbmRleE9mKGMpO1xuICAgICAgICAgICAgaWYgKGkgIT09IC0xKSB7XG4gICAgICAgICAgICAgIGNvc3RzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBJbXBvc3NpYmxlIHRvIHBheSBmb3IgdGhpcyBjb3N0XG4gICAgICAgIGNvc3RzLnNoaWZ0KCk7XG4gICAgICAgIGNvbnN0IGNvc3RUb0RlbGV0ZSA9IHJlc3VsdC5pbmRleE9mKGNvc3QpO1xuICAgICAgICBpZiAoY29zdFRvRGVsZXRlICE9PSAtMSkge1xuICAgICAgICAgIHJlc3VsdC5zcGxpY2UoY29zdFRvRGVsZXRlLCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBlbmVyZ3lMZWZ0ID0gMDtcbiAgICBmb3IgKGNvbnN0IGVuZXJneSBvZiBwcm92aWRlcykge1xuICAgICAgZW5lcmd5TGVmdCArPSBlbmVyZ3kucHJvdmlkZXMubGVuZ3RoO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbG9ybGVzc1RvRGVsZXRlID0gTWF0aC5tYXgoMCwgY29sb3JsZXNzQ291bnQgLSBlbmVyZ3lMZWZ0KTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbG9ybGVzc1RvRGVsZXRlOyBpKyspIHtcbiAgICAgIGNvbnN0IGNvc3RUb0RlbGV0ZSA9IHJlc3VsdC5pbmRleE9mKENhcmRUeXBlLkNPTE9STEVTUyk7XG4gICAgICBpZiAoY29zdFRvRGVsZXRlICE9PSAtMSkge1xuICAgICAgICByZXN1bHQuc3BsaWNlKGNvc3RUb0RlbGV0ZSwgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG59XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvY2hvb3NlLWVuZXJneS1wcm9tcHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ims1Y0E4QlE7cVFBN0JSLEtBQUEsQ0FBQSxZQUFBLDBCQUFBLE9BQUEsQ0FBQSxvQkFBQSxDQUFBLENBQUEsQ0FFQSxLQUFBLENBQUEsUUFBQSwwQkFBQSxPQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsYUFBQSwwQkFBQSxPQUFBLENBQUEsZ0JBQUEsQ0FBQSxDQUFBLEMsd0JBRWEsT0FBQSxDQUFBLHNCQUFBLENBQXlCLGVBQXpCLENBUWIsS0FBYSxDQUFBLGtCQUFiLFNBQXdDLFFBQUEsQ0FBQSxNQUF4QyxDQUEyRCxDQU16RCxXQUFBLENBQ0UsUUFERixDQUVTLE9BRlQsQ0FHUyxNQUhULENBSVMsSUFKVCxDQUtFLE9BTEYsQ0FLd0MsaURBRXRDLE1BQU0sUUFBTixFQUZzQyx3QkFIL0IsS0FBQSxPQUFBLENBQUEsT0FBQSxDQUcrQix3QkFGL0IsS0FBQSxNQUFBLENBQUEsTUFBQSxDQUUrQix3QkFEL0IsS0FBQSxJQUFBLENBQUEsSUFBQSxDQUMrQix5QkFUL0IsS0FBQSxJQUFBLENBQWUsT0FBQSxDQUFBLHNCQUFmLENBYVA7QUFKc0MseUJBS3RDLEtBQUssT0FBTCxDQUFlLE1BQU0sQ0FBQyxNQUFQLENBQWMsRUFBZCxDQUFrQixDQUMvQixXQUFXLENBQUUsSUFEa0IsQ0FBbEIsQ0FFWixPQUZZLENBQWYsQ0FMc0MseUJBU3RDLEdBQUksS0FBSyxPQUFMLENBQWEsV0FBYixHQUE2QixLQUFqQyxDQUF3QyxxREFDdEMsS0FBSyxJQUFMLENBQVksS0FBSyxvQkFBTCxFQUFaLENBQ0QsQ0FGRCxpQ0FHRCxDQUVNLE1BQU0sQ0FBQyxNQUFELENBQXdCLGtEQUNuQyxHQUFJLE1BQU0sR0FBSyxJ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QUFBLFlBQVksMkJBQUcsTUFBTSxDQUFDLE9BQVAsQ0FBZSxJQUFmLENBQUgsQ0FBbEIsQ0FISyx5QkFJTCxHQUFJLFlBQVksR0FBSyxDQUFDLENBQXRCLENBQXlCLHNEQUN2QixNQUFNLENBQUMsTUFBUCxDQUFjLFlBQWQsQ0FBNEIsQ0FBNUIsRUFDRCxDQUZELGtDQUdELENBQ0YsQ0FFRCxHQUFJLENBQUEsVUFBVSwyQkFBRyxDQUFILENBQWQsQ0F6QzBCLHlCQTBDMUIsSUFBSyxLQUFNLENBQUEsTUFBWCxHQUFxQixDQUFBLFFBQXJCLENBQStCLDBCQUM3QixVQUFVLEVBQUksTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsTUFBOUIsQ0FDRCxDQUVELEtBQU0sQ0FBQSxpQkFBaUIsMkJBQUcsSUFBSSxDQUFDLEdBQUwsQ0FBUyxDQUFULENBQVksY0FBYyxDQUFHLFVBQTdCLENBQUgsQ0FBdkIsQ0E5QzBCLHlCQStDMUIsSUFBSyxHQUFJLENBQUEsQ0FBQywyQkFBRyxDQUFILENBQVYsQ0FBZ0IsQ0FBQyxDQUFHLGlCQUFwQixDQUF1QyxDQUFDLEVBQXhDLENBQTRDLENBQzFDLEtBQU0sQ0FBQSxZQUFZLDJCQUFHLE1BQU0sQ0FBQyxPQUFQLENBQWUsWUFBQSxDQUFBLFFBQUEsQ0FBUyxTQUF4QixDQUFILENBQWxCLENBRDBDLHlCQUUxQyxHQUFJLFlBQVksR0FBSyxDQUFDLENBQXRCLENBQXlCLHNEQUN2QixNQUFNLENBQUMsTUFBUCxDQUFjLFlBQWQsQ0FBNEIsQ0FBNUIsRUFDRCxDQUZELGtDQUdELENBcER5Qix5QkFzRDFCLE1BQU8sQ0FBQSxNQUFQLENBQ0QsQ0FsR3dELEMseUJBQTNELE9BQUEsQ0FBQSxrQkFBQSxDQUFBLGtCQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYXJkIH0gZnJvbSAnLi4vY2FyZC9jYXJkJztcbmltcG9ydCB7IENhcmRUeXBlIH0gZnJvbSAnLi4vY2FyZC9jYXJkLXR5cGVzJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IFByb21wdCB9IGZyb20gJy4vcHJvbXB0JztcbmltcG9ydCB7IFN0YXRlVXRpbHMgfSBmcm9tICcuLi9zdGF0ZS11dGlscyc7XG5cbmV4cG9ydCBjb25zdCBDaG9vc2VFbmVyZ3lQcm9tcHRUeXBlID0gJ0Nob29zZSBlbmVyZ3knO1xuXG5leHBvcnQgaW50ZXJmYWNlIENob29zZUVuZXJneU9wdGlvbnMge1xuICBhbGxvd0NhbmNlbDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IHR5cGUgRW5lcmd5TWFwID0geyBjYXJkOiBDYXJkLCBwcm92aWRlczogQ2FyZFR5cGVbXSB9XG5cbmV4cG9ydCBjbGFzcyBDaG9vc2VFbmVyZ3lQcm9tcHQgZXh0ZW5kcyBQcm9tcHQ8RW5lcmd5TWFwW10+IHtcblxuICByZWFkb25seSB0eXBlOiBzdHJpbmcgPSBDaG9vc2VFbmVyZ3lQcm9tcHRUeXBlO1xuXG4gIHB1YmxpYyBvcHRpb25zOiBDaG9vc2VFbmVyZ3lPcHRpb25zO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBsYXllcklkOiBudW1iZXIsXG4gICAgcHVibGljIG1lc3NhZ2U6IEdhbWVNZXNzYWdlLFxuICAgIHB1YmxpYyBlbmVyZ3k6IEVuZXJneU1hcFtdLFxuICAgIHB1YmxpYyBjb3N0OiBDYXJkVHlwZVtdLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPENob29zZUVuZXJneU9wdGlvbnM+XG4gICkge1xuICAgIHN1cGVyKHBsYXllcklkKTtcblxuICAgIC8vIERlZmF1bHQgb3B0aW9uc1xuICAgIHRoaXMub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIHtcbiAgICAgIGFsbG93Q2FuY2VsOiB0cnVlXG4gICAgfSwgb3B0aW9ucyk7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmFsbG93Q2FuY2VsID09PSBmYWxzZSkge1xuICAgICAgdGhpcy5jb3N0ID0gdGhpcy5nZXRDb3N0VGhhdENhbkJlUGFpZCgpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBkZWNvZGUocmVzdWx0OiBudW1iZXJbXSB8IG51bGwpOiBFbmVyZ3lNYXBbXSB8IG51bGwge1xuICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBlbmVyZ3k6IEVuZXJneU1hcFtdID0gdGhpcy5lbmVyZ3k7XG4gICAgcmV0dXJuIHJlc3VsdC5tYXAoaW5kZXggPT4gZW5lcmd5W2luZGV4XSk7XG4gIH1cblxuICBwdWJsaWMgdmFsaWRhdGUocmVzdWx0OiBFbmVyZ3lNYXBbXSB8IG51bGwpOiBib29sZWFuIHtcbiAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmFsbG93Q2FuY2VsO1xuICAgIH1cbiAgICBpZiAoIVN0YXRlVXRpbHMuY2hlY2tFeGFjdEVuZXJneShyZXN1bHQsIHRoaXMuY29zdCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBwcml2YXRlIGdldENvc3RUaGF0Q2FuQmVQYWlkKCk6IENhcmRUeXBlW10ge1xuICAgIGNvbnN0IHJlc3VsdDogQ2FyZFR5cGVbXSA9IHRoaXMuY29zdC5zbGljZSgpO1xuICAgIGNvbnN0IHByb3ZpZGVzID0gdGhpcy5lbmVyZ3kuc2xpY2UoKTtcbiAgICBjb25zdCBjb3N0czogQ2FyZFR5cGVbXSA9IHRoaXMuY29zdC5maWx0ZXIoYyA9PiBjICE9PSBDYXJkVHlwZS5DT0xPUkxFU1MpO1xuICAgIGNvbnN0IGNvbG9ybGVzc0NvdW50ID0gcmVzdWx0Lmxlbmd0aCAtIGNvc3RzLmxlbmd0aDtcblxuICAgIHdoaWxlIChjb3N0cy5sZW5ndGggPiAwICYmIHByb3ZpZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGNvc3QgPSBjb3N0c1swXTtcbiAgICAgIGxldCBpbmRleCA9IHByb3ZpZGVzLmZpbmRJbmRleChwID0+IHAucHJvdmlkZXMuaW5jbHVkZXMoY29zdCkpO1xuXG4gICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIC8vIGNvbmNyZXRlIGVuZXJneSBub3QgZm91bmQsIHRyeSB0byB1c2UgcmFpbmJvdyBlbmVyZ2llc1xuICAgICAgICBpbmRleCA9IHByb3ZpZGVzLmZpbmRJbmRleChwID0+IHAucHJvdmlkZXMuaW5jbHVkZXMoQ2FyZFR5cGUuQU5ZKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgLy8gRW5lcmd5IGNhbiBiZSBwYWlkLCBzbyByZW1vdmUgdGhhdCBlbmVyZ3kgZnJvbSB0aGUgcHJvdmlkZXNcbiAgICAgICAgY29uc3QgcHJvdmlkZSA9IHByb3ZpZGVzW2luZGV4XTtcbiAgICAgICAgcHJvdmlkZXMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgICBwcm92aWRlLnByb3ZpZGVzLmZvckVhY2goYyA9PiB7XG4gICAgICAgICAgaWYgKGMgPT09IENhcmRUeXBlLkFOWSAmJiBjb3N0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb3N0cy5zaGlmdCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBpID0gY29zdHMuaW5kZXhPZihjKTtcbiAgICAgICAgICAgIGlmIChpICE9PSAtMSkge1xuICAgICAgICAgICAgICBjb3N0cy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSW1wb3NzaWJsZSB0byBwYXkgZm9yIHRoaXMgY29zdFxuICAgICAgICBjb3N0cy5zaGlmdCgpO1xuICAgICAgICBjb25zdCBjb3N0VG9EZWxldGUgPSByZXN1bHQuaW5kZXhPZihjb3N0KTtcbiAgICAgICAgaWYgKGNvc3RUb0RlbGV0ZSAhPT0gLTEpIHtcbiAgICAgICAgICByZXN1bHQuc3BsaWNlKGNvc3RUb0RlbGV0ZSwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgZW5lcmd5TGVmdCA9IDA7XG4gICAgZm9yIChjb25zdCBlbmVyZ3kgb2YgcHJvdmlkZXMpIHtcbiAgICAgIGVuZXJneUxlZnQgKz0gZW5lcmd5LnByb3ZpZGVzLmxlbmd0aDtcbiAgICB9XG5cbiAgICBjb25zdCBjb2xvcmxlc3NUb0RlbGV0ZSA9IE1hdGgubWF4KDAsIGNvbG9ybGVzc0NvdW50IC0gZW5lcmd5TGVmdCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2xvcmxlc3NUb0RlbGV0ZTsgaSsrKSB7XG4gICAgICBjb25zdCBjb3N0VG9EZWxldGUgPSByZXN1bHQuaW5kZXhPZihDYXJkVHlwZS5DT0xPUkxFU1MpO1xuICAgICAgaWYgKGNvc3RUb0RlbGV0ZSAhPT0gLTEpIHtcbiAgICAgICAgcmVzdWx0LnNwbGljZShjb3N0VG9EZWxldGUsIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxufVxuIl19