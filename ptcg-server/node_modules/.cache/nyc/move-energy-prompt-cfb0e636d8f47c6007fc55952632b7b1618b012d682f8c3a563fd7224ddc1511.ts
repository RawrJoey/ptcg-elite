"use strict";function cov_2e15usx1dh(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-energy-prompt.ts";var hash="c24daf8a4b93f2f06f2f06a171fce96a05411bec";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-energy-prompt.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:65}},"2":{start:{line:4,column:21},end:{line:4,column:48}},"3":{start:{line:5,column:23},end:{line:5,column:52}},"4":{start:{line:6,column:17},end:{line:6,column:36}},"5":{start:{line:7,column:22},end:{line:7,column:47}},"6":{start:{line:8,column:0},end:{line:8,column:45}},"7":{start:{line:11,column:8},end:{line:11,column:24}},"8":{start:{line:12,column:8},end:{line:12,column:31}},"9":{start:{line:13,column:8},end:{line:13,column:37}},"10":{start:{line:14,column:8},end:{line:14,column:27}},"11":{start:{line:15,column:8},end:{line:15,column:29}},"12":{start:{line:16,column:8},end:{line:16,column:49}},"13":{start:{line:18,column:8},end:{line:25,column:20}},"14":{start:{line:28,column:8},end:{line:30,column:9}},"15":{start:{line:29,column:12},end:{line:29,column:26}},"16":{start:{line:31,column:23},end:{line:31,column:70}},"17":{start:{line:31,column:47},end:{line:31,column:69}},"18":{start:{line:32,column:8},end:{line:34,column:9}},"19":{start:{line:33,column:12},end:{line:33,column:95}},"20":{start:{line:35,column:26},end:{line:35,column:28}},"21":{start:{line:36,column:8},end:{line:40,column:11}},"22":{start:{line:37,column:29},end:{line:37,column:86}},"23":{start:{line:38,column:25},end:{line:38,column:48}},"24":{start:{line:39,column:12},end:{line:39,column:61}},"25":{start:{line:41,column:8},end:{line:41,column:25}},"26":{start:{line:44,column:8},end:{line:46,column:9}},"27":{start:{line:45,column:12},end:{line:45,column:44}},"28":{start:{line:47,column:8},end:{line:47,column:55}},"29":{start:{line:47,column:33},end:{line:47,column:53}},"30":{start:{line:50,column:0},end:{line:50,column:44}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:4},end:{line:10,column:5}},loc:{start:{line:10,column:71},end:{line:26,column:5}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:27,column:4},end:{line:27,column:5}},loc:{start:{line:27,column:26},end:{line:42,column:5}},line:27},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:42},end:{line:31,column:43}},loc:{start:{line:31,column:47},end:{line:31,column:69}},line:31},"3":{name:"(anonymous_3)",decl:{start:{line:36,column:23},end:{line:36,column:24}},loc:{start:{line:36,column:28},end:{line:40,column:9}},line:36},"4":{name:"(anonymous_4)",decl:{start:{line:43,column:4},end:{line:43,column:5}},loc:{start:{line:43,column:21},end:{line:48,column:5}},line:43},"5":{name:"(anonymous_5)",decl:{start:{line:47,column:28},end:{line:47,column:29}},loc:{start:{line:47,column:33},end:{line:47,column:53}},line:47}},branchMap:{"0":{loc:{start:{line:28,column:8},end:{line:30,column:9}},type:"if",locations:[{start:{line:28,column:8},end:{line:30,column:9}},{start:{line:28,column:8},end:{line:30,column:9}}],line:28},"1":{loc:{start:{line:32,column:8},end:{line:34,column:9}},type:"if",locations:[{start:{line:32,column:8},end:{line:34,column:9}},{start:{line:32,column:8},end:{line:34,column:9}}],line:32},"2":{loc:{start:{line:44,column:8},end:{line:46,column:9}},type:"if",locations:[{start:{line:44,column:8},end:{line:46,column:9}},{start:{line:44,column:8},end:{line:46,column:9}}],line:44}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-energy-prompt.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-energy-prompt.ts"],names:[],mappings:";;;AACA,iDAA6C;AAC7C,qDAAiD;AACjD,qCAAkC;AAGlC,gDAA4C;AAG/B,QAAA,oBAAoB,GAAG,aAAa,CAAC;AAmBlD,MAAa,gBAAiB,SAAQ,eAAsB;IAM1D,YACE,QAAgB,EACT,OAAoB,EACpB,UAAsB,EACtB,KAAiB,EACjB,MAAkB,EACzB,OAAoC;QAEpC,KAAK,CAAC,QAAQ,CAAC,CAAC;QANT,YAAO,GAAP,OAAO,CAAa;QACpB,eAAU,GAAV,UAAU,CAAY;QACtB,UAAK,GAAL,KAAK,CAAY;QACjB,WAAM,GAAN,MAAM,CAAY;QATlB,SAAI,GAAW,4BAAoB,CAAC;QAc3C,kBAAkB;QAClB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE;YAC/B,WAAW,EAAE,IAAI;YACjB,GAAG,EAAE,CAAC;YACN,GAAG,EAAE,SAAS;YACd,WAAW,EAAE,EAAE;YACf,SAAS,EAAE,EAAE;YACb,UAAU,EAAE,EAAE;SACf,EAAE,OAAO,CAAC,CAAC;IACd,CAAC;IAEM,MAAM,CAAC,MAAmC,EAAE,KAAY;QAC7D,IAAI,MAAM,KAAK,IAAI,EAAE;YACnB,OAAO,MAAM,CAAC,CAAE,sBAAsB;SACvC;QACD,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAI,MAAM,KAAK,SAAS,EAAE;YACxB,MAAM,IAAI,sBAAS,CAAC,0BAAW,CAAC,qBAAqB,CAAC,CAAC;SACxD;QACD,MAAM,SAAS,GAAmB,EAAE,CAAC;QACrC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;YACjB,MAAM,QAAQ,GAAG,wBAAU,CAAC,SAAS,CAAC,KAAK,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC;YAC7D,MAAM,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YACrC,SAAS,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QACH,OAAO,SAAS,CAAC;IACnB,CAAC;IAEM,QAAQ,CAAC,MAA6B;QAC3C,IAAI,MAAM,KAAK,IAAI,EAAE;YACnB,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAE,sBAAsB;SACzD;QACD,OAAO,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC;IACjD,CAAC;CAEF;AAnDD,4CAmDC",sourcesContent:["import { Card } from '../card/card';\nimport { GameError } from '../../game-error';\nimport { GameMessage } from '../../game-message';\nimport { Prompt } from './prompt';\nimport { PlayerType, SlotType, CardTarget } from '../actions/play-card-action';\nimport { State } from '../state/state';\nimport { StateUtils } from '../state-utils';\nimport { FilterType } from './choose-cards-prompt';\n\nexport const MoveEnergyPromptType = 'Move energy';\n\nexport type MoveEnergyResultType = {from: CardTarget, to: CardTarget, index: number}[];\n\nexport interface CardTransfer {\n  from: CardTarget;\n  to: CardTarget;\n  card: Card;\n}\n\nexport interface MoveEnergyOptions {\n  allowCancel: boolean;\n  min: number;\n  max: number | undefined;\n  blockedFrom: CardTarget[];\n  blockedTo: CardTarget[];\n  blockedMap: { source: CardTarget, blocked: number[] }[];\n}\n\nexport class MoveEnergyPrompt extends Prompt<CardTransfer[]> {\n\n  readonly type: string = MoveEnergyPromptType;\n\n  public options: MoveEnergyOptions;\n\n  constructor(\n    playerId: number,\n    public message: GameMessage,\n    public playerType: PlayerType,\n    public slots: SlotType[],\n    public filter: FilterType,\n    options?: Partial<MoveEnergyOptions>\n  ) {\n    super(playerId);\n\n    // Default options\n    this.options = Object.assign({}, {\n      allowCancel: true,\n      min: 0,\n      max: undefined,\n      blockedFrom: [],\n      blockedTo: [],\n      blockedMap: [],\n    }, options);\n  }\n\n  public decode(result: MoveEnergyResultType | null, state: State): CardTransfer[] | null {\n    if (result === null) {\n      return result;  // operation cancelled\n    }\n    const player = state.players.find(p => p.id === this.playerId);\n    if (player === undefined) {\n      throw new GameError(GameMessage.INVALID_PROMPT_RESULT);\n    }\n    const transfers: CardTransfer[] = [];\n    result.forEach(t => {\n      const cardList = StateUtils.getTarget(state, player, t.from);\n      const card = cardList.cards[t.index];\n      transfers.push({ from: t.from, to: t.to, card });\n    });\n    return transfers;\n  }\n\n  public validate(result: CardTransfer[] | null): boolean {\n    if (result === null) {\n      return this.options.allowCancel;  // operation cancelled\n    }\n    return result.every(r => r.card !== undefined);\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c24daf8a4b93f2f06f2f06a171fce96a05411bec"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2e15usx1dh=function(){return actualCoverage;};}return actualCoverage;}cov_2e15usx1dh();cov_2e15usx1dh().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_2e15usx1dh().s[1]++;exports.MoveEnergyPrompt=exports.MoveEnergyPromptType=void 0;const game_error_1=(cov_2e15usx1dh().s[2]++,require("../../game-error"));const game_message_1=(cov_2e15usx1dh().s[3]++,require("../../game-message"));const prompt_1=(cov_2e15usx1dh().s[4]++,require("./prompt"));const state_utils_1=(cov_2e15usx1dh().s[5]++,require("../state-utils"));cov_2e15usx1dh().s[6]++;exports.MoveEnergyPromptType='Move energy';class MoveEnergyPrompt extends(prompt_1.Prompt){constructor(playerId,message,playerType,slots,filter,options){cov_2e15usx1dh().f[0]++;cov_2e15usx1dh().s[7]++;super(playerId);cov_2e15usx1dh().s[8]++;this.message=message;cov_2e15usx1dh().s[9]++;this.playerType=playerType;cov_2e15usx1dh().s[10]++;this.slots=slots;cov_2e15usx1dh().s[11]++;this.filter=filter;cov_2e15usx1dh().s[12]++;this.type=exports.MoveEnergyPromptType;// Default options
cov_2e15usx1dh().s[13]++;this.options=Object.assign({},{allowCancel:true,min:0,max:undefined,blockedFrom:[],blockedTo:[],blockedMap:[]},options);}decode(result,state){cov_2e15usx1dh().f[1]++;cov_2e15usx1dh().s[14]++;if(result===null){cov_2e15usx1dh().b[0][0]++;cov_2e15usx1dh().s[15]++;return result;// operation cancelled
}else{cov_2e15usx1dh().b[0][1]++;}const player=(cov_2e15usx1dh().s[16]++,state.players.find(p=>{cov_2e15usx1dh().f[2]++;cov_2e15usx1dh().s[17]++;return p.id===this.playerId;}));cov_2e15usx1dh().s[18]++;if(player===undefined){cov_2e15usx1dh().b[1][0]++;cov_2e15usx1dh().s[19]++;throw new game_error_1.GameError(game_message_1.GameMessage.INVALID_PROMPT_RESULT);}else{cov_2e15usx1dh().b[1][1]++;}const transfers=(cov_2e15usx1dh().s[20]++,[]);cov_2e15usx1dh().s[21]++;result.forEach(t=>{cov_2e15usx1dh().f[3]++;const cardList=(cov_2e15usx1dh().s[22]++,state_utils_1.StateUtils.getTarget(state,player,t.from));const card=(cov_2e15usx1dh().s[23]++,cardList.cards[t.index]);cov_2e15usx1dh().s[24]++;transfers.push({from:t.from,to:t.to,card});});cov_2e15usx1dh().s[25]++;return transfers;}validate(result){cov_2e15usx1dh().f[4]++;cov_2e15usx1dh().s[26]++;if(result===null){cov_2e15usx1dh().b[2][0]++;cov_2e15usx1dh().s[27]++;return this.options.allowCancel;// operation cancelled
}else{cov_2e15usx1dh().b[2][1]++;}cov_2e15usx1dh().s[28]++;return result.every(r=>{cov_2e15usx1dh().f[5]++;cov_2e15usx1dh().s[29]++;return r.card!==undefined;});}}cov_2e15usx1dh().s[30]++;exports.MoveEnergyPrompt=MoveEnergyPrompt;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcHJvbXB0cy9tb3ZlLWVuZXJneS1wcm9tcHQudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvbW92ZS1lbmVyZ3ktcHJvbXB0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLGlEQUE2QztBQUM3QyxxREFBaUQ7QUFDakQscUNBQWtDO0FBR2xDLGdEQUE0QztBQUcvQixRQUFBLG9CQUFvQixHQUFHLGFBQWEsQ0FBQztBQW1CbEQsTUFBYSxnQkFBaUIsU0FBUSxlQUFzQjtJQU0xRCxZQUNFLFFBQWdCLEVBQ1QsT0FBb0IsRUFDcEIsVUFBc0IsRUFDdEIsS0FBaUIsRUFDakIsTUFBa0IsRUFDekIsT0FBb0M7UUFFcEMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBTlQsWUFBTyxHQUFQLE9BQU8sQ0FBYTtRQUNwQixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQ3RCLFVBQUssR0FBTCxLQUFLLENBQVk7UUFDakIsV0FBTSxHQUFOLE1BQU0sQ0FBWTtRQVRsQixTQUFJLEdBQVcsNEJBQW9CLENBQUM7UUFjM0Msa0JBQWtCO1FBQ2xCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUU7WUFDL0IsV0FBVyxFQUFFLElBQUk7WUFDakIsR0FBRyxFQUFFLENBQUM7WUFDTixHQUFHLEVBQUUsU0FBUztZQUNkLFdBQVcsRUFBRSxFQUFFO1lBQ2YsU0FBUyxFQUFFLEVBQUU7WUFDYixVQUFVLEVBQUUsRUFBRTtTQUNmLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDZCxDQUFDO0lBRU0sTUFBTSxDQUFDLE1BQW1DLEVBQUUsS0FBWTtRQUM3RCxJQUFJLE1BQU0sS0FBSyxJQUFJLEVBQUU7WUFDbkIsT0FBTyxNQUFNLENBQUMsQ0FBRSxzQkFBc0I7U0FDdkM7UUFDRCxNQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQy9ELElBQUksTUFBTSxLQUFLLFNBQVMsRUFBRTtZQUN4QixNQUFNLElBQUksc0JBQVMsQ0FBQywwQkFBVyxDQUFDLHFCQUFxQixDQUFDLENBQUM7U0FDeEQ7UUFDRCxNQUFNLFNBQVMsR0FBbUIsRUFBRSxDQUFDO1FBQ3JDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDakIsTUFBTSxRQUFRLEdBQUcsd0JBQVUsQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDN0QsTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDckMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7UUFDSCxPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDO0lBRU0sUUFBUSxDQUFDLE1BQTZCO1FBQzNDLElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUUsc0JBQXNCO1NBQ3pEO1FBQ0QsT0FBTyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxTQUFTLENBQUMsQ0FBQztJQUNqRCxDQUFDO0NBRUY7QUFuREQsNENBbURDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4uL2NhcmQvY2FyZCc7XG5pbXBvcnQgeyBHYW1lRXJyb3IgfSBmcm9tICcuLi8uLi9nYW1lLWVycm9yJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IFByb21wdCB9IGZyb20gJy4vcHJvbXB0JztcbmltcG9ydCB7IFBsYXllclR5cGUsIFNsb3RUeXBlLCBDYXJkVGFyZ2V0IH0gZnJvbSAnLi4vYWN0aW9ucy9wbGF5LWNhcmQtYWN0aW9uJztcbmltcG9ydCB7IFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvc3RhdGUnO1xuaW1wb3J0IHsgU3RhdGVVdGlscyB9IGZyb20gJy4uL3N0YXRlLXV0aWxzJztcbmltcG9ydCB7IEZpbHRlclR5cGUgfSBmcm9tICcuL2Nob29zZS1jYXJkcy1wcm9tcHQnO1xuXG5leHBvcnQgY29uc3QgTW92ZUVuZXJneVByb21wdFR5cGUgPSAnTW92ZSBlbmVyZ3knO1xuXG5leHBvcnQgdHlwZSBNb3ZlRW5lcmd5UmVzdWx0VHlwZSA9IHtmcm9tOiBDYXJkVGFyZ2V0LCB0bzogQ2FyZFRhcmdldCwgaW5kZXg6IG51bWJlcn1bXTtcblxuZXhwb3J0IGludGVyZmFjZSBDYXJkVHJhbnNmZXIge1xuICBmcm9tOiBDYXJkVGFyZ2V0O1xuICB0bzogQ2FyZFRhcmdldDtcbiAgY2FyZDogQ2FyZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNb3ZlRW5lcmd5T3B0aW9ucyB7XG4gIGFsbG93Q2FuY2VsOiBib29sZWFuO1xuICBtaW46IG51bWJlcjtcbiAgbWF4OiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIGJsb2NrZWRGcm9tOiBDYXJkVGFyZ2V0W107XG4gIGJsb2NrZWRUbzogQ2FyZFRhcmdldFtdO1xuICBibG9ja2VkTWFwOiB7IHNvdXJjZTogQ2FyZFRhcmdldCwgYmxvY2tlZDogbnVtYmVyW10gfVtdO1xufVxuXG5leHBvcnQgY2xhc3MgTW92ZUVuZXJneVByb21wdCBleHRlbmRzIFByb21wdDxDYXJkVHJhbnNmZXJbXT4ge1xuXG4gIHJlYWRvbmx5IHR5cGU6IHN0cmluZyA9IE1vdmVFbmVyZ3lQcm9tcHRUeXBlO1xuXG4gIHB1YmxpYyBvcHRpb25zOiBNb3ZlRW5lcmd5T3B0aW9ucztcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwbGF5ZXJJZDogbnVtYmVyLFxuICAgIHB1YmxpYyBtZXNzYWdlOiBHYW1lTWVzc2FnZSxcbiAgICBwdWJsaWMgcGxheWVyVHlwZTogUGxheWVyVHlwZSxcbiAgICBwdWJsaWMgc2xvdHM6IFNsb3RUeXBlW10sXG4gICAgcHVibGljIGZpbHRlcjogRmlsdGVyVHlwZSxcbiAgICBvcHRpb25zPzogUGFydGlhbDxNb3ZlRW5lcmd5T3B0aW9ucz5cbiAgKSB7XG4gICAgc3VwZXIocGxheWVySWQpO1xuXG4gICAgLy8gRGVmYXVsdCBvcHRpb25zXG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwge1xuICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXG4gICAgICBtaW46IDAsXG4gICAgICBtYXg6IHVuZGVmaW5lZCxcbiAgICAgIGJsb2NrZWRGcm9tOiBbXSxcbiAgICAgIGJsb2NrZWRUbzogW10sXG4gICAgICBibG9ja2VkTWFwOiBbXSxcbiAgICB9LCBvcHRpb25zKTtcbiAgfVxuXG4gIHB1YmxpYyBkZWNvZGUocmVzdWx0OiBNb3ZlRW5lcmd5UmVzdWx0VHlwZSB8IG51bGwsIHN0YXRlOiBTdGF0ZSk6IENhcmRUcmFuc2ZlcltdIHwgbnVsbCB7XG4gICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHJlc3VsdDsgIC8vIG9wZXJhdGlvbiBjYW5jZWxsZWRcbiAgICB9XG4gICAgY29uc3QgcGxheWVyID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gdGhpcy5wbGF5ZXJJZCk7XG4gICAgaWYgKHBsYXllciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklOVkFMSURfUFJPTVBUX1JFU1VMVCk7XG4gICAgfVxuICAgIGNvbnN0IHRyYW5zZmVyczogQ2FyZFRyYW5zZmVyW10gPSBbXTtcbiAgICByZXN1bHQuZm9yRWFjaCh0ID0+IHtcbiAgICAgIGNvbnN0IGNhcmRMaXN0ID0gU3RhdGVVdGlscy5nZXRUYXJnZXQoc3RhdGUsIHBsYXllciwgdC5mcm9tKTtcbiAgICAgIGNvbnN0IGNhcmQgPSBjYXJkTGlzdC5jYXJkc1t0LmluZGV4XTtcbiAgICAgIHRyYW5zZmVycy5wdXNoKHsgZnJvbTogdC5mcm9tLCB0bzogdC50bywgY2FyZCB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdHJhbnNmZXJzO1xuICB9XG5cbiAgcHVibGljIHZhbGlkYXRlKHJlc3VsdDogQ2FyZFRyYW5zZmVyW10gfCBudWxsKTogYm9vbGVhbiB7XG4gICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5hbGxvd0NhbmNlbDsgIC8vIG9wZXJhdGlvbiBjYW5jZWxsZWRcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdC5ldmVyeShyID0+IHIuY2FyZCAhPT0gdW5kZWZpbmVkKTtcbiAgfVxuXG59XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvbW92ZS1lbmVyZ3ktcHJvbXB0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJpbVFBOEJXO2lRQTdCWCxLQUFBLENBQUEsWUFBQSwwQkFBQSxPQUFBLENBQUEsa0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGNBQUEsMEJBQUEsT0FBQSxDQUFBLG9CQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxRQUFBLDBCQUFBLE9BQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQSxDQUdBLEtBQUEsQ0FBQSxhQUFBLDBCQUFBLE9BQUEsQ0FBQSxnQkFBQSxDQUFBLENBQUEsQyx3QkFHYSxPQUFBLENBQUEsb0JBQUEsQ0FBdUIsYUFBdkIsQ0FtQmIsS0FBYSxDQUFBLGdCQUFiLFNBQXNDLFFBQUEsQ0FBQSxNQUF0QyxDQUE0RCxDQU0xRCxXQUFBLENBQ0UsUUFERixDQUVTLE9BRlQsQ0FHUyxVQUhULENBSVMsS0FKVCxDQUtTLE1BTFQsQ0FNRSxPQU5GLENBTXNDLGlEQUVwQyxNQUFNLFFBQU4sRUFGb0Msd0JBSjdCLEtBQUEsT0FBQSxDQUFBLE9BQUEsQ0FJNkIsd0JBSDdCLEtBQUEsVUFBQSxDQUFBLFVBQUEsQ0FHNkIseUJBRjdCLEtBQUEsS0FBQSxDQUFBLEtBQUEsQ0FFNkIseUJBRDdCLEtBQUEsTUFBQSxDQUFBLE1BQUEsQ0FDNkIseUJBVjdCLEtBQUEsSUFBQSxDQUFlLE9BQUEsQ0FBQSxvQkFBZixDQWNQO0FBSm9DLHlCQUtwQyxLQUFLLE9BQUwsQ0FBZSxNQUFNLENBQUMsTUFBUCxDQUFjLEVBQWQsQ0FBa0IsQ0FDL0IsV0FBVyxDQUFFLElBRGtCLENBRS9CLEdBQUcsQ0FBRSxDQUYwQixDQUcvQixHQUFHLENBQUUsU0FIMEIsQ0FJL0IsV0FBVyxDQUFFLEVBSmtCLENBSy9CLFNBQVMsQ0FBRSxFQUxvQixDQU0vQixVQUFVLENBQUUsRUFObUIsQ0FBbEIsQ0FPWixPQVBZLENBQWYsQ0FRRCxDQUVNLE1BQU0sQ0FBQyxNQUFELENBQXNDLEtBQXRDLENBQWtELGtEQUM3RCxHQUFJLE1BQU0sR0FBSyxJQUFmLENBQXFCLHFEQUNuQixNQUFPLENBQUEsTUFBUCxDQUFnQjtBQUNqQixDQUZELGlDQUdBLEtBQU0sQ0FBQSxNQUFNLDJCQUFHLEtBQUssQ0FBQyxPQUFOLENBQWMsSUFBZCxDQUFtQixDQUFDLEVBQUksd0RBQUEsQ0FBQSxDQUFDLENBQUMsRUFBRixHQUFTLEtBQUssUUFBZCxDQUFzQixDQUE5QyxDQUFILENBQVosQ0FKNkQseUJBSzdELEdBQUksTUFBTSxHQUFLLFNBQWYsQ0FBMEIscURBQ3hCLEtBQU0sSUFBSSxDQUFBLFlBQUEsQ0FBQSxTQUFKLENBQWMsY0FBQSxDQUFBLFdBQUEsQ0FBWSxxQkFBMUIsQ0FBTixDQUNELENBRkQsaUNBR0EsS0FBTSxDQUFBLFNBQVMsMkJBQW1CLEVBQW5CLENBQWYsQ0FSNkQseUJBUzdELE1BQU0sQ0FBQyxPQUFQLENBQWUsQ0FBQyxFQUFHLHlCQUNqQixLQUFNLENBQUEsUUFBUSwyQkFBRyxhQUFBLENBQUEsVUFBQSxDQUFXLFNBQVgsQ0FBcUIsS0FBckIsQ0FBNEIsTUFBNUIsQ0FBb0MsQ0FBQyxDQUFDLElBQXRDLENBQUgsQ0FBZCxDQUNBLEtBQU0sQ0FBQSxJQUFJLDJCQUFHLFFBQVEsQ0FBQyxLQUFULENBQWUsQ0FBQyxDQUFDLEtBQWpCLENBQUgsQ0FBVixDQUZpQix5QkFHakIsU0FBUyxDQUFDLElBQVYsQ0FBZSxDQUFFLElBQUksQ0FBRSxDQUFDLENBQUMsSUFBVixDQUFnQixFQUFFLENBQUUsQ0FBQyxDQUFDLEVBQXRCLENBQTBCLElBQTFCLENBQWYsRUFDRCxDQUpELEVBVDZELHlCQWM3RCxNQUFPLENBQUEsU0FBUCxDQUNELENBRU0sUUFBUSxDQUFDLE1BQUQsQ0FBOEIsa0RBQzNDLEdBQUksTUFBTSxHQUFLLElBQWYsQ0FBcUIscURBQ25CLE1BQU8sTUFBSyxPQUFMLENBQWEsV0FBcEIsQ0FBa0M7QUFDbkMsQ0FGRCxpQ0FEMkMseUJBSTNDLE1BQU8sQ0FBQSxNQUFNLENBQUMsS0FBUCxDQUFhLENBQUMsRUFBSSx3REFBQSxDQUFBLENBQUMsQ0FBQyxJQUFGLEdBQVcsU0FBWCxDQUFvQixDQUF0QyxDQUFQLENBQ0QsQ0FqRHlELEMseUJBQTVELE9BQUEsQ0FBQSxnQkFBQSxDQUFBLGdCQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYXJkIH0gZnJvbSAnLi4vY2FyZC9jYXJkJztcbmltcG9ydCB7IEdhbWVFcnJvciB9IGZyb20gJy4uLy4uL2dhbWUtZXJyb3InO1xuaW1wb3J0IHsgR2FtZU1lc3NhZ2UgfSBmcm9tICcuLi8uLi9nYW1lLW1lc3NhZ2UnO1xuaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi9wcm9tcHQnO1xuaW1wb3J0IHsgUGxheWVyVHlwZSwgU2xvdFR5cGUsIENhcmRUYXJnZXQgfSBmcm9tICcuLi9hY3Rpb25zL3BsYXktY2FyZC1hY3Rpb24nO1xuaW1wb3J0IHsgU3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9zdGF0ZSc7XG5pbXBvcnQgeyBTdGF0ZVV0aWxzIH0gZnJvbSAnLi4vc3RhdGUtdXRpbHMnO1xuaW1wb3J0IHsgRmlsdGVyVHlwZSB9IGZyb20gJy4vY2hvb3NlLWNhcmRzLXByb21wdCc7XG5cbmV4cG9ydCBjb25zdCBNb3ZlRW5lcmd5UHJvbXB0VHlwZSA9ICdNb3ZlIGVuZXJneSc7XG5cbmV4cG9ydCB0eXBlIE1vdmVFbmVyZ3lSZXN1bHRUeXBlID0ge2Zyb206IENhcmRUYXJnZXQsIHRvOiBDYXJkVGFyZ2V0LCBpbmRleDogbnVtYmVyfVtdO1xuXG5leHBvcnQgaW50ZXJmYWNlIENhcmRUcmFuc2ZlciB7XG4gIGZyb206IENhcmRUYXJnZXQ7XG4gIHRvOiBDYXJkVGFyZ2V0O1xuICBjYXJkOiBDYXJkO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vdmVFbmVyZ3lPcHRpb25zIHtcbiAgYWxsb3dDYW5jZWw6IGJvb2xlYW47XG4gIG1pbjogbnVtYmVyO1xuICBtYXg6IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgYmxvY2tlZEZyb206IENhcmRUYXJnZXRbXTtcbiAgYmxvY2tlZFRvOiBDYXJkVGFyZ2V0W107XG4gIGJsb2NrZWRNYXA6IHsgc291cmNlOiBDYXJkVGFyZ2V0LCBibG9ja2VkOiBudW1iZXJbXSB9W107XG59XG5cbmV4cG9ydCBjbGFzcyBNb3ZlRW5lcmd5UHJvbXB0IGV4dGVuZHMgUHJvbXB0PENhcmRUcmFuc2ZlcltdPiB7XG5cbiAgcmVhZG9ubHkgdHlwZTogc3RyaW5nID0gTW92ZUVuZXJneVByb21wdFR5cGU7XG5cbiAgcHVibGljIG9wdGlvbnM6IE1vdmVFbmVyZ3lPcHRpb25zO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBsYXllcklkOiBudW1iZXIsXG4gICAgcHVibGljIG1lc3NhZ2U6IEdhbWVNZXNzYWdlLFxuICAgIHB1YmxpYyBwbGF5ZXJUeXBlOiBQbGF5ZXJUeXBlLFxuICAgIHB1YmxpYyBzbG90czogU2xvdFR5cGVbXSxcbiAgICBwdWJsaWMgZmlsdGVyOiBGaWx0ZXJUeXBlLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPE1vdmVFbmVyZ3lPcHRpb25zPlxuICApIHtcbiAgICBzdXBlcihwbGF5ZXJJZCk7XG5cbiAgICAvLyBEZWZhdWx0IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcbiAgICAgIG1pbjogMCxcbiAgICAgIG1heDogdW5kZWZpbmVkLFxuICAgICAgYmxvY2tlZEZyb206IFtdLFxuICAgICAgYmxvY2tlZFRvOiBbXSxcbiAgICAgIGJsb2NrZWRNYXA6IFtdLFxuICAgIH0sIG9wdGlvbnMpO1xuICB9XG5cbiAgcHVibGljIGRlY29kZShyZXN1bHQ6IE1vdmVFbmVyZ3lSZXN1bHRUeXBlIHwgbnVsbCwgc3RhdGU6IFN0YXRlKTogQ2FyZFRyYW5zZmVyW10gfCBudWxsIHtcbiAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gcmVzdWx0OyAgLy8gb3BlcmF0aW9uIGNhbmNlbGxlZFxuICAgIH1cbiAgICBjb25zdCBwbGF5ZXIgPSBzdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSB0aGlzLnBsYXllcklkKTtcbiAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSU5WQUxJRF9QUk9NUFRfUkVTVUxUKTtcbiAgICB9XG4gICAgY29uc3QgdHJhbnNmZXJzOiBDYXJkVHJhbnNmZXJbXSA9IFtdO1xuICAgIHJlc3VsdC5mb3JFYWNoKHQgPT4ge1xuICAgICAgY29uc3QgY2FyZExpc3QgPSBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCB0LmZyb20pO1xuICAgICAgY29uc3QgY2FyZCA9IGNhcmRMaXN0LmNhcmRzW3QuaW5kZXhdO1xuICAgICAgdHJhbnNmZXJzLnB1c2goeyBmcm9tOiB0LmZyb20sIHRvOiB0LnRvLCBjYXJkIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiB0cmFuc2ZlcnM7XG4gIH1cblxuICBwdWJsaWMgdmFsaWRhdGUocmVzdWx0OiBDYXJkVHJhbnNmZXJbXSB8IG51bGwpOiBib29sZWFuIHtcbiAgICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmFsbG93Q2FuY2VsOyAgLy8gb3BlcmF0aW9uIGNhbmNlbGxlZFxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0LmV2ZXJ5KHIgPT4gci5jYXJkICE9PSB1bmRlZmluZWQpO1xuICB9XG5cbn1cbiJdfQ==