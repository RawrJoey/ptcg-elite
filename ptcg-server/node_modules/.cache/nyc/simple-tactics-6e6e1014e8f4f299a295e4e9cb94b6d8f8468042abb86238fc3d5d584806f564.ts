"use strict";function cov_nx4914qqr(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/simple-tactics/simple-tactics.ts";var hash="023df33d9766e240e52ae02d8ec1ccb20e9d01f6";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/simple-tactics/simple-tactics.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:30}},"2":{start:{line:4,column:15},end:{line:4,column:36}},"3":{start:{line:5,column:20},end:{line:5,column:56}},"4":{start:{line:6,column:22},end:{line:6,column:59}},"5":{start:{line:9,column:8},end:{line:9,column:31}},"6":{start:{line:10,column:8},end:{line:10,column:69}},"7":{start:{line:13,column:8},end:{line:15,column:9}},"8":{start:{line:14,column:12},end:{line:14,column:103}},"9":{start:{line:16,column:8},end:{line:20,column:9}},"10":{start:{line:16,column:25},end:{line:16,column:26}},"11":{start:{line:17,column:12},end:{line:19,column:13}},"12":{start:{line:18,column:16},end:{line:18,column:103}},"13":{start:{line:21,column:25},end:{line:21,column:62}},"14":{start:{line:21,column:49},end:{line:21,column:61}},"15":{start:{line:22,column:8},end:{line:24,column:9}},"16":{start:{line:23,column:12},end:{line:23,column:78}},"17":{start:{line:25,column:8},end:{line:27,column:9}},"18":{start:{line:26,column:12},end:{line:26,column:100}},"19":{start:{line:28,column:8},end:{line:32,column:9}},"20":{start:{line:28,column:25},end:{line:28,column:26}},"21":{start:{line:29,column:12},end:{line:31,column:13}},"22":{start:{line:30,column:16},end:{line:30,column:100}},"23":{start:{line:33,column:8},end:{line:33,column:70}},"24":{start:{line:36,column:23},end:{line:36,column:28}},"25":{start:{line:37,column:8},end:{line:56,column:9}},"26":{start:{line:38,column:30},end:{line:38,column:84}},"27":{start:{line:39,column:12},end:{line:39,column:50}},"28":{start:{line:40,column:12},end:{line:52,column:13}},"29":{start:{line:40,column:59},end:{line:40,column:81}},"30":{start:{line:41,column:16},end:{line:41,column:49}},"31":{start:{line:42,column:31},end:{line:42,column:81}},"32":{start:{line:42,column:58},end:{line:42,column:80}},"33":{start:{line:43,column:16},end:{line:45,column:17}},"34":{start:{line:44,column:20},end:{line:44,column:26}},"35":{start:{line:46,column:31},end:{line:46,column:83}},"36":{start:{line:46,column:58},end:{line:46,column:82}},"37":{start:{line:47,column:16},end:{line:49,column:17}},"38":{start:{line:48,column:20},end:{line:48,column:26}},"39":{start:{line:50,column:38},end:{line:50,column:82}},"40":{start:{line:51,column:16},end:{line:51,column:61}},"41":{start:{line:55,column:12},end:{line:55,column:29}},"42":{start:{line:57,column:8},end:{line:57,column:24}},"43":{start:{line:60,column:26},end:{line:60,column:98}},"44":{start:{line:60,column:71},end:{line:60,column:97}},"45":{start:{line:61,column:8},end:{line:66,column:9}},"46":{start:{line:61,column:21},end:{line:61,column:22}},"47":{start:{line:62,column:27},end:{line:62,column:76}},"48":{start:{line:63,column:12},end:{line:65,column:13}},"49":{start:{line:64,column:16},end:{line:64,column:30}},"50":{start:{line:68,column:8},end:{line:68,column:63}},"51":{start:{line:71,column:8},end:{line:71,column:57}},"52":{start:{line:74,column:25},end:{line:74,column:59}},"53":{start:{line:75,column:26},end:{line:75,column:83}},"54":{start:{line:75,column:65},end:{line:75,column:82}},"55":{start:{line:76,column:8},end:{line:79,column:9}},"56":{start:{line:77,column:12},end:{line:78,column:67}},"57":{start:{line:82,column:0},end:{line:82,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:4},end:{line:8,column:5}},loc:{start:{line:8,column:25},end:{line:11,column:5}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:12,column:4},end:{line:12,column:5}},loc:{start:{line:12,column:41},end:{line:34,column:5}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:44},end:{line:21,column:45}},loc:{start:{line:21,column:49},end:{line:21,column:61}},line:21},"3":{name:"(anonymous_3)",decl:{start:{line:35,column:4},end:{line:35,column:5}},loc:{start:{line:35,column:34},end:{line:58,column:5}},line:35},"4":{name:"(anonymous_4)",decl:{start:{line:40,column:54},end:{line:40,column:55}},loc:{start:{line:40,column:59},end:{line:40,column:81}},line:40},"5":{name:"(anonymous_5)",decl:{start:{line:42,column:53},end:{line:42,column:54}},loc:{start:{line:42,column:58},end:{line:42,column:80}},line:42},"6":{name:"(anonymous_6)",decl:{start:{line:46,column:53},end:{line:46,column:54}},loc:{start:{line:46,column:58},end:{line:46,column:82}},line:46},"7":{name:"(anonymous_7)",decl:{start:{line:59,column:4},end:{line:59,column:5}},loc:{start:{line:59,column:41},end:{line:69,column:5}},line:59},"8":{name:"(anonymous_8)",decl:{start:{line:60,column:59},end:{line:60,column:60}},loc:{start:{line:60,column:71},end:{line:60,column:97}},line:60},"9":{name:"(anonymous_9)",decl:{start:{line:70,column:4},end:{line:70,column:5}},loc:{start:{line:70,column:35},end:{line:72,column:5}},line:70},"10":{name:"(anonymous_10)",decl:{start:{line:73,column:4},end:{line:73,column:5}},loc:{start:{line:73,column:63},end:{line:80,column:5}},line:73},"11":{name:"(anonymous_11)",decl:{start:{line:75,column:60},end:{line:75,column:61}},loc:{start:{line:75,column:65},end:{line:75,column:82}},line:75}},branchMap:{"0":{loc:{start:{line:13,column:8},end:{line:15,column:9}},type:"if",locations:[{start:{line:13,column:8},end:{line:15,column:9}},{start:{line:13,column:8},end:{line:15,column:9}}],line:13},"1":{loc:{start:{line:17,column:12},end:{line:19,column:13}},type:"if",locations:[{start:{line:17,column:12},end:{line:19,column:13}},{start:{line:17,column:12},end:{line:19,column:13}}],line:17},"2":{loc:{start:{line:22,column:8},end:{line:24,column:9}},type:"if",locations:[{start:{line:22,column:8},end:{line:24,column:9}},{start:{line:22,column:8},end:{line:24,column:9}}],line:22},"3":{loc:{start:{line:25,column:8},end:{line:27,column:9}},type:"if",locations:[{start:{line:25,column:8},end:{line:27,column:9}},{start:{line:25,column:8},end:{line:27,column:9}}],line:25},"4":{loc:{start:{line:29,column:12},end:{line:31,column:13}},type:"if",locations:[{start:{line:29,column:12},end:{line:31,column:13}},{start:{line:29,column:12},end:{line:31,column:13}}],line:29},"5":{loc:{start:{line:43,column:16},end:{line:45,column:17}},type:"if",locations:[{start:{line:43,column:16},end:{line:45,column:17}},{start:{line:43,column:16},end:{line:45,column:17}}],line:43},"6":{loc:{start:{line:47,column:16},end:{line:49,column:17}},type:"if",locations:[{start:{line:47,column:16},end:{line:49,column:17}},{start:{line:47,column:16},end:{line:49,column:17}}],line:47},"7":{loc:{start:{line:63,column:12},end:{line:65,column:13}},type:"if",locations:[{start:{line:63,column:12},end:{line:65,column:13}},{start:{line:63,column:12},end:{line:65,column:13}}],line:63},"8":{loc:{start:{line:73,column:44},end:{line:73,column:61}},type:"default-arg",locations:[{start:{line:73,column:60},end:{line:73,column:61}}],line:73},"9":{loc:{start:{line:75,column:26},end:{line:75,column:83}},type:"binary-expr",locations:[{start:{line:75,column:26},end:{line:75,column:34}},{start:{line:75,column:38},end:{line:75,column:83}}],line:75},"10":{loc:{start:{line:76,column:8},end:{line:79,column:9}},type:"if",locations:[{start:{line:76,column:8},end:{line:79,column:9}},{start:{line:76,column:8},end:{line:79,column:9}}],line:76},"11":{loc:{start:{line:76,column:12},end:{line:76,column:61}},type:"binary-expr",locations:[{start:{line:76,column:12},end:{line:76,column:34}},{start:{line:76,column:38},end:{line:76,column:61}}],line:76},"12":{loc:{start:{line:78,column:19},end:{line:78,column:65}},type:"cond-expr",locations:[{start:{line:78,column:48},end:{line:78,column:61}},{start:{line:78,column:64},end:{line:78,column:65}}],line:78}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/simple-tactics/simple-tactics.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/simple-tactics/simple-tactics.ts"],names:[],mappings:"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",sourcesContent:["import { Action, Player, State, PokemonCardList, CardTarget, PlayerType,\n  SlotType, GameError, GameMessage, Prompt, ResolvePromptAction } from '../../game';\nimport { Simulator } from '../../game/bots/simulator';\nimport { SimpleBotOptions } from '../simple-bot-options';\nimport { StateScore } from '../state-score/state-score';\n\nexport type SimpleTacticList = (new (options: SimpleBotOptions) => SimpleTactic)[];\n\nexport abstract class SimpleTactic {\n\n  private stateScore: StateScore;\n\n  constructor(protected options: SimpleBotOptions) {\n    this.stateScore = new StateScore(this.options);\n  }\n\n  public abstract useTactic(state: State, player: Player): Action | undefined;\n\n  protected getCardTarget(player: Player, state: State, target: PokemonCardList): CardTarget {\n    if (target === player.active) {\n      return { player: PlayerType.BOTTOM_PLAYER, slot: SlotType.ACTIVE, index: 0 };\n    }\n\n    for (let index = 0; index < player.bench.length; index++) {\n      if (target === player.bench[index]) {\n        return { player: PlayerType.BOTTOM_PLAYER, slot: SlotType.BENCH, index };\n      }\n    }\n\n    const opponent = state.players.find(p => p !== player);\n    if (opponent === undefined) {\n      throw new GameError(GameMessage.INVALID_GAME_STATE);\n    }\n\n    if (target === opponent.active) {\n      return { player: PlayerType.TOP_PLAYER, slot: SlotType.ACTIVE, index: 0 };\n    }\n\n    for (let index = 0; index < opponent.bench.length; index++) {\n      if (target === opponent.bench[index]) {\n        return { player: PlayerType.TOP_PLAYER, slot: SlotType.BENCH, index };\n      }\n    }\n\n    throw new GameError(GameMessage.INVALID_TARGET);\n  }\n\n  protected simulateAction(state: State, action: Action): State | undefined {\n    let newState = state;\n    try {\n      const simulator = new Simulator(state, this.options.arbiter);\n      newState = simulator.dispatch(action);\n      \n      while (simulator.store.state.prompts.some(p => p.result === undefined)) {\n        newState = simulator.store.state;\n        const prompt = newState.prompts.find(p => p.result === undefined);\n        if (prompt === undefined) {\n          break;\n        }\n        const player = newState.players.find(p => p.id === prompt.playerId);\n        if (player === undefined) {\n          break;\n        }\n        const resolveAction = this.resolvePrompt(newState, player, prompt);\n        newState = simulator.dispatch(resolveAction);\n      }\n    } catch (error) {\n      return undefined;\n    }\n\n    return newState;\n  }\n\n  private resolvePrompt(state: State, player: Player, prompt: Prompt<any>): Action {\n    const resolvers = this.options.promptResolvers.map(resolver => new resolver(this.options));\n\n    for (let i = 0; i < resolvers.length; i++) {\n      const action = resolvers[i].resolvePrompt(state, player, prompt);\n      if (action !== undefined) {\n        return action;\n      }\n    }\n\n    // Unknown prompt. Try to cancel it.\n    return new ResolvePromptAction(prompt.id, null);\n  }\n\n  protected getStateScore(state: State, playerId: number): number {\n    return this.stateScore.getScore(state, playerId);\n  }\n\n  protected evaluateAction(state: State, playerId: number, action: Action, passTurnScore: number = 0): number | undefined {\n    const newState = this.simulateAction(state, action);\n    const newPlayer = newState && newState.players.find(p => p.id === playerId);\n    if (newState !== undefined && newPlayer !== undefined) {\n      return this.stateScore.getScore(newState, playerId)\n        + (newState.turn > state.turn ? passTurnScore : 0);\n    }\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"023df33d9766e240e52ae02d8ec1ccb20e9d01f6"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_nx4914qqr=function(){return actualCoverage;};}return actualCoverage;}cov_nx4914qqr();cov_nx4914qqr().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_nx4914qqr().s[1]++;exports.SimpleTactic=void 0;const game_1=(cov_nx4914qqr().s[2]++,require("../../game"));const simulator_1=(cov_nx4914qqr().s[3]++,require("../../game/bots/simulator"));const state_score_1=(cov_nx4914qqr().s[4]++,require("../state-score/state-score"));class SimpleTactic{constructor(options){cov_nx4914qqr().f[0]++;cov_nx4914qqr().s[5]++;this.options=options;cov_nx4914qqr().s[6]++;this.stateScore=new state_score_1.StateScore(this.options);}getCardTarget(player,state,target){cov_nx4914qqr().f[1]++;cov_nx4914qqr().s[7]++;if(target===player.active){cov_nx4914qqr().b[0][0]++;cov_nx4914qqr().s[8]++;return{player:game_1.PlayerType.BOTTOM_PLAYER,slot:game_1.SlotType.ACTIVE,index:0};}else{cov_nx4914qqr().b[0][1]++;}cov_nx4914qqr().s[9]++;for(let index=(cov_nx4914qqr().s[10]++,0);index<player.bench.length;index++){cov_nx4914qqr().s[11]++;if(target===player.bench[index]){cov_nx4914qqr().b[1][0]++;cov_nx4914qqr().s[12]++;return{player:game_1.PlayerType.BOTTOM_PLAYER,slot:game_1.SlotType.BENCH,index};}else{cov_nx4914qqr().b[1][1]++;}}const opponent=(cov_nx4914qqr().s[13]++,state.players.find(p=>{cov_nx4914qqr().f[2]++;cov_nx4914qqr().s[14]++;return p!==player;}));cov_nx4914qqr().s[15]++;if(opponent===undefined){cov_nx4914qqr().b[2][0]++;cov_nx4914qqr().s[16]++;throw new game_1.GameError(game_1.GameMessage.INVALID_GAME_STATE);}else{cov_nx4914qqr().b[2][1]++;}cov_nx4914qqr().s[17]++;if(target===opponent.active){cov_nx4914qqr().b[3][0]++;cov_nx4914qqr().s[18]++;return{player:game_1.PlayerType.TOP_PLAYER,slot:game_1.SlotType.ACTIVE,index:0};}else{cov_nx4914qqr().b[3][1]++;}cov_nx4914qqr().s[19]++;for(let index=(cov_nx4914qqr().s[20]++,0);index<opponent.bench.length;index++){cov_nx4914qqr().s[21]++;if(target===opponent.bench[index]){cov_nx4914qqr().b[4][0]++;cov_nx4914qqr().s[22]++;return{player:game_1.PlayerType.TOP_PLAYER,slot:game_1.SlotType.BENCH,index};}else{cov_nx4914qqr().b[4][1]++;}}cov_nx4914qqr().s[23]++;throw new game_1.GameError(game_1.GameMessage.INVALID_TARGET);}simulateAction(state,action){cov_nx4914qqr().f[3]++;let newState=(cov_nx4914qqr().s[24]++,state);cov_nx4914qqr().s[25]++;try{const simulator=(cov_nx4914qqr().s[26]++,new simulator_1.Simulator(state,this.options.arbiter));cov_nx4914qqr().s[27]++;newState=simulator.dispatch(action);cov_nx4914qqr().s[28]++;while(simulator.store.state.prompts.some(p=>{cov_nx4914qqr().f[4]++;cov_nx4914qqr().s[29]++;return p.result===undefined;})){cov_nx4914qqr().s[30]++;newState=simulator.store.state;const prompt=(cov_nx4914qqr().s[31]++,newState.prompts.find(p=>{cov_nx4914qqr().f[5]++;cov_nx4914qqr().s[32]++;return p.result===undefined;}));cov_nx4914qqr().s[33]++;if(prompt===undefined){cov_nx4914qqr().b[5][0]++;cov_nx4914qqr().s[34]++;break;}else{cov_nx4914qqr().b[5][1]++;}const player=(cov_nx4914qqr().s[35]++,newState.players.find(p=>{cov_nx4914qqr().f[6]++;cov_nx4914qqr().s[36]++;return p.id===prompt.playerId;}));cov_nx4914qqr().s[37]++;if(player===undefined){cov_nx4914qqr().b[6][0]++;cov_nx4914qqr().s[38]++;break;}else{cov_nx4914qqr().b[6][1]++;}const resolveAction=(cov_nx4914qqr().s[39]++,this.resolvePrompt(newState,player,prompt));cov_nx4914qqr().s[40]++;newState=simulator.dispatch(resolveAction);}}catch(error){cov_nx4914qqr().s[41]++;return undefined;}cov_nx4914qqr().s[42]++;return newState;}resolvePrompt(state,player,prompt){cov_nx4914qqr().f[7]++;const resolvers=(cov_nx4914qqr().s[43]++,this.options.promptResolvers.map(resolver=>{cov_nx4914qqr().f[8]++;cov_nx4914qqr().s[44]++;return new resolver(this.options);}));cov_nx4914qqr().s[45]++;for(let i=(cov_nx4914qqr().s[46]++,0);i<resolvers.length;i++){const action=(cov_nx4914qqr().s[47]++,resolvers[i].resolvePrompt(state,player,prompt));cov_nx4914qqr().s[48]++;if(action!==undefined){cov_nx4914qqr().b[7][0]++;cov_nx4914qqr().s[49]++;return action;}else{cov_nx4914qqr().b[7][1]++;}}// Unknown prompt. Try to cancel it.
cov_nx4914qqr().s[50]++;return new game_1.ResolvePromptAction(prompt.id,null);}getStateScore(state,playerId){cov_nx4914qqr().f[9]++;cov_nx4914qqr().s[51]++;return this.stateScore.getScore(state,playerId);}evaluateAction(state,playerId,action,passTurnScore=(cov_nx4914qqr().b[8][0]++,0)){cov_nx4914qqr().f[10]++;const newState=(cov_nx4914qqr().s[52]++,this.simulateAction(state,action));const newPlayer=(cov_nx4914qqr().s[53]++,(cov_nx4914qqr().b[9][0]++,newState)&&(cov_nx4914qqr().b[9][1]++,newState.players.find(p=>{cov_nx4914qqr().f[11]++;cov_nx4914qqr().s[54]++;return p.id===playerId;})));cov_nx4914qqr().s[55]++;if((cov_nx4914qqr().b[11][0]++,newState!==undefined)&&(cov_nx4914qqr().b[11][1]++,newPlayer!==undefined)){cov_nx4914qqr().b[10][0]++;cov_nx4914qqr().s[56]++;return this.stateScore.getScore(newState,playerId)+(newState.turn>state.turn?(cov_nx4914qqr().b[12][0]++,passTurnScore):(cov_nx4914qqr().b[12][1]++,0));}else{cov_nx4914qqr().b[10][1]++;}}}cov_nx4914qqr().s[57]++;exports.SimpleTactic=SimpleTactic;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL3NpbXBsZS1ib3Qvc2ltcGxlLXRhY3RpY3Mvc2ltcGxlLXRhY3RpY3MudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9zaW1wbGUtYm90L3NpbXBsZS10YWN0aWNzL3NpbXBsZS10YWN0aWNzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHFDQUNvRjtBQUNwRix5REFBc0Q7QUFFdEQsNERBQXdEO0FBSXhELE1BQXNCLFlBQVk7SUFJaEMsWUFBc0IsT0FBeUI7UUFBekIsWUFBTyxHQUFQLE9BQU8sQ0FBa0I7UUFDN0MsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLHdCQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFJUyxhQUFhLENBQUMsTUFBYyxFQUFFLEtBQVksRUFBRSxNQUF1QjtRQUMzRSxJQUFJLE1BQU0sS0FBSyxNQUFNLENBQUMsTUFBTSxFQUFFO1lBQzVCLE9BQU8sRUFBRSxNQUFNLEVBQUUsaUJBQVUsQ0FBQyxhQUFhLEVBQUUsSUFBSSxFQUFFLGVBQVEsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDO1NBQzlFO1FBRUQsS0FBSyxJQUFJLEtBQUssR0FBRyxDQUFDLEVBQUUsS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFO1lBQ3hELElBQUksTUFBTSxLQUFLLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ2xDLE9BQU8sRUFBRSxNQUFNLEVBQUUsaUJBQVUsQ0FBQyxhQUFhLEVBQUUsSUFBSSxFQUFFLGVBQVEsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUM7YUFDMUU7U0FDRjtRQUVE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Q3pDLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztZQUNqRSxJQUFJLE1BQU0sS0FBSyxTQUFTLEVBQUU7Z0JBQ3hCLE9BQU8sTUFBTSxDQUFDO2FBQ2Y7U0FDRjtRQUVELG9DQUFvQztRQUNwQyxPQUFPLElBQUksMEJBQW1CLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNsRCxDQUFDO0lBRVMsYUFBYSxDQUFDLEtBQVksRUFBRSxRQUFnQjtRQUNwRCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRVMsY0FBYyxDQUFDLEtBQVksRUFBRSxRQUFnQixFQUFFLE1BQWMsRUFBRSxnQkFBd0IsQ0FBQztRQUNoRyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNwRCxNQUFNLFNBQVMsR0FBRyxRQUFRLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLFFBQVEsQ0FBQyxDQUFDO1FBQzVFLElBQUksUUFBUSxLQUFLLFNBQVMsSUFBSSxTQUFTLEtBQUssU0FBUyxFQUFFO1lBQ3JELE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQztrQkFDL0MsQ0FBQyxRQUFRLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDdEQ7SUFDSCxDQUFDO0NBRUY7QUE1RkQsb0NBNEZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aW9uLCBQbGF5ZXIsIFN0YXRlLCBQb2tlbW9uQ2FyZExpc3QsIENhcmRUYXJnZXQsIFBsYXllclR5cGUsXG4gIFNsb3RUeXBlLCBHYW1lRXJyb3IsIEdhbWVNZXNzYWdlLCBQcm9tcHQsIFJlc29sdmVQcm9tcHRBY3Rpb24gfSBmcm9tICcuLi8uLi9nYW1lJztcbmltcG9ydCB7IFNpbXVsYXRvciB9IGZyb20gJy4uLy4uL2dhbWUvYm90cy9zaW11bGF0b3InO1xuaW1wb3J0IHsgU2ltcGxlQm90T3B0aW9ucyB9IGZyb20gJy4uL3NpbXBsZS1ib3Qtb3B0aW9ucyc7XG5pbXBvcnQgeyBTdGF0ZVNjb3JlIH0gZnJvbSAnLi4vc3RhdGUtc2NvcmUvc3RhdGUtc2NvcmUnO1xuXG5leHBvcnQgdHlwZSBTaW1wbGVUYWN0aWNMaXN0ID0gKG5ldyAob3B0aW9uczogU2ltcGxlQm90T3B0aW9ucykgPT4gU2ltcGxlVGFjdGljKVtdO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgU2ltcGxlVGFjdGljIHtcblxuICBwcml2YXRlIHN0YXRlU2NvcmU6IFN0YXRlU2NvcmU7XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIG9wdGlvbnM6IFNpbXBsZUJvdE9wdGlvbnMpIHtcbiAgICB0aGlzLnN0YXRlU2NvcmUgPSBuZXcgU3RhdGVTY29yZSh0aGlzLm9wdGlvbnMpO1xuICB9XG5cbiAgcHVibGljIGFic3RyYWN0IHVzZVRhY3RpYyhzdGF0ZTogU3RhdGUsIHBsYXllcjogUGxheWVyKTogQWN0aW9uIHwgdW5kZWZpbmVkO1xuXG4gIHByb3RlY3RlZCBnZXRDYXJkVGFyZ2V0KHBsYXllcjogUGxheWVyLCBzdGF0ZTogU3RhdGUsIHRhcmdldDogUG9rZW1vbkNhcmRMaXN0KTogQ2FyZFRhcmdldCB7XG4gICAgaWYgKHRhcmdldCA9PT0gcGxheWVyLmFjdGl2ZSkge1xuICAgICAgcmV0dXJuIHsgcGxheWVyOiBQbGF5ZXJUeXBlLkJPVFRPTV9QTEFZRVIsIHNsb3Q6IFNsb3RUeXBlLkFDVElWRSwgaW5kZXg6IDAgfTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcGxheWVyLmJlbmNoLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgaWYgKHRhcmdldCA9PT0gcGxheWVyLmJlbmNoW2luZGV4XSkge1xuICAgICAgICByZXR1cm4geyBwbGF5ZXI6IFBsYXllclR5cGUuQk9UVE9NX1BMQVlFUiwgc2xvdDogU2xvdFR5cGUuQkVOQ0gsIGluZGV4IH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgb3Bwb25lbnQgPSBzdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwICE9PSBwbGF5ZXIpO1xuICAgIGlmIChvcHBvbmVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklOVkFMSURfR0FNRV9TVEFURSk7XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldCA9PT0gb3Bwb25lbnQuYWN0aXZlKSB7XG4gICAgICByZXR1cm4geyBwbGF5ZXI6IFBsYXllclR5cGUuVE9QX1BMQVlFUiwgc2xvdDogU2xvdFR5cGUuQUNUSVZFLCBpbmRleDogMCB9O1xuICAgIH1cblxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBvcHBvbmVudC5iZW5jaC5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGlmICh0YXJnZXQgPT09IG9wcG9uZW50LmJlbmNoW2luZGV4XSkge1xuICAgICAgICByZXR1cm4geyBwbGF5ZXI6IFBsYXllclR5cGUuVE9QX1BMQVlFUiwgc2xvdDogU2xvdFR5cGUuQkVOQ0gsIGluZGV4IH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTlZBTElEX1RBUkdFVCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgc2ltdWxhdGVBY3Rpb24oc3RhdGU6IFN0YXRlLCBhY3Rpb246IEFjdGlvbik6IFN0YXRlIHwgdW5kZWZpbmVkIHtcbiAgICBsZXQgbmV3U3RhdGUgPSBzdGF0ZTtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2ltdWxhdG9yID0gbmV3IFNpbXVsYXRvcihzdGF0ZSwgdGhpcy5vcHRpb25zLmFyYml0ZXIpO1xuICAgICAgbmV3U3RhdGUgPSBzaW11bGF0b3IuZGlzcGF0Y2goYWN0aW9uKTtcbiAgICAgIFxuICAgICAgd2hpbGUgKHNpbXVsYXRvci5zdG9yZS5zdGF0ZS5wcm9tcHRzLnNvbWUocCA9PiBwLnJlc3VsdCA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICBuZXdTdGF0ZSA9IHNpbXVsYXRvci5zdG9yZS5zdGF0ZTtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gbmV3U3RhdGUucHJvbXB0cy5maW5kKHAgPT4gcC5yZXN1bHQgPT09IHVuZGVmaW5lZCk7XG4gICAgICAgIGlmIChwcm9tcHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBsYXllciA9IG5ld1N0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHByb21wdC5wbGF5ZXJJZCk7XG4gICAgICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc29sdmVBY3Rpb24gPSB0aGlzLnJlc29sdmVQcm9tcHQobmV3U3RhdGUsIHBsYXllciwgcHJvbXB0KTtcbiAgICAgICAgbmV3U3RhdGUgPSBzaW11bGF0b3IuZGlzcGF0Y2gocmVzb2x2ZUFjdGlvbik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ld1N0YXRlO1xuICB9XG5cbiAgcHJpdmF0ZSByZXNvbHZlUHJvbXB0KHN0YXRlOiBTdGF0ZSwgcGxheWVyOiBQbGF5ZXIsIHByb21wdDogUHJvbXB0PGFueT4pOiBBY3Rpb24ge1xuICAgIGNvbnN0IHJlc29sdmVycyA9IHRoaXMub3B0aW9ucy5wcm9tcHRSZXNvbHZlcnMubWFwKHJlc29sdmVyID0+IG5ldyByZXNvbHZlcih0aGlzLm9wdGlvbnMpKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzb2x2ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBhY3Rpb24gPSByZXNvbHZlcnNbaV0ucmVzb2x2ZVByb21wdChzdGF0ZSwgcGxheWVyLCBwcm9tcHQpO1xuICAgICAgaWYgKGFjdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBhY3Rpb247XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVW5rbm93biBwcm9tcHQuIFRyeSB0byBjYW5jZWwgaXQuXG4gICAgcmV0dXJuIG5ldyBSZXNvbHZlUHJvbXB0QWN0aW9uKHByb21wdC5pZCwgbnVsbCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0U3RhdGVTY29yZShzdGF0ZTogU3RhdGUsIHBsYXllcklkOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnN0YXRlU2NvcmUuZ2V0U2NvcmUoc3RhdGUsIHBsYXllcklkKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBldmFsdWF0ZUFjdGlvbihzdGF0ZTogU3RhdGUsIHBsYXllcklkOiBudW1iZXIsIGFjdGlvbjogQWN0aW9uLCBwYXNzVHVyblNjb3JlOiBudW1iZXIgPSAwKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBuZXdTdGF0ZSA9IHRoaXMuc2ltdWxhdGVBY3Rpb24oc3RhdGUsIGFjdGlvbik7XG4gICAgY29uc3QgbmV3UGxheWVyID0gbmV3U3RhdGUgJiYgbmV3U3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gcGxheWVySWQpO1xuICAgIGlmIChuZXdTdGF0ZSAhPT0gdW5kZWZpbmVkICYmIG5ld1BsYXllciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdGF0ZVNjb3JlLmdldFNjb3JlKG5ld1N0YXRlLCBwbGF5ZXJJZClcbiAgICAgICAgKyAobmV3U3RhdGUudHVybiA+IHN0YXRlLnR1cm4gPyBwYXNzVHVyblNjb3JlIDogMCk7XG4gICAgfVxuICB9XG5cbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9zaW1wbGUtYm90L3NpbXBsZS10YWN0aWNzL3NpbXBsZS10YWN0aWNzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJnc2ZBdUJJOzROQXZCSixLQUFBLENBQUEsTUFBQSx5QkFBQSxPQUFBLENBQUEsWUFBQSxDQUFBLENBQUEsQ0FFQSxLQUFBLENBQUEsV0FBQSx5QkFBQSxPQUFBLENBQUEsMkJBQUEsQ0FBQSxDQUFBLENBRUEsS0FBQSxDQUFBLGFBQUEseUJBQUEsT0FBQSxDQUFBLDRCQUFBLENBQUEsQ0FBQSxDQUlBLEtBQXNCLENBQUEsWUFBWSxDQUloQyxXQUFBLENBQXNCLE9BQXRCLENBQStDLCtDQUF6QixLQUFBLE9BQUEsQ0FBQSxPQUFBLENBQXlCLHVCQUM3QyxLQUFLLFVBQUwsQ0FBa0IsR0FBSSxDQUFBLGFBQUEsQ0FBQSxVQUFKLENBQWUsS0FBSyxPQUFwQixDQUFsQixDQUNELENBSVMsYUFBYSxDQUFDLE1BQUQsQ0FBaUIsS0FBakIsQ0FBK0IsTUFBL0IsQ0FBc0QsK0NBQzNFLEdBQUksTUFBTSxHQUFLLE1BQU0sQ0FBQyxNQUF0QixDQUE4QixrREFDNUIsTUFBTyxDQUFFLE1BQU0sQ0FBRSxNQUFBLENBQUEsVUFBQSxDQUFXLGFBQXJCLENBQW9DLElBQUksQ0FBRSxNQUFBLENBQUEsUUFBQSxDQUFTLE1BQW5ELENBQTJELEtBQUssQ0FBRSxDQUFsRSxDQUFQLENBQ0QsQ0FGRCxnQ0FEMkUsdUJBSzNFLElBQUssR0FBSSxDQUFBLEtBQUssMEJBQUcsQ0FBSCxDQUFkLENBQW9CLEtBQUssQ0FBRyxNQUFNLENBQUMsS0FBUCxDQUFhLE1BQXpDLENBQWlELEtBQUssRUFBdEQsQ0FBMEQseUJBQ3hELEdBQUksTUFBTSxHQUFLLE1BQU0sQ0FBQyxLQUFQLENBQWEsS0FBYixDQUFmLENBQW9DLG1EQUNsQyxNQUFPLENBQUUsTUFB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S0FBTSxDQUFBLFFBQVEsMEJBQUcsS0FBSyxjQUFMLENBQW9CLEtBQXBCLENBQTJCLE1BQTNCLENBQUgsQ0FBZCxDQUNBLEtBQU0sQ0FBQSxTQUFTLDBCQUFHLDJCQUFBLFFBQVEsOEJBQUksUUFBUSxDQUFDLE9BQVQsQ0FBaUIsSUFBakIsQ0FBc0IsQ0FBQyxFQUFJLHVEQUFBLENBQUEsQ0FBQyxDQUFDLEVBQUYsR0FBUyxRQUFULENBQWlCLENBQTVDLENBQUosQ0FBWCxDQUFmLENBRmdHLHdCQUdoRyxHQUFJLDRCQUFBLFFBQVEsR0FBSyxTQUFiLCtCQUEwQixTQUFTLEdBQUssU0FBeEMsQ0FBSixDQUF1RCxvREFDckQsTUFBTyxNQUFLLFVBQUwsQ0FBZ0IsUUFBaEIsQ0FBeUIsUUFBekIsQ0FBbUMsUUFBbkMsR0FDRixRQUFRLENBQUMsSUFBVCxDQUFnQixLQUFLLENBQUMsSUFBdEIsNkJBQTZCLGFBQTdCLDhCQUE2QyxDQUE3QyxDQURFLENBQVAsQ0FFRCxDQUhELGlDQUlELENBMUYrQixDLHdCQUFsQyxPQUFBLENBQUEsWUFBQSxDQUFBLFlBQUEsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFjdGlvbiwgUGxheWVyLCBTdGF0ZSwgUG9rZW1vbkNhcmRMaXN0LCBDYXJkVGFyZ2V0LCBQbGF5ZXJUeXBlLFxuICBTbG90VHlwZSwgR2FtZUVycm9yLCBHYW1lTWVzc2FnZSwgUHJvbXB0LCBSZXNvbHZlUHJvbXB0QWN0aW9uIH0gZnJvbSAnLi4vLi4vZ2FtZSc7XG5pbXBvcnQgeyBTaW11bGF0b3IgfSBmcm9tICcuLi8uLi9nYW1lL2JvdHMvc2ltdWxhdG9yJztcbmltcG9ydCB7IFNpbXBsZUJvdE9wdGlvbnMgfSBmcm9tICcuLi9zaW1wbGUtYm90LW9wdGlvbnMnO1xuaW1wb3J0IHsgU3RhdGVTY29yZSB9IGZyb20gJy4uL3N0YXRlLXNjb3JlL3N0YXRlLXNjb3JlJztcblxuZXhwb3J0IHR5cGUgU2ltcGxlVGFjdGljTGlzdCA9IChuZXcgKG9wdGlvbnM6IFNpbXBsZUJvdE9wdGlvbnMpID0+IFNpbXBsZVRhY3RpYylbXTtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFNpbXBsZVRhY3RpYyB7XG5cbiAgcHJpdmF0ZSBzdGF0ZVNjb3JlOiBTdGF0ZVNjb3JlO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBvcHRpb25zOiBTaW1wbGVCb3RPcHRpb25zKSB7XG4gICAgdGhpcy5zdGF0ZVNjb3JlID0gbmV3IFN0YXRlU2NvcmUodGhpcy5vcHRpb25zKTtcbiAgfVxuXG4gIHB1YmxpYyBhYnN0cmFjdCB1c2VUYWN0aWMoc3RhdGU6IFN0YXRlLCBwbGF5ZXI6IFBsYXllcik6IEFjdGlvbiB8IHVuZGVmaW5lZDtcblxuICBwcm90ZWN0ZWQgZ2V0Q2FyZFRhcmdldChwbGF5ZXI6IFBsYXllciwgc3RhdGU6IFN0YXRlLCB0YXJnZXQ6IFBva2Vtb25DYXJkTGlzdCk6IENhcmRUYXJnZXQge1xuICAgIGlmICh0YXJnZXQgPT09IHBsYXllci5hY3RpdmUpIHtcbiAgICAgIHJldHVybiB7IHBsYXllcjogUGxheWVyVHlwZS5CT1RUT01fUExBWUVSLCBzbG90OiBTbG90VHlwZS5BQ1RJVkUsIGluZGV4OiAwIH07XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHBsYXllci5iZW5jaC5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGlmICh0YXJnZXQgPT09IHBsYXllci5iZW5jaFtpbmRleF0pIHtcbiAgICAgICAgcmV0dXJuIHsgcGxheWVyOiBQbGF5ZXJUeXBlLkJPVFRPTV9QTEFZRVIsIHNsb3Q6IFNsb3RUeXBlLkJFTkNILCBpbmRleCB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG9wcG9uZW50ID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcCAhPT0gcGxheWVyKTtcbiAgICBpZiAob3Bwb25lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTlZBTElEX0dBTUVfU1RBVEUpO1xuICAgIH1cblxuICAgIGlmICh0YXJnZXQgPT09IG9wcG9uZW50LmFjdGl2ZSkge1xuICAgICAgcmV0dXJuIHsgcGxheWVyOiBQbGF5ZXJUeXBlLlRPUF9QTEFZRVIsIHNsb3Q6IFNsb3RUeXBlLkFDVElWRSwgaW5kZXg6IDAgfTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgb3Bwb25lbnQuYmVuY2gubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBpZiAodGFyZ2V0ID09PSBvcHBvbmVudC5iZW5jaFtpbmRleF0pIHtcbiAgICAgICAgcmV0dXJuIHsgcGxheWVyOiBQbGF5ZXJUeXBlLlRPUF9QTEFZRVIsIHNsb3Q6IFNsb3RUeXBlLkJFTkNILCBpbmRleCB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSU5WQUxJRF9UQVJHRVQpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHNpbXVsYXRlQWN0aW9uKHN0YXRlOiBTdGF0ZSwgYWN0aW9uOiBBY3Rpb24pOiBTdGF0ZSB8IHVuZGVmaW5lZCB7XG4gICAgbGV0IG5ld1N0YXRlID0gc3RhdGU7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNpbXVsYXRvciA9IG5ldyBTaW11bGF0b3Ioc3RhdGUsIHRoaXMub3B0aW9ucy5hcmJpdGVyKTtcbiAgICAgIG5ld1N0YXRlID0gc2ltdWxhdG9yLmRpc3BhdGNoKGFjdGlvbik7XG4gICAgICBcbiAgICAgIHdoaWxlIChzaW11bGF0b3Iuc3RvcmUuc3RhdGUucHJvbXB0cy5zb21lKHAgPT4gcC5yZXN1bHQgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgbmV3U3RhdGUgPSBzaW11bGF0b3Iuc3RvcmUuc3RhdGU7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IG5ld1N0YXRlLnByb21wdHMuZmluZChwID0+IHAucmVzdWx0ID09PSB1bmRlZmluZWQpO1xuICAgICAgICBpZiAocHJvbXB0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwbGF5ZXIgPSBuZXdTdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBwcm9tcHQucGxheWVySWQpO1xuICAgICAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXNvbHZlQWN0aW9uID0gdGhpcy5yZXNvbHZlUHJvbXB0KG5ld1N0YXRlLCBwbGF5ZXIsIHByb21wdCk7XG4gICAgICAgIG5ld1N0YXRlID0gc2ltdWxhdG9yLmRpc3BhdGNoKHJlc29sdmVBY3Rpb24pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiBuZXdTdGF0ZTtcbiAgfVxuXG4gIHByaXZhdGUgcmVzb2x2ZVByb21wdChzdGF0ZTogU3RhdGUsIHBsYXllcjogUGxheWVyLCBwcm9tcHQ6IFByb21wdDxhbnk+KTogQWN0aW9uIHtcbiAgICBjb25zdCByZXNvbHZlcnMgPSB0aGlzLm9wdGlvbnMucHJvbXB0UmVzb2x2ZXJzLm1hcChyZXNvbHZlciA9PiBuZXcgcmVzb2x2ZXIodGhpcy5vcHRpb25zKSk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc29sdmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgYWN0aW9uID0gcmVzb2x2ZXJzW2ldLnJlc29sdmVQcm9tcHQoc3RhdGUsIHBsYXllciwgcHJvbXB0KTtcbiAgICAgIGlmIChhY3Rpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gYWN0aW9uO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVua25vd24gcHJvbXB0LiBUcnkgdG8gY2FuY2VsIGl0LlxuICAgIHJldHVybiBuZXcgUmVzb2x2ZVByb21wdEFjdGlvbihwcm9tcHQuaWQsIG51bGwpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldFN0YXRlU2NvcmUoc3RhdGU6IFN0YXRlLCBwbGF5ZXJJZDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZVNjb3JlLmdldFNjb3JlKHN0YXRlLCBwbGF5ZXJJZCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZXZhbHVhdGVBY3Rpb24oc3RhdGU6IFN0YXRlLCBwbGF5ZXJJZDogbnVtYmVyLCBhY3Rpb246IEFjdGlvbiwgcGFzc1R1cm5TY29yZTogbnVtYmVyID0gMCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgbmV3U3RhdGUgPSB0aGlzLnNpbXVsYXRlQWN0aW9uKHN0YXRlLCBhY3Rpb24pO1xuICAgIGNvbnN0IG5ld1BsYXllciA9IG5ld1N0YXRlICYmIG5ld1N0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHBsYXllcklkKTtcbiAgICBpZiAobmV3U3RhdGUgIT09IHVuZGVmaW5lZCAmJiBuZXdQbGF5ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHRoaXMuc3RhdGVTY29yZS5nZXRTY29yZShuZXdTdGF0ZSwgcGxheWVySWQpXG4gICAgICAgICsgKG5ld1N0YXRlLnR1cm4gPiBzdGF0ZS50dXJuID8gcGFzc1R1cm5TY29yZSA6IDApO1xuICAgIH1cbiAgfVxuXG59XG4iXX0=