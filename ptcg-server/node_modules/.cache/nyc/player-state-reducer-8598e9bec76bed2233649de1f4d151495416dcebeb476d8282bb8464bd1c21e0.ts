"use strict";function cov_17m1eph2b3(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/reducers/player-state-reducer.ts";var hash="c432726c15f3cb2940b72140552eaea87cc3a443";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/reducers/player-state-reducer.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:36}},"2":{start:{line:4,column:31},end:{line:4,column:73}},"3":{start:{line:5,column:21},end:{line:5,column:48}},"4":{start:{line:6,column:23},end:{line:6,column:52}},"5":{start:{line:7,column:26},end:{line:7,column:63}},"6":{start:{line:9,column:4},end:{line:18,column:5}},"7":{start:{line:10,column:23},end:{line:10,column:66}},"8":{start:{line:10,column:47},end:{line:10,column:65}},"9":{start:{line:11,column:8},end:{line:13,column:9}},"10":{start:{line:12,column:12},end:{line:12,column:88}},"11":{start:{line:14,column:21},end:{line:14,column:46}},"12":{start:{line:15,column:8},end:{line:15,column:60}},"13":{start:{line:16,column:8},end:{line:16,column:39}},"14":{start:{line:17,column:8},end:{line:17,column:21}},"15":{start:{line:19,column:4},end:{line:26,column:5}},"16":{start:{line:20,column:23},end:{line:20,column:66}},"17":{start:{line:20,column:47},end:{line:20,column:65}},"18":{start:{line:21,column:8},end:{line:23,column:9}},"19":{start:{line:22,column:12},end:{line:22,column:88}},"20":{start:{line:24,column:8},end:{line:24,column:45}},"21":{start:{line:25,column:8},end:{line:25,column:21}},"22":{start:{line:27,column:4},end:{line:37,column:5}},"23":{start:{line:28,column:23},end:{line:28,column:66}},"24":{start:{line:28,column:47},end:{line:28,column:65}},"25":{start:{line:29,column:8},end:{line:31,column:9}},"26":{start:{line:30,column:12},end:{line:30,column:88}},"27":{start:{line:32,column:8},end:{line:32,column:46}},"28":{start:{line:33,column:8},end:{line:35,column:9}},"29":{start:{line:34,column:12},end:{line:34,column:79}},"30":{start:{line:36,column:8},end:{line:36,column:21}},"31":{start:{line:38,column:4},end:{line:38,column:17}},"32":{start:{line:40,column:0},end:{line:40,column:48}}},fnMap:{"0":{name:"playerStateReducer",decl:{start:{line:8,column:9},end:{line:8,column:27}},loc:{start:{line:8,column:50},end:{line:39,column:1}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:10,column:42},end:{line:10,column:43}},loc:{start:{line:10,column:47},end:{line:10,column:65}},line:10},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:42},end:{line:20,column:43}},loc:{start:{line:20,column:47},end:{line:20,column:65}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:28,column:42},end:{line:28,column:43}},loc:{start:{line:28,column:47},end:{line:28,column:65}},line:28}},branchMap:{"0":{loc:{start:{line:9,column:4},end:{line:18,column:5}},type:"if",locations:[{start:{line:9,column:4},end:{line:18,column:5}},{start:{line:9,column:4},end:{line:18,column:5}}],line:9},"1":{loc:{start:{line:11,column:8},end:{line:13,column:9}},type:"if",locations:[{start:{line:11,column:8},end:{line:13,column:9}},{start:{line:11,column:8},end:{line:13,column:9}}],line:11},"2":{loc:{start:{line:11,column:12},end:{line:11,column:75}},type:"binary-expr",locations:[{start:{line:11,column:12},end:{line:11,column:32}},{start:{line:11,column:36},end:{line:11,column:75}}],line:11},"3":{loc:{start:{line:19,column:4},end:{line:26,column:5}},type:"if",locations:[{start:{line:19,column:4},end:{line:26,column:5}},{start:{line:19,column:4},end:{line:26,column:5}}],line:19},"4":{loc:{start:{line:21,column:8},end:{line:23,column:9}},type:"if",locations:[{start:{line:21,column:8},end:{line:23,column:9}},{start:{line:21,column:8},end:{line:23,column:9}}],line:21},"5":{loc:{start:{line:21,column:12},end:{line:21,column:84}},type:"binary-expr",locations:[{start:{line:21,column:12},end:{line:21,column:32}},{start:{line:21,column:36},end:{line:21,column:84}}],line:21},"6":{loc:{start:{line:27,column:4},end:{line:37,column:5}},type:"if",locations:[{start:{line:27,column:4},end:{line:37,column:5}},{start:{line:27,column:4},end:{line:37,column:5}}],line:27},"7":{loc:{start:{line:29,column:8},end:{line:31,column:9}},type:"if",locations:[{start:{line:29,column:8},end:{line:31,column:9}},{start:{line:29,column:8},end:{line:31,column:9}}],line:29},"8":{loc:{start:{line:33,column:8},end:{line:35,column:9}},type:"if",locations:[{start:{line:33,column:8},end:{line:35,column:9}},{start:{line:33,column:8},end:{line:35,column:9}}],line:33}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/reducers/player-state-reducer.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/reducers/player-state-reducer.ts"],names:[],mappings:";;;AACA,0EAAqE;AACrE,iDAA6C;AAC7C,qDAAiD;AACjD,gEAAmF;AAKnF,SAAgB,kBAAkB,CAAC,KAAgB,EAAE,KAAY,EAAE,MAAc;IAE/E,IAAI,MAAM,YAAY,oCAAkB,EAAE;QACxC,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC;QAC3D,IAAI,MAAM,KAAK,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE;YACnE,MAAM,IAAI,sBAAS,CAAC,0BAAW,CAAC,cAAc,CAAC,CAAC;SACjD;QAED,MAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACvC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QACpD,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;QAE/B,OAAO,KAAK,CAAC;KACd;IAED,IAAI,MAAM,YAAY,mCAAiB,EAAE;QAEvC,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC;QAC3D,IAAI,MAAM,KAAK,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,MAAM,CAAC,KAAK,CAAC,MAAM,EAAE;YAC5E,MAAM,IAAI,sBAAS,CAAC,0BAAW,CAAC,cAAc,CAAC,CAAC;SACjD;QAED,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAErC,OAAO,KAAK,CAAC;KACd;IAED,IAAI,MAAM,YAAY,yCAAkB,EAAE;QAExC,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC;QAC3D,IAAI,MAAM,KAAK,SAAS,EAAE;YACxB,MAAM,IAAI,sBAAS,CAAC,0BAAW,CAAC,cAAc,CAAC,CAAC;SACjD;QAED,MAAM,CAAC,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;QAEtC,IAAI,MAAM,CAAC,GAAG,EAAE;YACd,KAAK,CAAC,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;SACpE;QAED,OAAO,KAAK,CAAC;KACd;IAED,OAAO,KAAK,CAAC;AACf,CAAC;AA5CD,gDA4CC",sourcesContent:["import { Action } from '../actions/action';\nimport { ChangeAvatarAction } from '../actions/change-avatar-action';\nimport { GameError } from '../../game-error';\nimport { GameMessage } from '../../game-message';\nimport { ReorderBenchAction, ReorderHandAction } from '../actions/reorder-actions';\nimport { State } from '../state/state';\nimport { StoreLike } from '../store-like';\n\n\nexport function playerStateReducer(store: StoreLike, state: State, action: Action): State {\n\n  if (action instanceof ReorderBenchAction) {\n    const player = state.players.find(p => p.id === action.id);\n    if (player === undefined || player.bench[action.from] === undefined) {\n      throw new GameError(GameMessage.ILLEGAL_ACTION);\n    }\n\n    const temp = player.bench[action.from];\n    player.bench[action.from] = player.bench[action.to];\n    player.bench[action.to] = temp;\n\n    return state;\n  }\n\n  if (action instanceof ReorderHandAction) {\n    \n    const player = state.players.find(p => p.id === action.id);\n    if (player === undefined || player.hand.cards.length !== action.order.length) {\n      throw new GameError(GameMessage.ILLEGAL_ACTION);\n    }\n\n    player.hand.applyOrder(action.order);\n\n    return state;\n  }\n\n  if (action instanceof ChangeAvatarAction) {\n\n    const player = state.players.find(p => p.id === action.id);\n    if (player === undefined) {\n      throw new GameError(GameMessage.ILLEGAL_ACTION);\n    }\n\n    player.avatarName = action.avatarName;\n\n    if (action.log) {\n      store.log(state, action.log.message, action.log.params, player.id);\n    }\n\n    return state;\n  }\n\n  return state;\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c432726c15f3cb2940b72140552eaea87cc3a443"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_17m1eph2b3=function(){return actualCoverage;};}return actualCoverage;}cov_17m1eph2b3();cov_17m1eph2b3().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_17m1eph2b3().s[1]++;exports.playerStateReducer=void 0;const change_avatar_action_1=(cov_17m1eph2b3().s[2]++,require("../actions/change-avatar-action"));const game_error_1=(cov_17m1eph2b3().s[3]++,require("../../game-error"));const game_message_1=(cov_17m1eph2b3().s[4]++,require("../../game-message"));const reorder_actions_1=(cov_17m1eph2b3().s[5]++,require("../actions/reorder-actions"));function playerStateReducer(store,state,action){cov_17m1eph2b3().f[0]++;cov_17m1eph2b3().s[6]++;if(action instanceof reorder_actions_1.ReorderBenchAction){cov_17m1eph2b3().b[0][0]++;const player=(cov_17m1eph2b3().s[7]++,state.players.find(p=>{cov_17m1eph2b3().f[1]++;cov_17m1eph2b3().s[8]++;return p.id===action.id;}));cov_17m1eph2b3().s[9]++;if((cov_17m1eph2b3().b[2][0]++,player===undefined)||(cov_17m1eph2b3().b[2][1]++,player.bench[action.from]===undefined)){cov_17m1eph2b3().b[1][0]++;cov_17m1eph2b3().s[10]++;throw new game_error_1.GameError(game_message_1.GameMessage.ILLEGAL_ACTION);}else{cov_17m1eph2b3().b[1][1]++;}const temp=(cov_17m1eph2b3().s[11]++,player.bench[action.from]);cov_17m1eph2b3().s[12]++;player.bench[action.from]=player.bench[action.to];cov_17m1eph2b3().s[13]++;player.bench[action.to]=temp;cov_17m1eph2b3().s[14]++;return state;}else{cov_17m1eph2b3().b[0][1]++;}cov_17m1eph2b3().s[15]++;if(action instanceof reorder_actions_1.ReorderHandAction){cov_17m1eph2b3().b[3][0]++;const player=(cov_17m1eph2b3().s[16]++,state.players.find(p=>{cov_17m1eph2b3().f[2]++;cov_17m1eph2b3().s[17]++;return p.id===action.id;}));cov_17m1eph2b3().s[18]++;if((cov_17m1eph2b3().b[5][0]++,player===undefined)||(cov_17m1eph2b3().b[5][1]++,player.hand.cards.length!==action.order.length)){cov_17m1eph2b3().b[4][0]++;cov_17m1eph2b3().s[19]++;throw new game_error_1.GameError(game_message_1.GameMessage.ILLEGAL_ACTION);}else{cov_17m1eph2b3().b[4][1]++;}cov_17m1eph2b3().s[20]++;player.hand.applyOrder(action.order);cov_17m1eph2b3().s[21]++;return state;}else{cov_17m1eph2b3().b[3][1]++;}cov_17m1eph2b3().s[22]++;if(action instanceof change_avatar_action_1.ChangeAvatarAction){cov_17m1eph2b3().b[6][0]++;const player=(cov_17m1eph2b3().s[23]++,state.players.find(p=>{cov_17m1eph2b3().f[3]++;cov_17m1eph2b3().s[24]++;return p.id===action.id;}));cov_17m1eph2b3().s[25]++;if(player===undefined){cov_17m1eph2b3().b[7][0]++;cov_17m1eph2b3().s[26]++;throw new game_error_1.GameError(game_message_1.GameMessage.ILLEGAL_ACTION);}else{cov_17m1eph2b3().b[7][1]++;}cov_17m1eph2b3().s[27]++;player.avatarName=action.avatarName;cov_17m1eph2b3().s[28]++;if(action.log){cov_17m1eph2b3().b[8][0]++;cov_17m1eph2b3().s[29]++;store.log(state,action.log.message,action.log.params,player.id);}else{cov_17m1eph2b3().b[8][1]++;}cov_17m1eph2b3().s[30]++;return state;}else{cov_17m1eph2b3().b[6][1]++;}cov_17m1eph2b3().s[31]++;return state;}cov_17m1eph2b3().s[32]++;exports.playerStateReducer=playerStateReducer;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcmVkdWNlcnMvcGxheWVyLXN0YXRlLXJlZHVjZXIudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3JlZHVjZXJzL3BsYXllci1zdGF0ZS1yZWR1Y2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLDBFQUFxRTtBQUNyRSxpREFBNkM7QUFDN0MscURBQWlEO0FBQ2pELGdFQUFtRjtBQUtuRixTQUFnQixrQkFBa0IsQ0FBQyxLQUFnQixFQUFFLEtBQVksRUFBRSxNQUFjO0lBRS9FLElBQUksTUFBTSxZQUFZLG9DQUFrQixFQUFFO1FBQ3hDLE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDM0QsSUFBSSxNQUFNLEtBQUssU0FBUyxJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLFNBQVMsRUFBRTtZQUNuRSxNQUFNLElBQUksc0JBQVMsQ0FBQywwQkFBVyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1NBQ2pEO1FBRUQsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDcEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBRS9CLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFFRCxJQUFJLE1BQU0sWUFBWSxtQ0FBaUIsRUFBRTtRQUV2QyxNQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzNELElBQUksTUFBTSxLQUFLLFNBQVMsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEtBQUssTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUU7WUFDNUUsTUFBTSxJQUFJLHNCQUFTLENBQUMsMEJBQVcsQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUNqRDtRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUVyQyxPQUFPLEtBQUssQ0FBQztLQUNkO0lBRUQsSUFBSSxNQUFNLFlBQVkseUNBQWtCLEVBQUU7UUFFeEMsTUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMzRCxJQUFJLE1BQU0sS0FBSyxTQUFTLEVBQUU7WUFDeEIsTUFBTSxJQUFJLHNCQUFTLENBQUMsMEJBQVcsQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUNqRDtRQUVELE1BQU0sQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQztRQUV0QyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEVBQUU7WUFDZCxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDcEU7UUFFRCxPQUFPLEtBQUssQ0FBQztLQUNkO0lBRUQsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBNUNELGdEQTRDQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFjdGlvbiB9IGZyb20gJy4uL2FjdGlvbnMvYWN0aW9uJztcbmltcG9ydCB7IENoYW5nZUF2YXRhckFjdGlvbiB9IGZyb20gJy4uL2FjdGlvbnMvY2hhbmdlLWF2YXRhci1hY3Rpb24nO1xuaW1wb3J0IHsgR2FtZUVycm9yIH0gZnJvbSAnLi4vLi4vZ2FtZS1lcnJvcic7XG5pbXBvcnQgeyBHYW1lTWVzc2FnZSB9IGZyb20gJy4uLy4uL2dhbWUtbWVzc2FnZSc7XG5pbXBvcnQgeyBSZW9yZGVyQmVuY2hBY3Rpb24sIFJlb3JkZXJIYW5kQWN0aW9uIH0gZnJvbSAnLi4vYWN0aW9ucy9yZW9yZGVyLWFjdGlvbnMnO1xuaW1wb3J0IHsgU3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9zdGF0ZSc7XG5pbXBvcnQgeyBTdG9yZUxpa2UgfSBmcm9tICcuLi9zdG9yZS1saWtlJztcblxuXG5leHBvcnQgZnVuY3Rpb24gcGxheWVyU3RhdGVSZWR1Y2VyKHN0b3JlOiBTdG9yZUxpa2UsIHN0YXRlOiBTdGF0ZSwgYWN0aW9uOiBBY3Rpb24pOiBTdGF0ZSB7XG5cbiAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIFJlb3JkZXJCZW5jaEFjdGlvbikge1xuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IGFjdGlvbi5pZCk7XG4gICAgaWYgKHBsYXllciA9PT0gdW5kZWZpbmVkIHx8IHBsYXllci5iZW5jaFthY3Rpb24uZnJvbV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTExFR0FMX0FDVElPTik7XG4gICAgfVxuXG4gICAgY29uc3QgdGVtcCA9IHBsYXllci5iZW5jaFthY3Rpb24uZnJvbV07XG4gICAgcGxheWVyLmJlbmNoW2FjdGlvbi5mcm9tXSA9IHBsYXllci5iZW5jaFthY3Rpb24udG9dO1xuICAgIHBsYXllci5iZW5jaFthY3Rpb24udG9dID0gdGVtcDtcblxuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIGlmIChhY3Rpb24gaW5zdGFuY2VvZiBSZW9yZGVySGFuZEFjdGlvbikge1xuICAgIFxuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IGFjdGlvbi5pZCk7XG4gICAgaWYgKHBsYXllciA9PT0gdW5kZWZpbmVkIHx8IHBsYXllci5oYW5kLmNhcmRzLmxlbmd0aCAhPT0gYWN0aW9uLm9yZGVyLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTExFR0FMX0FDVElPTik7XG4gICAgfVxuXG4gICAgcGxheWVyLmhhbmQuYXBwbHlPcmRlcihhY3Rpb24ub3JkZXIpO1xuXG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIENoYW5nZUF2YXRhckFjdGlvbikge1xuXG4gICAgY29uc3QgcGxheWVyID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gYWN0aW9uLmlkKTtcbiAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSUxMRUdBTF9BQ1RJT04pO1xuICAgIH1cblxuICAgIHBsYXllci5hdmF0YXJOYW1lID0gYWN0aW9uLmF2YXRhck5hbWU7XG5cbiAgICBpZiAoYWN0aW9uLmxvZykge1xuICAgICAgc3RvcmUubG9nKHN0YXRlLCBhY3Rpb24ubG9nLm1lc3NhZ2UsIGFjdGlvbi5sb2cucGFyYW1zLCBwbGF5ZXIuaWQpO1xuICAgIH1cblxuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHJldHVybiBzdGF0ZTtcbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3JlZHVjZXJzL3BsYXllci1zdGF0ZS1yZWR1Y2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIyZ1JBbUJJO3NPQWxCSixLQUFBLENBQUEsc0JBQUEsMEJBQUEsT0FBQSxDQUFBLGlDQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxZQUFBLDBCQUFBLE9BQUEsQ0FBQSxrQkFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsY0FBQSwwQkFBQSxPQUFBLENBQUEsb0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGlCQUFBLDBCQUFBLE9BQUEsQ0FBQSw0QkFBQSxDQUFBLENBQUEsQ0FLQSxRQUFnQixDQUFBLGtCQUFoQixDQUFtQyxLQUFuQyxDQUFxRCxLQUFyRCxDQUFtRSxNQUFuRSxDQUFpRixpREFFL0UsR0FBSSxNQUFNLFdBQVksQ0FBQSxpQkFBQSxDQUFBLGtCQUF0QixDQUEwQyw0QkFDeEMsS0FBTSxDQUFBLE1BQU0sMEJBQUcsS0FBSyxDQUFDLE9BQU4sQ0FBYyxJQUFkLENBQW1CLENBQUMsRUFBSSx1REFBQSxDQUFBLENBQUMsQ0FBQyxFQUFGLEdBQVMsTUFBTSxDQUFDLEVBQWhCLENBQWtCLENBQTFDLENBQUgsQ0FBWixDQUR3Qyx3QkFFeEMsR0FBSSw0QkFBQSxNQUFNLEdBQUssU0FBWCwrQkFBd0IsTUFBTSxDQUFDLEtBQVAsQ0FBYSxNQUFNLENBQUMsSUFBcEIsSUFBOEIsU0FBdEQsQ0FBSixDQUFxRSxxREFDbkUsS0FBTSxJQUFJLENBQUEsWUFBQSxDQUFBLFNBQUosQ0FBYyxjQUFBLENBQUEsV0FBQSxDQUFZLGNBQTFCLENBQU4sQ0FDRCxDQUZELGlDQUlBLEtBQU0sQ0FBQSxJQUFJLDJCQUFHLE1BQU0sQ0FBQyxLQUFQLENBQWEsTUFBTSxDQUFDLElBQXBCLENBQUgsQ0FBVixDQU53Qyx5QkFPeEMsTUFBTSxDQUFDLEtBQVAsQ0FBYSxNQUFNLENBQUMsSUFBcEIsRUFBNEIsTUFBTSxDQUFDLEtBQVAsQ0FBYSxNQUFNLENBQUMsRUFBcEIsQ0FBNUIsQ0FQd0MseUJBUXhDLE1BQU0sQ0FBQyxLQUFQLENBQWEsTUFBTSxDQUFDLEVBQXBCLEVBQTBCLElBQTFCLENBUndDLHlCQVV4QyxNQUFPLENBQUEsS0FBUCxDQUNELENBWEQsaUNBRitFLHlCQWUvRSxHQUFJLE1BQU0sV0FBWSxDQUFBLGlCQUFBLENBQUEsaUJBQXRCLENBQXlDLDRCQUV2QyxLQUFNLENBQUEsTUFBTSwyQkFBRyxLQUFLLENBQUMsT0FBTixDQUFjLElBQWQsQ0FBbUIsQ0FBQyxFQUFJLHdEQUFBLENBQUEsQ0FBQyxDQUFDLEVBQUYsR0FBUyxNQUFNLENBQUMsRUFBaEIsQ0FBa0IsQ0FBMUMsQ0FBSCxDQUFaLENBRnVDLHlCQUd2QyxHQUFJLDRCQUFBLE1BQU0sR0FBSyxTQUFYLCtCQUF3QixNQUFNLENBQUMsSUFBUCxDQUFZLEtBQVosQ0FBa0IsTUFBbEIsR0FBNkIsTUFBTSxDQUFDLEtBQVAsQ0FBYSxNQUFsRSxDQUFKLENBQThFLHFEQUM1RSxLQUFNLElBQUksQ0FBQSxZQUFBLENBQUEsU0FBSixDQUFjLGNBQUEsQ0FBQSxXQUFBLENBQVksY0FBMUIsQ0FBTixDQUNELENBRkQsaUNBSHVDLHlCQU92QyxNQUFNLENBQUMsSUFBUCxDQUFZLFVBQVosQ0FBdUIsTUFBTSxDQUFDLEtBQTlCLEVBUHVDLHlCQVN2QyxNQUFPLENBQUEsS0FBUCxDQUNELENBVkQsaUNBZitFLHlCQTJCL0UsR0FBSSxNQUFNLFdBQVksQ0FBQSxzQkFBQSxDQUFBLGtCQUF0QixDQUEwQyw0QkFFeEMsS0FBTSxDQUFBLE1BQU0sMkJBQUcsS0FBSyxDQUFDLE9BQU4sQ0FBYyxJQUFkLENBQW1CLENBQUMsRUFBSSx3REFBQSxDQUFBLENBQUMsQ0FBQyxFQUFGLEdBQVMsTUFBTSxDQUFDLEVBQWhCLENBQWtCLENBQTFDLENBQUgsQ0FBWixDQUZ3Qyx5QkFHeEMsR0FBSSxNQUFNLEdBQUssU0FBZixDQUEwQixxREFDeEIsS0FBTSxJQUFJLENBQUEsWUFBQSxDQUFBLFNBQUosQ0FBYyxjQUFBLENBQUEsV0FBQSxDQUFZLGNBQTFCLENBQU4sQ0FDRCxDQUZELGlDQUh3Qyx5QkFPeEMsTUFBTSxDQUFDLFVBQVAsQ0FBb0IsTUFBTSxDQUFDLFVBQTNCLENBUHdDLHlCQVN4QyxHQUFJLE1BQU0sQ0FBQyxHQUFYLENBQWdCLHFEQUNkLEtBQUssQ0FBQyxHQUFOLENBQVUsS0FBVixDQUFpQixNQUFNLENBQUMsR0FBUCxDQUFXLE9BQTVCLENBQXFDLE1BQU0sQ0FBQyxHQUFQLENBQVcsTUFBaEQsQ0FBd0QsTUFBTSxDQUFDLEVBQS9ELEVBQ0QsQ0FGRCxpQ0FUd0MseUJBYXhDLE1BQU8sQ0FBQSxLQUFQLENBQ0QsQ0FkRCxpQ0EzQitFLHlCQTJDL0UsTUFBTyxDQUFBLEtBQVAsQ0FDRCxDLHlCQTVDRCxPQUFBLENBQUEsa0JBQUEsQ0FBQSxrQkFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAnLi4vYWN0aW9ucy9hY3Rpb24nO1xuaW1wb3J0IHsgQ2hhbmdlQXZhdGFyQWN0aW9uIH0gZnJvbSAnLi4vYWN0aW9ucy9jaGFuZ2UtYXZhdGFyLWFjdGlvbic7XG5pbXBvcnQgeyBHYW1lRXJyb3IgfSBmcm9tICcuLi8uLi9nYW1lLWVycm9yJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IFJlb3JkZXJCZW5jaEFjdGlvbiwgUmVvcmRlckhhbmRBY3Rpb24gfSBmcm9tICcuLi9hY3Rpb25zL3Jlb3JkZXItYWN0aW9ucyc7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3N0YXRlJztcbmltcG9ydCB7IFN0b3JlTGlrZSB9IGZyb20gJy4uL3N0b3JlLWxpa2UnO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBwbGF5ZXJTdGF0ZVJlZHVjZXIoc3RvcmU6IFN0b3JlTGlrZSwgc3RhdGU6IFN0YXRlLCBhY3Rpb246IEFjdGlvbik6IFN0YXRlIHtcblxuICBpZiAoYWN0aW9uIGluc3RhbmNlb2YgUmVvcmRlckJlbmNoQWN0aW9uKSB7XG4gICAgY29uc3QgcGxheWVyID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gYWN0aW9uLmlkKTtcbiAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQgfHwgcGxheWVyLmJlbmNoW2FjdGlvbi5mcm9tXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklMTEVHQUxfQUNUSU9OKTtcbiAgICB9XG5cbiAgICBjb25zdCB0ZW1wID0gcGxheWVyLmJlbmNoW2FjdGlvbi5mcm9tXTtcbiAgICBwbGF5ZXIuYmVuY2hbYWN0aW9uLmZyb21dID0gcGxheWVyLmJlbmNoW2FjdGlvbi50b107XG4gICAgcGxheWVyLmJlbmNoW2FjdGlvbi50b10gPSB0ZW1wO1xuXG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIFJlb3JkZXJIYW5kQWN0aW9uKSB7XG4gICAgXG4gICAgY29uc3QgcGxheWVyID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gYWN0aW9uLmlkKTtcbiAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQgfHwgcGxheWVyLmhhbmQuY2FyZHMubGVuZ3RoICE9PSBhY3Rpb24ub3JkZXIubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklMTEVHQUxfQUNUSU9OKTtcbiAgICB9XG5cbiAgICBwbGF5ZXIuaGFuZC5hcHBseU9yZGVyKGFjdGlvbi5vcmRlcik7XG5cbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBpZiAoYWN0aW9uIGluc3RhbmNlb2YgQ2hhbmdlQXZhdGFyQWN0aW9uKSB7XG5cbiAgICBjb25zdCBwbGF5ZXIgPSBzdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBhY3Rpb24uaWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTExFR0FMX0FDVElPTik7XG4gICAgfVxuXG4gICAgcGxheWVyLmF2YXRhck5hbWUgPSBhY3Rpb24uYXZhdGFyTmFtZTtcblxuICAgIGlmIChhY3Rpb24ubG9nKSB7XG4gICAgICBzdG9yZS5sb2coc3RhdGUsIGFjdGlvbi5sb2cubWVzc2FnZSwgYWN0aW9uLmxvZy5wYXJhbXMsIHBsYXllci5pZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgcmV0dXJuIHN0YXRlO1xufVxuIl19