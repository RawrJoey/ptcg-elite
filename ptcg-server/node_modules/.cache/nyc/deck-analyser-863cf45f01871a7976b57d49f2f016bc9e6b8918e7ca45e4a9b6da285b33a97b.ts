"use strict";function cov_2qb0rrnmb5(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/cards/deck-analyser.ts";var hash="549639bde584ac8c87f65d7072c343f47ef54c54";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/cards/deck-analyser.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:30}},"2":{start:{line:4,column:23},end:{line:4,column:48}},"3":{start:{line:5,column:22},end:{line:5,column:58}},"4":{start:{line:6,column:21},end:{line:6,column:56}},"5":{start:{line:7,column:23},end:{line:7,column:60}},"6":{start:{line:10,column:8},end:{line:10,column:35}},"7":{start:{line:11,column:28},end:{line:11,column:68}},"8":{start:{line:12,column:8},end:{line:12,column:24}},"9":{start:{line:13,column:8},end:{line:18,column:11}},"10":{start:{line:14,column:25},end:{line:14,column:56}},"11":{start:{line:15,column:12},end:{line:17,column:13}},"12":{start:{line:16,column:16},end:{line:16,column:38}},"13":{start:{line:21,column:25},end:{line:21,column:27}},"14":{start:{line:22,column:30},end:{line:22,column:35}},"15":{start:{line:23,column:25},end:{line:23,column:30}},"16":{start:{line:24,column:8},end:{line:26,column:9}},"17":{start:{line:25,column:12},end:{line:25,column:25}},"18":{start:{line:27,column:8},end:{line:46,column:9}},"19":{start:{line:27,column:21},end:{line:27,column:22}},"20":{start:{line:28,column:25},end:{line:28,column:38}},"21":{start:{line:30,column:12},end:{line:32,column:13}},"22":{start:{line:31,column:16},end:{line:31,column:39}},"23":{start:{line:34,column:12},end:{line:39,column:13}},"24":{start:{line:35,column:16},end:{line:35,column:69}},"25":{start:{line:36,column:16},end:{line:38,column:17}},"26":{start:{line:37,column:20},end:{line:37,column:33}},"27":{start:{line:40,column:12},end:{line:45,column:13}},"28":{start:{line:41,column:16},end:{line:43,column:17}},"29":{start:{line:42,column:20},end:{line:42,column:33}},"30":{start:{line:44,column:16},end:{line:44,column:34}},"31":{start:{line:47,column:8},end:{line:47,column:31}},"32":{start:{line:50,column:26},end:{line:50,column:28}},"33":{start:{line:51,column:8},end:{line:68,column:9}},"34":{start:{line:51,column:21},end:{line:51,column:22}},"35":{start:{line:52,column:25},end:{line:52,column:38}},"36":{start:{line:53,column:27},end:{line:53,column:53}},"37":{start:{line:54,column:12},end:{line:67,column:13}},"38":{start:{line:55,column:16},end:{line:55,column:41}},"39":{start:{line:56,column:16},end:{line:58,column:17}},"40":{start:{line:57,column:20},end:{line:57,column:45}},"41":{start:{line:60,column:17},end:{line:67,column:13}},"42":{start:{line:61,column:16},end:{line:66,column:17}},"43":{start:{line:61,column:29},end:{line:61,column:30}},"44":{start:{line:62,column:20},end:{line:62,column:48}},"45":{start:{line:63,column:20},end:{line:65,column:21}},"46":{start:{line:64,column:24},end:{line:64,column:49}},"47":{start:{line:69,column:8},end:{line:69,column:25}},"48":{start:{line:72,column:0},end:{line:72,column:36}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:4},end:{line:9,column:5}},loc:{start:{line:9,column:32},end:{line:19,column:5}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:13,column:26},end:{line:13,column:27}},loc:{start:{line:13,column:34},end:{line:18,column:9}},line:13},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:4},end:{line:20,column:5}},loc:{start:{line:20,column:14},end:{line:48,column:5}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:49,column:4},end:{line:49,column:5}},loc:{start:{line:49,column:18},end:{line:70,column:5}},line:49}},branchMap:{"0":{loc:{start:{line:9,column:16},end:{line:9,column:30}},type:"default-arg",locations:[{start:{line:9,column:28},end:{line:9,column:30}}],line:9},"1":{loc:{start:{line:15,column:12},end:{line:17,column:13}},type:"if",locations:[{start:{line:15,column:12},end:{line:17,column:13}},{start:{line:15,column:12},end:{line:17,column:13}}],line:15},"2":{loc:{start:{line:24,column:8},end:{line:26,column:9}},type:"if",locations:[{start:{line:24,column:8},end:{line:26,column:9}},{start:{line:24,column:8},end:{line:26,column:9}}],line:24},"3":{loc:{start:{line:30,column:12},end:{line:32,column:13}},type:"if",locations:[{start:{line:30,column:12},end:{line:32,column:13}},{start:{line:30,column:12},end:{line:32,column:13}}],line:30},"4":{loc:{start:{line:30,column:16},end:{line:30,column:101}},type:"binary-expr",locations:[{start:{line:30,column:16},end:{line:30,column:58}},{start:{line:30,column:62},end:{line:30,column:101}}],line:30},"5":{loc:{start:{line:34,column:12},end:{line:39,column:13}},type:"if",locations:[{start:{line:34,column:12},end:{line:39,column:13}},{start:{line:34,column:12},end:{line:39,column:13}}],line:34},"6":{loc:{start:{line:34,column:16},end:{line:34,column:112}},type:"binary-expr",locations:[{start:{line:34,column:16},end:{line:34,column:59}},{start:{line:34,column:63},end:{line:34,column:112}}],line:34},"7":{loc:{start:{line:35,column:39},end:{line:35,column:63}},type:"binary-expr",locations:[{start:{line:35,column:39},end:{line:35,column:58}},{start:{line:35,column:62},end:{line:35,column:63}}],line:35},"8":{loc:{start:{line:36,column:16},end:{line:38,column:17}},type:"if",locations:[{start:{line:36,column:16},end:{line:38,column:17}},{start:{line:36,column:16},end:{line:38,column:17}}],line:36},"9":{loc:{start:{line:40,column:12},end:{line:45,column:13}},type:"if",locations:[{start:{line:40,column:12},end:{line:45,column:13}},{start:{line:40,column:12},end:{line:45,column:13}}],line:40},"10":{loc:{start:{line:41,column:16},end:{line:43,column:17}},type:"if",locations:[{start:{line:41,column:16},end:{line:43,column:17}},{start:{line:41,column:16},end:{line:43,column:17}}],line:41},"11":{loc:{start:{line:54,column:12},end:{line:67,column:13}},type:"if",locations:[{start:{line:54,column:12},end:{line:67,column:13}},{start:{line:54,column:12},end:{line:67,column:13}}],line:54},"12":{loc:{start:{line:56,column:16},end:{line:58,column:17}},type:"if",locations:[{start:{line:56,column:16},end:{line:58,column:17}},{start:{line:56,column:16},end:{line:58,column:17}}],line:56},"13":{loc:{start:{line:56,column:20},end:{line:56,column:97}},type:"binary-expr",locations:[{start:{line:56,column:20},end:{line:56,column:59}},{start:{line:56,column:63},end:{line:56,column:97}}],line:56},"14":{loc:{start:{line:60,column:17},end:{line:67,column:13}},type:"if",locations:[{start:{line:60,column:17},end:{line:67,column:13}},{start:{line:60,column:17},end:{line:67,column:13}}],line:60},"15":{loc:{start:{line:63,column:20},end:{line:65,column:21}},type:"if",locations:[{start:{line:63,column:20},end:{line:65,column:21}},{start:{line:63,column:20},end:{line:65,column:21}}],line:63},"16":{loc:{start:{line:63,column:24},end:{line:63,column:101}},type:"binary-expr",locations:[{start:{line:63,column:24},end:{line:63,column:63}},{start:{line:63,column:67},end:{line:63,column:101}}],line:63}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/cards/deck-analyser.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/cards/deck-analyser.ts"],names:[],mappings:"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",sourcesContent:["import { Card } from '../store/card/card';\nimport { CardManager } from './card-manager';\nimport { EnergyCard } from '../store/card/energy-card';\nimport { EnergyType, Stage, CardType, CardTag } from '../store/card/card-types';\nimport { PokemonCard } from '../store/card/pokemon-card';\n\nexport class DeckAnalyser {\n\n  private cards: Card[];\n\n  constructor(public cardNames: string[] = []) {\n    const cardManager = CardManager.getInstance();\n    this.cards = [];\n\n    cardNames.forEach(name => {\n      const card = cardManager.getCardByName(name);\n      if (card !== undefined) {\n        this.cards.push(card);\n      }\n    });\n  }\n\n  public isValid(): boolean {\n    const countMap: { [name: string]: number } = { };\n    let hasBasicPokemon: boolean = false;\n    let hasAceSpec: boolean = false;\n\n    if (this.cards.length !== 60) {\n      return false;\n    }\n\n    for (let i = 0; i < this.cards.length; i++) {\n      const card = this.cards[i];\n\n      // Check if deck has a basic Pokemon card\n      if (card instanceof PokemonCard && card.stage === Stage.BASIC) {\n        hasBasicPokemon = true;\n      }\n\n      // Count cards, except basic energies\n      if (!(card instanceof EnergyCard) || card.energyType !== EnergyType.BASIC) {\n        countMap[card.name] = (countMap[card.name] || 0) + 1;\n        if (countMap[card.name] > 4) {\n          return false;\n        }\n      }\n\n      if (card.tags.includes(CardTag.ACE_SPEC)) {\n        if (hasAceSpec) {\n          return false;\n        }\n        hasAceSpec = true;\n      }\n    }\n\n    return hasBasicPokemon;\n  }\n\n  public getDeckType(): CardType[] {\n    const cardTypes: CardType[] = [];\n\n    for (let i = 0; i < this.cards.length; i++) {\n      const card = this.cards[i];\n      let cardType = CardType.NONE;\n\n      if (card instanceof PokemonCard) {\n        cardType = card.cardType;\n        if (cardType !== CardType.NONE && cardTypes.indexOf(cardType) === -1) {\n          cardTypes.push(cardType);\n        }\n      } else if (card instanceof EnergyCard) {\n        for (let j = 0; j < card.provides.length; j++) {\n          cardType = card.provides[j];\n          if (cardType !== CardType.NONE && cardTypes.indexOf(cardType) === -1) {\n            cardTypes.push(cardType);\n          }\n        }\n      }\n    }\n\n    return cardTypes;\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"549639bde584ac8c87f65d7072c343f47ef54c54"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2qb0rrnmb5=function(){return actualCoverage;};}return actualCoverage;}cov_2qb0rrnmb5();cov_2qb0rrnmb5().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_2qb0rrnmb5().s[1]++;exports.DeckAnalyser=void 0;const card_manager_1=(cov_2qb0rrnmb5().s[2]++,require("./card-manager"));const energy_card_1=(cov_2qb0rrnmb5().s[3]++,require("../store/card/energy-card"));const card_types_1=(cov_2qb0rrnmb5().s[4]++,require("../store/card/card-types"));const pokemon_card_1=(cov_2qb0rrnmb5().s[5]++,require("../store/card/pokemon-card"));class DeckAnalyser{constructor(cardNames=(cov_2qb0rrnmb5().b[0][0]++,[])){cov_2qb0rrnmb5().f[0]++;cov_2qb0rrnmb5().s[6]++;this.cardNames=cardNames;const cardManager=(cov_2qb0rrnmb5().s[7]++,card_manager_1.CardManager.getInstance());cov_2qb0rrnmb5().s[8]++;this.cards=[];cov_2qb0rrnmb5().s[9]++;cardNames.forEach(name=>{cov_2qb0rrnmb5().f[1]++;const card=(cov_2qb0rrnmb5().s[10]++,cardManager.getCardByName(name));cov_2qb0rrnmb5().s[11]++;if(card!==undefined){cov_2qb0rrnmb5().b[1][0]++;cov_2qb0rrnmb5().s[12]++;this.cards.push(card);}else{cov_2qb0rrnmb5().b[1][1]++;}});}isValid(){cov_2qb0rrnmb5().f[2]++;const countMap=(cov_2qb0rrnmb5().s[13]++,{});let hasBasicPokemon=(cov_2qb0rrnmb5().s[14]++,false);let hasAceSpec=(cov_2qb0rrnmb5().s[15]++,false);cov_2qb0rrnmb5().s[16]++;if(this.cards.length!==60){cov_2qb0rrnmb5().b[2][0]++;cov_2qb0rrnmb5().s[17]++;return false;}else{cov_2qb0rrnmb5().b[2][1]++;}cov_2qb0rrnmb5().s[18]++;for(let i=(cov_2qb0rrnmb5().s[19]++,0);i<this.cards.length;i++){const card=(cov_2qb0rrnmb5().s[20]++,this.cards[i]);// Check if deck has a basic Pokemon card
cov_2qb0rrnmb5().s[21]++;if((cov_2qb0rrnmb5().b[4][0]++,card instanceof pokemon_card_1.PokemonCard)&&(cov_2qb0rrnmb5().b[4][1]++,card.stage===card_types_1.Stage.BASIC)){cov_2qb0rrnmb5().b[3][0]++;cov_2qb0rrnmb5().s[22]++;hasBasicPokemon=true;}else{cov_2qb0rrnmb5().b[3][1]++;}// Count cards, except basic energies
cov_2qb0rrnmb5().s[23]++;if((cov_2qb0rrnmb5().b[6][0]++,!(card instanceof energy_card_1.EnergyCard))||(cov_2qb0rrnmb5().b[6][1]++,card.energyType!==card_types_1.EnergyType.BASIC)){cov_2qb0rrnmb5().b[5][0]++;cov_2qb0rrnmb5().s[24]++;countMap[card.name]=((cov_2qb0rrnmb5().b[7][0]++,countMap[card.name])||(cov_2qb0rrnmb5().b[7][1]++,0))+1;cov_2qb0rrnmb5().s[25]++;if(countMap[card.name]>4){cov_2qb0rrnmb5().b[8][0]++;cov_2qb0rrnmb5().s[26]++;return false;}else{cov_2qb0rrnmb5().b[8][1]++;}}else{cov_2qb0rrnmb5().b[5][1]++;}cov_2qb0rrnmb5().s[27]++;if(card.tags.includes(card_types_1.CardTag.ACE_SPEC)){cov_2qb0rrnmb5().b[9][0]++;cov_2qb0rrnmb5().s[28]++;if(hasAceSpec){cov_2qb0rrnmb5().b[10][0]++;cov_2qb0rrnmb5().s[29]++;return false;}else{cov_2qb0rrnmb5().b[10][1]++;}cov_2qb0rrnmb5().s[30]++;hasAceSpec=true;}else{cov_2qb0rrnmb5().b[9][1]++;}}cov_2qb0rrnmb5().s[31]++;return hasBasicPokemon;}getDeckType(){cov_2qb0rrnmb5().f[3]++;const cardTypes=(cov_2qb0rrnmb5().s[32]++,[]);cov_2qb0rrnmb5().s[33]++;for(let i=(cov_2qb0rrnmb5().s[34]++,0);i<this.cards.length;i++){const card=(cov_2qb0rrnmb5().s[35]++,this.cards[i]);let cardType=(cov_2qb0rrnmb5().s[36]++,card_types_1.CardType.NONE);cov_2qb0rrnmb5().s[37]++;if(card instanceof pokemon_card_1.PokemonCard){cov_2qb0rrnmb5().b[11][0]++;cov_2qb0rrnmb5().s[38]++;cardType=card.cardType;cov_2qb0rrnmb5().s[39]++;if((cov_2qb0rrnmb5().b[13][0]++,cardType!==card_types_1.CardType.NONE)&&(cov_2qb0rrnmb5().b[13][1]++,cardTypes.indexOf(cardType)===-1)){cov_2qb0rrnmb5().b[12][0]++;cov_2qb0rrnmb5().s[40]++;cardTypes.push(cardType);}else{cov_2qb0rrnmb5().b[12][1]++;}}else{cov_2qb0rrnmb5().b[11][1]++;cov_2qb0rrnmb5().s[41]++;if(card instanceof energy_card_1.EnergyCard){cov_2qb0rrnmb5().b[14][0]++;cov_2qb0rrnmb5().s[42]++;for(let j=(cov_2qb0rrnmb5().s[43]++,0);j<card.provides.length;j++){cov_2qb0rrnmb5().s[44]++;cardType=card.provides[j];cov_2qb0rrnmb5().s[45]++;if((cov_2qb0rrnmb5().b[16][0]++,cardType!==card_types_1.CardType.NONE)&&(cov_2qb0rrnmb5().b[16][1]++,cardTypes.indexOf(cardType)===-1)){cov_2qb0rrnmb5().b[15][0]++;cov_2qb0rrnmb5().s[46]++;cardTypes.push(cardType);}else{cov_2qb0rrnmb5().b[15][1]++;}}}else{cov_2qb0rrnmb5().b[14][1]++;}}}cov_2qb0rrnmb5().s[47]++;return cardTypes;}}cov_2qb0rrnmb5().s[48]++;exports.DeckAnalyser=DeckAnalyser;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvY2FyZHMvZGVjay1hbmFseXNlci50cyIsInNvdXJjZXMiOlsiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvY2FyZHMvZGVjay1hbmFseXNlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxpREFBNkM7QUFDN0MsMkRBQXVEO0FBQ3ZELHlEQUFnRjtBQUNoRiw2REFBeUQ7QUFFekQsTUFBYSxZQUFZO0lBSXZCLFlBQW1CLFlBQXNCLEVBQUU7UUFBeEIsY0FBUyxHQUFULFNBQVMsQ0FBZTtRQUN6QyxNQUFNLFdBQVcsR0FBRywwQkFBVyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzlDLElBQUksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDO1FBRWhCLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDdkIsTUFBTSxJQUFJLEdBQUcsV0FBVyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM3QyxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUU7Z0JBQ3RCLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQ3ZCO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRU0sT0FBTztRQUNaLE1BQU0sUUFBUSxHQUErQixFQUFHLENBQUM7UUFDakQsSUFBSSxlQUFlLEdBQVksS0FBSyxDQUFDO1FBQ3JDLElBQUksVUFBVSxHQUFZLEtBQUssQ0FBQztRQUVoQyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLEVBQUUsRUFBRTtZQUM1QixPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzFDLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFM0IseUNBQXlDO1lBQ3pDLElBQUksSUFBSSxZQUFZLDBCQUFXLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxrQkFBSyxDQUFDLEtBQUssRUFBRTtnQkFDN0QsZUFBZSxHQUFHLElBQUksQ0FBQzthQUN4QjtZQUVELHFDQUFxQztZQUNyQyxJQUFJLENBQUMsQ0FBQyxJQUFJLFlBQVksd0JBQVUsQ0FBQyxJQUFJLElBQUksQ0FBQyxVQUFVLEtBQUssdUJBQVUsQ0FBQyxLQUFLLEVBQUU7Z0JBQ3pFLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDckQsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRTtvQkFDM0IsT0FBTyxLQUFLLENBQUM7aUJBQ2Q7YUFDRjtZQUVELElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsb0JBQU8sQ0FBQyxRQUFRLENBQUMsRUFBRTtnQkFDeEMsSUFBSSxVQUFVLEVBQUU7b0JBQ2QsT0FBTyxLQUFLLENBQUM7aUJBQ2Q7Z0JBQ0QsVUFBVSxHQUFHLElBQUksQ0FBQzthQUNuQjtTQUNGO1FBRUQsT0FBTyxlQUFlLENBQUM7SUFDekIsQ0FBQztJQUVNLFdBQVc7UUFDaEIsTUFBTSxTQUFTLEdBQWUsRUFBRSxDQUFDO1FBRWpDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUMxQyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzNCLElBQUksUUFBUSxHQUFHLHFCQUFRLENBQUMsSUFBSSxDQUFDO1lBRTdCLElBQUksSUFBSSxZQUFZLDBCQUFXLEVBQUU7Z0JBQy9CLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO2dCQUN6QixJQUFJLFFBQVEsS0FBSyxxQkFBUSxDQUFDLElBQUksSUFBSSxTQUFTLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO29CQUNwRSxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2lCQUMxQjthQUNGO2lCQUFNLElBQUksSUFBSSxZQUFZLHdCQUFVLEVBQUU7Z0JBQ3JDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDN0MsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQzVCLElBQUksUUFBUSxLQUFLLHFCQUFRLENBQUMsSUFBSSxJQUFJLFNBQVMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7d0JBQ3BFLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7cUJBQzFCO2lCQUNGO2FBQ0Y7U0FDRjtRQUVELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7Q0FFRjtBQTdFRCxvQ0E2RUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYXJkIH0gZnJvbSAnLi4vc3RvcmUvY2FyZC9jYXJkJztcbmltcG9ydCB7IENhcmRNYW5hZ2VyIH0gZnJvbSAnLi9jYXJkLW1hbmFnZXInO1xuaW1wb3J0IHsgRW5lcmd5Q2FyZCB9IGZyb20gJy4uL3N0b3JlL2NhcmQvZW5lcmd5LWNhcmQnO1xuaW1wb3J0IHsgRW5lcmd5VHlwZSwgU3RhZ2UsIENhcmRUeXBlLCBDYXJkVGFnIH0gZnJvbSAnLi4vc3RvcmUvY2FyZC9jYXJkLXR5cGVzJztcbmltcG9ydCB7IFBva2Vtb25DYXJkIH0gZnJvbSAnLi4vc3RvcmUvY2FyZC9wb2tlbW9uLWNhcmQnO1xuXG5leHBvcnQgY2xhc3MgRGVja0FuYWx5c2VyIHtcblxuICBwcml2YXRlIGNhcmRzOiBDYXJkW107XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNhcmROYW1lczogc3RyaW5nW10gPSBbXSkge1xuICAgIGNvbnN0IGNhcmRNYW5hZ2VyID0gQ2FyZE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICB0aGlzLmNhcmRzID0gW107XG5cbiAgICBjYXJkTmFtZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgIGNvbnN0IGNhcmQgPSBjYXJkTWFuYWdlci5nZXRDYXJkQnlOYW1lKG5hbWUpO1xuICAgICAgaWYgKGNhcmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNhcmRzLnB1c2goY2FyZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgaXNWYWxpZCgpOiBib29sZWFuIHtcbiAgICBjb25zdCBjb3VudE1hcDogeyBbbmFtZTogc3RyaW5nXTogbnVtYmVyIH0gPSB7IH07XG4gICAgbGV0IGhhc0Jhc2ljUG9rZW1vbjogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGxldCBoYXNBY2VTcGVjOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5jYXJkcy5sZW5ndGggIT09IDYwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5jYXJkc1tpXTtcblxuICAgICAgLy8gQ2hlY2sgaWYgZGVjayBoYXMgYSBiYXNpYyBQb2tlbW9uIGNhcmRcbiAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgUG9rZW1vbkNhcmQgJiYgY2FyZC5zdGFnZSA9PT0gU3RhZ2UuQkFTSUMpIHtcbiAgICAgICAgaGFzQmFzaWNQb2tlbW9uID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ291bnQgY2FyZHMsIGV4Y2VwdCBiYXNpYyBlbmVyZ2llc1xuICAgICAgaWYgKCEoY2FyZCBpbnN0YW5jZW9mIEVuZXJneUNhcmQpIHx8IGNhcmQuZW5lcmd5VHlwZSAhPT0gRW5lcmd5VHlwZS5CQVNJQykge1xuICAgICAgICBjb3VudE1hcFtjYXJkLm5hbWVdID0gKGNvdW50TWFwW2NhcmQubmFtZV0gfHwgMCkgKyAxO1xuICAgICAgICBpZiAoY291bnRNYXBbY2FyZC5uYW1lXSA+IDQpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNhcmQudGFncy5pbmNsdWRlcyhDYXJkVGFnLkFDRV9TUEVDKSkge1xuICAgICAgICBpZiAoaGFzQWNlU3BlYykge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBoYXNBY2VTcGVjID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaGFzQmFzaWNQb2tlbW9uO1xuICB9XG5cbiAgcHVibGljIGdldERlY2tUeXBlKCk6IENhcmRUeXBlW10ge1xuICAgIGNvbnN0IGNhcmRUeXBlczogQ2FyZFR5cGVbXSA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5jYXJkc1tpXTtcbiAgICAgIGxldCBjYXJkVHlwZSA9IENhcmRUeXBlLk5PTkU7XG5cbiAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgUG9rZW1vbkNhcmQpIHtcbiAgICAgICAgY2FyZFR5cGUgPSBjYXJkLmNhcmRUeXBlO1xuICAgICAgICBpZiAoY2FyZFR5cGUgIT09IENhcmRUeXBlLk5PTkUgJiYgY2FyZFR5cGVzLmluZGV4T2YoY2FyZFR5cGUpID09PSAtMSkge1xuICAgICAgICAgIGNhcmRUeXBlcy5wdXNoKGNhcmRUeXBlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjYXJkIGluc3RhbmNlb2YgRW5lcmd5Q2FyZCkge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNhcmQucHJvdmlkZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBjYXJkVHlwZSA9IGNhcmQucHJvdmlkZXNbal07XG4gICAgICAgICAgaWYgKGNhcmRUeXBlICE9PSBDYXJkVHlwZS5OT05FICYmIGNhcmRUeXBlcy5pbmRleE9mKGNhcmRUeXBlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIGNhcmRUeXBlcy5wdXNoKGNhcmRUeXBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY2FyZFR5cGVzO1xuICB9XG5cbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL2NhcmRzL2RlY2stYW5hbHlzZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtnT0FDQSxLQUFBLENBQUEsY0FBQSwwQkFBQSxPQUFBLENBQUEsZ0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGFBQUEsMEJBQUEsT0FBQSxDQUFBLDJCQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxZQUFBLDBCQUFBLE9BQUEsQ0FBQSwwQkFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsY0FBQSwwQkFBQSxPQUFBLENBQUEsNEJBQUEsQ0FBQSxDQUFBLENBRUEsS0FBYSxDQUFBLFlBQVksQ0FJdkIsV0FBQSxDQUFtQixTQUFBLDZCQUFzQixFQUF0QixDQUFuQixDQUEyQyxpREFBeEIsS0FBQSxTQUFBLENBQUEsU0FBQSxDQUNqQixLQUFNLENBQUEsV0FBVywwQkFBRyxjQUFBLENBQUEsV0FBQSxDQUFZLFdBQVosRUFBSCxDQUFqQixDQUR5Qyx3QkFFekMsS0FBSyxLQUFMLENBQWEsRUFBYixDQUZ5Qyx3QkFJekMsU0FBUyxDQUFDLE9BQVYsQ0FBa0IsSUFBSSxFQUFHLHlCQUN2QixLQUFNLENBQUEsSUFBSSwyQkFBRyxXQUFXLENBQUMsYUFBWixDQUEwQixJQUExQixDQUFILENBQVYsQ0FEdUIseUJBRXZCLEdBQUksSUFBSSxHQUFLLFNBQWIsQ0FBd0IscURBQ3RCLEtBQUssS0FBTCxDQUFXLElBQVgsQ0FBZ0IsSUFBaEIsRUFDRCxDQUZELGlDQUdELENBTEQsRUFNRCxDQUVNLE9BQU8sRUFBQSx5QkFDWixLQUFNLENBQUEsUUFBUSwyQkFBK0IsRUFBL0IsQ0FBZCxDQUNBLEdBQUksQ0FBQSxlQUFlLDJCQUFZLEtBQVosQ0FBbkIsQ0FDQSxHQUFJLENBQUEsVUFBVSwyQkFBWSxLQUFaLENBQWQsQ0FIWSx5QkFLWixHQUFJLEtB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LENBQXNFLHNEQUNwRSxTQUFTLENBQUMsSUFBVixDQUFlLFFBQWYsRUFDRCxDQUZELGtDQUdELENBQ0YsQ0FQTSxrQ0FPTixDQUNGLENBcEJlLHlCQXNCaEIsTUFBTyxDQUFBLFNBQVAsQ0FDRCxDQTNFc0IsQyx5QkFBekIsT0FBQSxDQUFBLFlBQUEsQ0FBQSxZQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYXJkIH0gZnJvbSAnLi4vc3RvcmUvY2FyZC9jYXJkJztcbmltcG9ydCB7IENhcmRNYW5hZ2VyIH0gZnJvbSAnLi9jYXJkLW1hbmFnZXInO1xuaW1wb3J0IHsgRW5lcmd5Q2FyZCB9IGZyb20gJy4uL3N0b3JlL2NhcmQvZW5lcmd5LWNhcmQnO1xuaW1wb3J0IHsgRW5lcmd5VHlwZSwgU3RhZ2UsIENhcmRUeXBlLCBDYXJkVGFnIH0gZnJvbSAnLi4vc3RvcmUvY2FyZC9jYXJkLXR5cGVzJztcbmltcG9ydCB7IFBva2Vtb25DYXJkIH0gZnJvbSAnLi4vc3RvcmUvY2FyZC9wb2tlbW9uLWNhcmQnO1xuXG5leHBvcnQgY2xhc3MgRGVja0FuYWx5c2VyIHtcblxuICBwcml2YXRlIGNhcmRzOiBDYXJkW107XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNhcmROYW1lczogc3RyaW5nW10gPSBbXSkge1xuICAgIGNvbnN0IGNhcmRNYW5hZ2VyID0gQ2FyZE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICB0aGlzLmNhcmRzID0gW107XG5cbiAgICBjYXJkTmFtZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgIGNvbnN0IGNhcmQgPSBjYXJkTWFuYWdlci5nZXRDYXJkQnlOYW1lKG5hbWUpO1xuICAgICAgaWYgKGNhcmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNhcmRzLnB1c2goY2FyZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgaXNWYWxpZCgpOiBib29sZWFuIHtcbiAgICBjb25zdCBjb3VudE1hcDogeyBbbmFtZTogc3RyaW5nXTogbnVtYmVyIH0gPSB7IH07XG4gICAgbGV0IGhhc0Jhc2ljUG9rZW1vbjogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGxldCBoYXNBY2VTcGVjOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5jYXJkcy5sZW5ndGggIT09IDYwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5jYXJkc1tpXTtcblxuICAgICAgLy8gQ2hlY2sgaWYgZGVjayBoYXMgYSBiYXNpYyBQb2tlbW9uIGNhcmRcbiAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgUG9rZW1vbkNhcmQgJiYgY2FyZC5zdGFnZSA9PT0gU3RhZ2UuQkFTSUMpIHtcbiAgICAgICAgaGFzQmFzaWNQb2tlbW9uID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ291bnQgY2FyZHMsIGV4Y2VwdCBiYXNpYyBlbmVyZ2llc1xuICAgICAgaWYgKCEoY2FyZCBpbnN0YW5jZW9mIEVuZXJneUNhcmQpIHx8IGNhcmQuZW5lcmd5VHlwZSAhPT0gRW5lcmd5VHlwZS5CQVNJQykge1xuICAgICAgICBjb3VudE1hcFtjYXJkLm5hbWVdID0gKGNvdW50TWFwW2NhcmQubmFtZV0gfHwgMCkgKyAxO1xuICAgICAgICBpZiAoY291bnRNYXBbY2FyZC5uYW1lXSA+IDQpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNhcmQudGFncy5pbmNsdWRlcyhDYXJkVGFnLkFDRV9TUEVDKSkge1xuICAgICAgICBpZiAoaGFzQWNlU3BlYykge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBoYXNBY2VTcGVjID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaGFzQmFzaWNQb2tlbW9uO1xuICB9XG5cbiAgcHVibGljIGdldERlY2tUeXBlKCk6IENhcmRUeXBlW10ge1xuICAgIGNvbnN0IGNhcmRUeXBlczogQ2FyZFR5cGVbXSA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5jYXJkc1tpXTtcbiAgICAgIGxldCBjYXJkVHlwZSA9IENhcmRUeXBlLk5PTkU7XG5cbiAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgUG9rZW1vbkNhcmQpIHtcbiAgICAgICAgY2FyZFR5cGUgPSBjYXJkLmNhcmRUeXBlO1xuICAgICAgICBpZiAoY2FyZFR5cGUgIT09IENhcmRUeXBlLk5PTkUgJiYgY2FyZFR5cGVzLmluZGV4T2YoY2FyZFR5cGUpID09PSAtMSkge1xuICAgICAgICAgIGNhcmRUeXBlcy5wdXNoKGNhcmRUeXBlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjYXJkIGluc3RhbmNlb2YgRW5lcmd5Q2FyZCkge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNhcmQucHJvdmlkZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBjYXJkVHlwZSA9IGNhcmQucHJvdmlkZXNbal07XG4gICAgICAgICAgaWYgKGNhcmRUeXBlICE9PSBDYXJkVHlwZS5OT05FICYmIGNhcmRUeXBlcy5pbmRleE9mKGNhcmRUeXBlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIGNhcmRUeXBlcy5wdXNoKGNhcmRUeXBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY2FyZFR5cGVzO1xuICB9XG5cbn1cbiJdfQ==