"use strict";function cov_23e5opclmw(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/prompt-resolver/choose-pokemon-prompt-resolver.ts";var hash="6dcdf6ebc0e18be167f3bca2c5ac7915ca0599db";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/prompt-resolver/choose-pokemon-prompt-resolver.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:45}},"2":{start:{line:4,column:15},end:{line:4,column:36}},"3":{start:{line:5,column:26},end:{line:5,column:54}},"4":{start:{line:6,column:32},end:{line:6,column:89}},"5":{start:{line:9,column:8},end:{line:13,column:9}},"6":{start:{line:10,column:26},end:{line:10,column:66}},"7":{start:{line:11,column:27},end:{line:11,column:62}},"8":{start:{line:12,column:12},end:{line:12,column:69}},"9":{start:{line:16,column:22},end:{line:19,column:10}},"10":{start:{line:17,column:26},end:{line:17,column:69}},"11":{start:{line:18,column:12},end:{line:18,column:54}},"12":{start:{line:20,column:8},end:{line:20,column:48}},"13":{start:{line:20,column:29},end:{line:20,column:46}},"14":{start:{line:21,column:23},end:{line:21,column:25}},"15":{start:{line:22,column:20},end:{line:22,column:38}},"16":{start:{line:23,column:20},end:{line:23,column:38}},"17":{start:{line:24,column:20},end:{line:24,column:21}},"18":{start:{line:25,column:8},end:{line:35,column:9}},"19":{start:{line:26,column:25},end:{line:26,column:38}},"20":{start:{line:27,column:12},end:{line:29,column:13}},"21":{start:{line:28,column:16},end:{line:28,column:22}},"22":{start:{line:30,column:12},end:{line:30,column:39}},"23":{start:{line:31,column:12},end:{line:31,column:32}},"24":{start:{line:32,column:12},end:{line:34,column:13}},"25":{start:{line:33,column:16},end:{line:33,column:22}},"26":{start:{line:36,column:8},end:{line:38,column:9}},"27":{start:{line:37,column:12},end:{line:37,column:24}},"28":{start:{line:39,column:8},end:{line:41,column:9}},"29":{start:{line:40,column:12},end:{line:40,column:24}},"30":{start:{line:42,column:8},end:{line:42,column:22}},"31":{start:{line:45,column:20},end:{line:45,column:66}},"32":{start:{line:46,column:8},end:{line:48,column:9}},"33":{start:{line:47,column:12},end:{line:47,column:27}},"34":{start:{line:50,column:32},end:{line:55,column:9}},"35":{start:{line:56,column:8},end:{line:58,column:9}},"36":{start:{line:57,column:12},end:{line:57,column:27}},"37":{start:{line:59,column:8},end:{line:59,column:21}},"38":{start:{line:62,column:23},end:{line:62,column:72}},"39":{start:{line:62,column:47},end:{line:62,column:71}},"40":{start:{line:63,column:25},end:{line:63,column:74}},"41":{start:{line:63,column:49},end:{line:63,column:73}},"42":{start:{line:64,column:8},end:{line:66,column:9}},"43":{start:{line:65,column:12},end:{line:65,column:22}},"44":{start:{line:67,column:28},end:{line:67,column:109}},"45":{start:{line:68,column:26},end:{line:68,column:110}},"46":{start:{line:69,column:25},end:{line:69,column:69}},"47":{start:{line:70,column:26},end:{line:70,column:71}},"48":{start:{line:71,column:21},end:{line:71,column:23}},"49":{start:{line:72,column:8},end:{line:76,column:9}},"50":{start:{line:73,column:12},end:{line:75,column:15}},"51":{start:{line:73,column:39},end:{line:73,column:53}},"52":{start:{line:74,column:16},end:{line:74,column:83}},"53":{start:{line:77,column:8},end:{line:79,column:9}},"54":{start:{line:78,column:12},end:{line:78,column:93}},"55":{start:{line:80,column:8},end:{line:82,column:9}},"56":{start:{line:81,column:12},end:{line:81,column:94}},"57":{start:{line:83,column:8},end:{line:87,column:9}},"58":{start:{line:84,column:12},end:{line:86,column:15}},"59":{start:{line:84,column:37},end:{line:84,column:51}},"60":{start:{line:85,column:16},end:{line:85,column:86}},"61":{start:{line:88,column:24},end:{line:88,column:102}},"62":{start:{line:88,column:56},end:{line:88,column:101}},"63":{start:{line:89,column:8},end:{line:89,column:67}},"64":{start:{line:89,column:36},end:{line:89,column:65}},"65":{start:{line:90,column:8},end:{line:90,column:22}},"66":{start:{line:93,column:0},end:{line:93,column:66}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:4},end:{line:8,column:5}},loc:{start:{line:8,column:41},end:{line:14,column:5}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:4},end:{line:15,column:5}},loc:{start:{line:15,column:38},end:{line:43,column:5}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:16,column:35},end:{line:16,column:36}},loc:{start:{line:16,column:43},end:{line:19,column:9}},line:16},"3":{name:"(anonymous_3)",decl:{start:{line:20,column:19},end:{line:20,column:20}},loc:{start:{line:20,column:29},end:{line:20,column:46}},line:20},"4":{name:"(anonymous_4)",decl:{start:{line:44,column:4},end:{line:44,column:5}},loc:{start:{line:44,column:43},end:{line:60,column:5}},line:44},"5":{name:"(anonymous_5)",decl:{start:{line:61,column:4},end:{line:61,column:5}},loc:{start:{line:61,column:40},end:{line:91,column:5}},line:61},"6":{name:"(anonymous_6)",decl:{start:{line:62,column:42},end:{line:62,column:43}},loc:{start:{line:62,column:47},end:{line:62,column:71}},line:62},"7":{name:"(anonymous_7)",decl:{start:{line:63,column:44},end:{line:63,column:45}},loc:{start:{line:63,column:49},end:{line:63,column:73}},line:63},"8":{name:"(anonymous_8)",decl:{start:{line:73,column:34},end:{line:73,column:35}},loc:{start:{line:73,column:39},end:{line:73,column:53}},line:73},"9":{name:"(anonymous_9)",decl:{start:{line:73,column:63},end:{line:73,column:64}},loc:{start:{line:73,column:68},end:{line:75,column:13}},line:73},"10":{name:"(anonymous_10)",decl:{start:{line:84,column:32},end:{line:84,column:33}},loc:{start:{line:84,column:37},end:{line:84,column:51}},line:84},"11":{name:"(anonymous_11)",decl:{start:{line:84,column:61},end:{line:84,column:62}},loc:{start:{line:84,column:66},end:{line:86,column:13}},line:84},"12":{name:"(anonymous_12)",decl:{start:{line:88,column:51},end:{line:88,column:52}},loc:{start:{line:88,column:56},end:{line:88,column:101}},line:88},"13":{name:"(anonymous_13)",decl:{start:{line:89,column:31},end:{line:89,column:32}},loc:{start:{line:89,column:36},end:{line:89,column:65}},line:89}},branchMap:{"0":{loc:{start:{line:9,column:8},end:{line:13,column:9}},type:"if",locations:[{start:{line:9,column:8},end:{line:13,column:9}},{start:{line:9,column:8},end:{line:13,column:9}}],line:9},"1":{loc:{start:{line:25,column:15},end:{line:25,column:78}},type:"binary-expr",locations:[{start:{line:25,column:15},end:{line:25,column:31}},{start:{line:25,column:36},end:{line:25,column:54}},{start:{line:25,column:58},end:{line:25,column:77}}],line:25},"2":{loc:{start:{line:27,column:12},end:{line:29,column:13}},type:"if",locations:[{start:{line:27,column:12},end:{line:29,column:13}},{start:{line:27,column:12},end:{line:29,column:13}}],line:27},"3":{loc:{start:{line:32,column:12},end:{line:34,column:13}},type:"if",locations:[{start:{line:32,column:12},end:{line:34,column:13}},{start:{line:32,column:12},end:{line:34,column:13}}],line:32},"4":{loc:{start:{line:36,column:8},end:{line:38,column:9}},type:"if",locations:[{start:{line:36,column:8},end:{line:38,column:9}},{start:{line:36,column:8},end:{line:38,column:9}}],line:36},"5":{loc:{start:{line:36,column:12},end:{line:36,column:61}},type:"binary-expr",locations:[{start:{line:36,column:12},end:{line:36,column:31}},{start:{line:36,column:35},end:{line:36,column:61}}],line:36},"6":{loc:{start:{line:39,column:8},end:{line:41,column:9}},type:"if",locations:[{start:{line:39,column:8},end:{line:41,column:9}},{start:{line:39,column:8},end:{line:41,column:9}}],line:39},"7":{loc:{start:{line:39,column:12},end:{line:39,column:51}},type:"binary-expr",locations:[{start:{line:39,column:12},end:{line:39,column:21}},{start:{line:39,column:25},end:{line:39,column:51}}],line:39},"8":{loc:{start:{line:46,column:8},end:{line:48,column:9}},type:"if",locations:[{start:{line:46,column:8},end:{line:48,column:9}},{start:{line:46,column:8},end:{line:48,column:9}}],line:46},"9":{loc:{start:{line:56,column:8},end:{line:58,column:9}},type:"if",locations:[{start:{line:56,column:8},end:{line:58,column:9}},{start:{line:56,column:8},end:{line:58,column:9}}],line:56},"10":{loc:{start:{line:64,column:8},end:{line:66,column:9}},type:"if",locations:[{start:{line:64,column:8},end:{line:66,column:9}},{start:{line:64,column:8},end:{line:66,column:9}}],line:64},"11":{loc:{start:{line:64,column:12},end:{line:64,column:58}},type:"binary-expr",locations:[{start:{line:64,column:12},end:{line:64,column:32}},{start:{line:64,column:36},end:{line:64,column:58}}],line:64},"12":{loc:{start:{line:72,column:8},end:{line:76,column:9}},type:"if",locations:[{start:{line:72,column:8},end:{line:76,column:9}},{start:{line:72,column:8},end:{line:76,column:9}}],line:72},"13":{loc:{start:{line:72,column:12},end:{line:72,column:35}},type:"binary-expr",locations:[{start:{line:72,column:12},end:{line:72,column:23}},{start:{line:72,column:27},end:{line:72,column:35}}],line:72},"14":{loc:{start:{line:77,column:8},end:{line:79,column:9}},type:"if",locations:[{start:{line:77,column:8},end:{line:79,column:9}},{start:{line:77,column:8},end:{line:79,column:9}}],line:77},"15":{loc:{start:{line:77,column:12},end:{line:77,column:36}},type:"binary-expr",locations:[{start:{line:77,column:12},end:{line:77,column:23}},{start:{line:77,column:27},end:{line:77,column:36}}],line:77},"16":{loc:{start:{line:80,column:8},end:{line:82,column:9}},type:"if",locations:[{start:{line:80,column:8},end:{line:82,column:9}},{start:{line:80,column:8},end:{line:82,column:9}}],line:80},"17":{loc:{start:{line:80,column:12},end:{line:80,column:34}},type:"binary-expr",locations:[{start:{line:80,column:12},end:{line:80,column:21}},{start:{line:80,column:25},end:{line:80,column:34}}],line:80},"18":{loc:{start:{line:83,column:8},end:{line:87,column:9}},type:"if",locations:[{start:{line:83,column:8},end:{line:87,column:9}},{start:{line:83,column:8},end:{line:87,column:9}}],line:83},"19":{loc:{start:{line:83,column:12},end:{line:83,column:33}},type:"binary-expr",locations:[{start:{line:83,column:12},end:{line:83,column:21}},{start:{line:83,column:25},end:{line:83,column:33}}],line:83}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{"0":[0,0],"1":[0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/prompt-resolver/choose-pokemon-prompt-resolver.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/prompt-resolver/choose-pokemon-prompt-resolver.ts"],names:[],mappings:"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",sourcesContent:["import { Player, State, Action, ResolvePromptAction, Prompt, PokemonCardList,\n  PlayerType, SlotType, StateUtils, GameMessage } from '../../game';\nimport { PromptResolver } from './prompt-resolver';\nimport { ChoosePokemonPrompt } from '../../game/store/prompts/choose-pokemon-prompt';\n\ninterface PlayerCardList {\n  cardList: PokemonCardList;\n  player: PlayerType;\n}\n\nexport class ChoosePokemonPromptResolver extends PromptResolver {\n\n  public resolvePrompt(state: State, player: Player, prompt: Prompt<any>): Action | undefined {\n    if (prompt instanceof ChoosePokemonPrompt) {\n      const items = this.buildPokemonToChoose(state, prompt);\n      const result = this.getPromptResult(prompt, items);\n      return new ResolvePromptAction(prompt.id, result);\n    }\n  }\n\n  private getPromptResult(prompt: ChoosePokemonPrompt, pokemons: PlayerCardList[]): PokemonCardList[] | null {\n    const items = pokemons.map(item => {\n      const score = this.getPokemonScoreForPrompt(prompt, item);\n      return { cardList: item.cardList, score };\n    });\n    items.sort((a, b) => b.score - a.score);\n\n    const result: PokemonCardList[] = [];\n    const min = prompt.options.min;\n    const max = prompt.options.max;\n    let score = 0;\n\n    while (items.length > 0 && (items[0].score > 0 || result.length < min)) {\n      const item = items.shift();\n      if (item === undefined) {\n        break;\n      }\n      result.push(item.cardList);\n      score += item.score;\n\n      if (result.length >= max) {\n        break;\n      }\n    }\n\n    if (result.length === 0 && prompt.options.allowCancel) {\n      return null;\n    }\n\n    if (score < 0 && prompt.options.allowCancel) {\n      return null;\n    }\n\n    return result;\n  }\n\n  private getPokemonScoreForPrompt(prompt: ChoosePokemonPrompt, item: PlayerCardList): number {\n    let score = this.stateScore.getPokemonScore(item.cardList);\n\n    if (item.player === PlayerType.TOP_PLAYER) {\n      score = -score;\n    }\n\n    // reverse messages\n    const weakestMessages: GameMessage[] = [\n      GameMessage.CHOOSE_POKEMON_TO_DAMAGE,\n      GameMessage.CHOOSE_POKEMON_TO_DISCARD,\n      GameMessage.CHOOSE_POKEMON_TO_DISCARD_CARDS,\n      GameMessage.CHOOSE_POKEMON_TO_PICK_UP\n    ];\n\n    if (weakestMessages.includes(prompt.message)) {\n      score = -score;\n    }\n\n    return score;\n  }\n\n  private buildPokemonToChoose(state: State, prompt: ChoosePokemonPrompt): PlayerCardList[] {\n    const player = state.players.find(p => p.id === prompt.playerId);\n    const opponent = state.players.find(p => p.id !== prompt.playerId);\n    if (player === undefined || opponent === undefined) {\n      return [];\n    }\n    const hasOpponent = [PlayerType.TOP_PLAYER, PlayerType.ANY].includes(prompt.playerType);\n    const hasPlayer = [PlayerType.BOTTOM_PLAYER, PlayerType.ANY].includes(prompt.playerType);\n    const hasBench = prompt.slots.includes(SlotType.BENCH);\n    const hasActive = prompt.slots.includes(SlotType.ACTIVE);\n\n    let result: PlayerCardList[] = [];\n    if (hasOpponent && hasBench) {\n      opponent.bench.filter(b => b.cards.length).forEach(b => {\n        result.push({ cardList: b, player: PlayerType.TOP_PLAYER });\n      });\n    }\n    if (hasOpponent && hasActive) {\n      result.push({ cardList: opponent.active, player: PlayerType.TOP_PLAYER });\n    }\n    if (hasPlayer && hasActive) {\n      result.push({ cardList: player.active, player: PlayerType.BOTTOM_PLAYER });\n    }\n    if (hasPlayer && hasBench) {\n      player.bench.filter(b => b.cards.length).forEach(b => {\n        result.push({ cardList: b, player: PlayerType.BOTTOM_PLAYER });\n      });\n    }\n\n    const blocked = prompt.options.blocked.map(b => StateUtils.getTarget(state, player, b));\n    result = result.filter(r => !blocked.includes(r.cardList));\n    return result;\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6dcdf6ebc0e18be167f3bca2c5ac7915ca0599db"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_23e5opclmw=function(){return actualCoverage;};}return actualCoverage;}cov_23e5opclmw();cov_23e5opclmw().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_23e5opclmw().s[1]++;exports.ChoosePokemonPromptResolver=void 0;const game_1=(cov_23e5opclmw().s[2]++,require("../../game"));const prompt_resolver_1=(cov_23e5opclmw().s[3]++,require("./prompt-resolver"));const choose_pokemon_prompt_1=(cov_23e5opclmw().s[4]++,require("../../game/store/prompts/choose-pokemon-prompt"));class ChoosePokemonPromptResolver extends(prompt_resolver_1.PromptResolver){resolvePrompt(state,player,prompt){cov_23e5opclmw().f[0]++;cov_23e5opclmw().s[5]++;if(prompt instanceof choose_pokemon_prompt_1.ChoosePokemonPrompt){cov_23e5opclmw().b[0][0]++;const items=(cov_23e5opclmw().s[6]++,this.buildPokemonToChoose(state,prompt));const result=(cov_23e5opclmw().s[7]++,this.getPromptResult(prompt,items));cov_23e5opclmw().s[8]++;return new game_1.ResolvePromptAction(prompt.id,result);}else{cov_23e5opclmw().b[0][1]++;}}getPromptResult(prompt,pokemons){cov_23e5opclmw().f[1]++;const items=(cov_23e5opclmw().s[9]++,pokemons.map(item=>{cov_23e5opclmw().f[2]++;const score=(cov_23e5opclmw().s[10]++,this.getPokemonScoreForPrompt(prompt,item));cov_23e5opclmw().s[11]++;return{cardList:item.cardList,score};}));cov_23e5opclmw().s[12]++;items.sort((a,b)=>{cov_23e5opclmw().f[3]++;cov_23e5opclmw().s[13]++;return b.score-a.score;});const result=(cov_23e5opclmw().s[14]++,[]);const min=(cov_23e5opclmw().s[15]++,prompt.options.min);const max=(cov_23e5opclmw().s[16]++,prompt.options.max);let score=(cov_23e5opclmw().s[17]++,0);cov_23e5opclmw().s[18]++;while((cov_23e5opclmw().b[1][0]++,items.length>0)&&((cov_23e5opclmw().b[1][1]++,items[0].score>0)||(cov_23e5opclmw().b[1][2]++,result.length<min))){const item=(cov_23e5opclmw().s[19]++,items.shift());cov_23e5opclmw().s[20]++;if(item===undefined){cov_23e5opclmw().b[2][0]++;cov_23e5opclmw().s[21]++;break;}else{cov_23e5opclmw().b[2][1]++;}cov_23e5opclmw().s[22]++;result.push(item.cardList);cov_23e5opclmw().s[23]++;score+=item.score;cov_23e5opclmw().s[24]++;if(result.length>=max){cov_23e5opclmw().b[3][0]++;cov_23e5opclmw().s[25]++;break;}else{cov_23e5opclmw().b[3][1]++;}}cov_23e5opclmw().s[26]++;if((cov_23e5opclmw().b[5][0]++,result.length===0)&&(cov_23e5opclmw().b[5][1]++,prompt.options.allowCancel)){cov_23e5opclmw().b[4][0]++;cov_23e5opclmw().s[27]++;return null;}else{cov_23e5opclmw().b[4][1]++;}cov_23e5opclmw().s[28]++;if((cov_23e5opclmw().b[7][0]++,score<0)&&(cov_23e5opclmw().b[7][1]++,prompt.options.allowCancel)){cov_23e5opclmw().b[6][0]++;cov_23e5opclmw().s[29]++;return null;}else{cov_23e5opclmw().b[6][1]++;}cov_23e5opclmw().s[30]++;return result;}getPokemonScoreForPrompt(prompt,item){cov_23e5opclmw().f[4]++;let score=(cov_23e5opclmw().s[31]++,this.stateScore.getPokemonScore(item.cardList));cov_23e5opclmw().s[32]++;if(item.player===game_1.PlayerType.TOP_PLAYER){cov_23e5opclmw().b[8][0]++;cov_23e5opclmw().s[33]++;score=-score;}else{cov_23e5opclmw().b[8][1]++;}// reverse messages
const weakestMessages=(cov_23e5opclmw().s[34]++,[game_1.GameMessage.CHOOSE_POKEMON_TO_DAMAGE,game_1.GameMessage.CHOOSE_POKEMON_TO_DISCARD,game_1.GameMessage.CHOOSE_POKEMON_TO_DISCARD_CARDS,game_1.GameMessage.CHOOSE_POKEMON_TO_PICK_UP]);cov_23e5opclmw().s[35]++;if(weakestMessages.includes(prompt.message)){cov_23e5opclmw().b[9][0]++;cov_23e5opclmw().s[36]++;score=-score;}else{cov_23e5opclmw().b[9][1]++;}cov_23e5opclmw().s[37]++;return score;}buildPokemonToChoose(state,prompt){cov_23e5opclmw().f[5]++;const player=(cov_23e5opclmw().s[38]++,state.players.find(p=>{cov_23e5opclmw().f[6]++;cov_23e5opclmw().s[39]++;return p.id===prompt.playerId;}));const opponent=(cov_23e5opclmw().s[40]++,state.players.find(p=>{cov_23e5opclmw().f[7]++;cov_23e5opclmw().s[41]++;return p.id!==prompt.playerId;}));cov_23e5opclmw().s[42]++;if((cov_23e5opclmw().b[11][0]++,player===undefined)||(cov_23e5opclmw().b[11][1]++,opponent===undefined)){cov_23e5opclmw().b[10][0]++;cov_23e5opclmw().s[43]++;return[];}else{cov_23e5opclmw().b[10][1]++;}const hasOpponent=(cov_23e5opclmw().s[44]++,[game_1.PlayerType.TOP_PLAYER,game_1.PlayerType.ANY].includes(prompt.playerType));const hasPlayer=(cov_23e5opclmw().s[45]++,[game_1.PlayerType.BOTTOM_PLAYER,game_1.PlayerType.ANY].includes(prompt.playerType));const hasBench=(cov_23e5opclmw().s[46]++,prompt.slots.includes(game_1.SlotType.BENCH));const hasActive=(cov_23e5opclmw().s[47]++,prompt.slots.includes(game_1.SlotType.ACTIVE));let result=(cov_23e5opclmw().s[48]++,[]);cov_23e5opclmw().s[49]++;if((cov_23e5opclmw().b[13][0]++,hasOpponent)&&(cov_23e5opclmw().b[13][1]++,hasBench)){cov_23e5opclmw().b[12][0]++;cov_23e5opclmw().s[50]++;opponent.bench.filter(b=>{cov_23e5opclmw().f[8]++;cov_23e5opclmw().s[51]++;return b.cards.length;}).forEach(b=>{cov_23e5opclmw().f[9]++;cov_23e5opclmw().s[52]++;result.push({cardList:b,player:game_1.PlayerType.TOP_PLAYER});});}else{cov_23e5opclmw().b[12][1]++;}cov_23e5opclmw().s[53]++;if((cov_23e5opclmw().b[15][0]++,hasOpponent)&&(cov_23e5opclmw().b[15][1]++,hasActive)){cov_23e5opclmw().b[14][0]++;cov_23e5opclmw().s[54]++;result.push({cardList:opponent.active,player:game_1.PlayerType.TOP_PLAYER});}else{cov_23e5opclmw().b[14][1]++;}cov_23e5opclmw().s[55]++;if((cov_23e5opclmw().b[17][0]++,hasPlayer)&&(cov_23e5opclmw().b[17][1]++,hasActive)){cov_23e5opclmw().b[16][0]++;cov_23e5opclmw().s[56]++;result.push({cardList:player.active,player:game_1.PlayerType.BOTTOM_PLAYER});}else{cov_23e5opclmw().b[16][1]++;}cov_23e5opclmw().s[57]++;if((cov_23e5opclmw().b[19][0]++,hasPlayer)&&(cov_23e5opclmw().b[19][1]++,hasBench)){cov_23e5opclmw().b[18][0]++;cov_23e5opclmw().s[58]++;player.bench.filter(b=>{cov_23e5opclmw().f[10]++;cov_23e5opclmw().s[59]++;return b.cards.length;}).forEach(b=>{cov_23e5opclmw().f[11]++;cov_23e5opclmw().s[60]++;result.push({cardList:b,player:game_1.PlayerType.BOTTOM_PLAYER});});}else{cov_23e5opclmw().b[18][1]++;}const blocked=(cov_23e5opclmw().s[61]++,prompt.options.blocked.map(b=>{cov_23e5opclmw().f[12]++;cov_23e5opclmw().s[62]++;return game_1.StateUtils.getTarget(state,player,b);}));cov_23e5opclmw().s[63]++;result=result.filter(r=>{cov_23e5opclmw().f[13]++;cov_23e5opclmw().s[64]++;return!blocked.includes(r.cardList);});cov_23e5opclmw().s[65]++;return result;}}cov_23e5opclmw().s[66]++;exports.ChoosePokemonPromptResolver=ChoosePokemonPromptResolver;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL3NpbXBsZS1ib3QvcHJvbXB0LXJlc29sdmVyL2Nob29zZS1wb2tlbW9uLXByb21wdC1yZXNvbHZlci50cyIsInNvdXJjZXMiOlsiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL3NpbXBsZS1ib3QvcHJvbXB0LXJlc29sdmVyL2Nob29zZS1wb2tlbW9uLXByb21wdC1yZXNvbHZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxxQ0FDb0U7QUFDcEUsdURBQW1EO0FBQ25ELDBGQUFxRjtBQU9yRixNQUFhLDJCQUE0QixTQUFRLGdDQUFjO0lBRXRELGFBQWEsQ0FBQyxLQUFZLEVBQUUsTUFBYyxFQUFFLE1BQW1CO1FBQ3BFLElBQUksTUFBTSxZQUFZLDJDQUFtQixFQUFFO1lBQ3pDLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDdkQsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDbkQsT0FBTyxJQUFJLDBCQUFtQixDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDbkQ7SUFDSCxDQUFDO0lBRU8sZUFBZSxDQUFDLE1BQTJCLEVBQUUsUUFBMEI7UUFDN0UsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNoQyxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzFELE9BQU8sRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLEVBQUUsQ0FBQztRQUM1QyxDQUFDLENBQUMs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SyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDbkQsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLGlCQUFVLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztZQUNqRSxDQUFDLENBQUMsQ0FBQztTQUNKO1FBRUQsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsaUJBQVUsQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3hGLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQzNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7Q0FFRjtBQXRHRCxrRUFzR0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQbGF5ZXIsIFN0YXRlLCBBY3Rpb24sIFJlc29sdmVQcm9tcHRBY3Rpb24sIFByb21wdCwgUG9rZW1vbkNhcmRMaXN0LFxuICBQbGF5ZXJUeXBlLCBTbG90VHlwZSwgU3RhdGVVdGlscywgR2FtZU1lc3NhZ2UgfSBmcm9tICcuLi8uLi9nYW1lJztcbmltcG9ydCB7IFByb21wdFJlc29sdmVyIH0gZnJvbSAnLi9wcm9tcHQtcmVzb2x2ZXInO1xuaW1wb3J0IHsgQ2hvb3NlUG9rZW1vblByb21wdCB9IGZyb20gJy4uLy4uL2dhbWUvc3RvcmUvcHJvbXB0cy9jaG9vc2UtcG9rZW1vbi1wcm9tcHQnO1xuXG5pbnRlcmZhY2UgUGxheWVyQ2FyZExpc3Qge1xuICBjYXJkTGlzdDogUG9rZW1vbkNhcmRMaXN0O1xuICBwbGF5ZXI6IFBsYXllclR5cGU7XG59XG5cbmV4cG9ydCBjbGFzcyBDaG9vc2VQb2tlbW9uUHJvbXB0UmVzb2x2ZXIgZXh0ZW5kcyBQcm9tcHRSZXNvbHZlciB7XG5cbiAgcHVibGljIHJlc29sdmVQcm9tcHQoc3RhdGU6IFN0YXRlLCBwbGF5ZXI6IFBsYXllciwgcHJvbXB0OiBQcm9tcHQ8YW55Pik6IEFjdGlvbiB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKHByb21wdCBpbnN0YW5jZW9mIENob29zZVBva2Vtb25Qcm9tcHQpIHtcbiAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5idWlsZFBva2Vtb25Ub0Nob29zZShzdGF0ZSwgcHJvbXB0KTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZ2V0UHJvbXB0UmVzdWx0KHByb21wdCwgaXRlbXMpO1xuICAgICAgcmV0dXJuIG5ldyBSZXNvbHZlUHJvbXB0QWN0aW9uKHByb21wdC5pZCwgcmVzdWx0KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFByb21wdFJlc3VsdChwcm9tcHQ6IENob29zZVBva2Vtb25Qcm9tcHQsIHBva2Vtb25zOiBQbGF5ZXJDYXJkTGlzdFtdKTogUG9rZW1vbkNhcmRMaXN0W10gfCBudWxsIHtcbiAgICBjb25zdCBpdGVtcyA9IHBva2Vtb25zLm1hcChpdGVtID0+IHtcbiAgICAgIGNvbnN0IHNjb3JlID0gdGhpcy5nZXRQb2tlbW9uU2NvcmVGb3JQcm9tcHQocHJvbXB0LCBpdGVtKTtcbiAgICAgIHJldHVybiB7IGNhcmRMaXN0OiBpdGVtLmNhcmRMaXN0LCBzY29yZSB9O1xuICAgIH0pO1xuICAgIGl0ZW1zLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKTtcblxuICAgIGNvbnN0IHJlc3VsdDogUG9rZW1vbkNhcmRMaXN0W10gPSBbXTtcbiAgICBjb25zdCBtaW4gPSBwcm9tcHQub3B0aW9ucy5taW47XG4gICAgY29uc3QgbWF4ID0gcHJvbXB0Lm9wdGlvbnMubWF4O1xuICAgIGxldCBzY29yZSA9IDA7XG5cbiAgICB3aGlsZSAoaXRlbXMubGVuZ3RoID4gMCAmJiAoaXRlbXNbMF0uc2NvcmUgPiAwIHx8IHJlc3VsdC5sZW5ndGggPCBtaW4pKSB7XG4gICAgICBjb25zdCBpdGVtID0gaXRlbXMuc2hpZnQoKTtcbiAgICAgIGlmIChpdGVtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZXN1bHQucHVzaChpdGVtLmNhcmRMaXN0KTtcbiAgICAgIHNjb3JlICs9IGl0ZW0uc2NvcmU7XG5cbiAgICAgIGlmIChyZXN1bHQubGVuZ3RoID49IG1heCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMCAmJiBwcm9tcHQub3B0aW9ucy5hbGxvd0NhbmNlbCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKHNjb3JlIDwgMCAmJiBwcm9tcHQub3B0aW9ucy5hbGxvd0NhbmNlbCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UG9rZW1vblNjb3JlRm9yUHJvbXB0KHByb21wdDogQ2hvb3NlUG9rZW1vblByb21wdCwgaXRlbTogUGxheWVyQ2FyZExpc3QpOiBudW1iZXIge1xuICAgIGxldCBzY29yZSA9IHRoaXMuc3RhdGVTY29yZS5nZXRQb2tlbW9uU2NvcmUoaXRlbS5jYXJkTGlzdCk7XG5cbiAgICBpZiAoaXRlbS5wbGF5ZXIgPT09IFBsYXllclR5cGUuVE9QX1BMQVlFUikge1xuICAgICAgc2NvcmUgPSAtc2NvcmU7XG4gICAgfVxuXG4gICAgLy8gcmV2ZXJzZSBtZXNzYWdlc1xuICAgIGNvbnN0IHdlYWtlc3RNZXNzYWdlczogR2FtZU1lc3NhZ2VbXSA9IFtcbiAgICAgIEdhbWVNZXNzYWdlLkNIT09TRV9QT0tFTU9OX1RPX0RBTUFHRSxcbiAgICAgIEdhbWVNZXNzYWdlLkNIT09TRV9QT0tFTU9OX1RPX0RJU0NBUkQsXG4gICAgICBHYW1lTWVzc2FnZS5DSE9PU0VfUE9LRU1PTl9UT19ESVNDQVJEX0NBUkRTLFxuICAgICAgR2FtZU1lc3NhZ2UuQ0hPT1NFX1BPS0VNT05fVE9fUElDS19VUFxuICAgIF07XG5cbiAgICBpZiAod2Vha2VzdE1lc3NhZ2VzLmluY2x1ZGVzKHByb21wdC5tZXNzYWdlKSkge1xuICAgICAgc2NvcmUgPSAtc2NvcmU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNjb3JlO1xuICB9XG5cbiAgcHJpdmF0ZSBidWlsZFBva2Vtb25Ub0Nob29zZShzdGF0ZTogU3RhdGUsIHByb21wdDogQ2hvb3NlUG9rZW1vblByb21wdCk6IFBsYXllckNhcmRMaXN0W10ge1xuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHByb21wdC5wbGF5ZXJJZCk7XG4gICAgY29uc3Qgb3Bwb25lbnQgPSBzdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwLmlkICE9PSBwcm9tcHQucGxheWVySWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCB8fCBvcHBvbmVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGNvbnN0IGhhc09wcG9uZW50ID0gW1BsYXllclR5cGUuVE9QX1BMQVlFUiwgUGxheWVyVHlwZS5BTlldLmluY2x1ZGVzKHByb21wdC5wbGF5ZXJUeXBlKTtcbiAgICBjb25zdCBoYXNQbGF5ZXIgPSBbUGxheWVyVHlwZS5CT1RUT01fUExBWUVSLCBQbGF5ZXJUeXBlLkFOWV0uaW5jbHVkZXMocHJvbXB0LnBsYXllclR5cGUpO1xuICAgIGNvbnN0IGhhc0JlbmNoID0gcHJvbXB0LnNsb3RzLmluY2x1ZGVzKFNsb3RUeXBlLkJFTkNIKTtcbiAgICBjb25zdCBoYXNBY3RpdmUgPSBwcm9tcHQuc2xvdHMuaW5jbHVkZXMoU2xvdFR5cGUuQUNUSVZFKTtcblxuICAgIGxldCByZXN1bHQ6IFBsYXllckNhcmRMaXN0W10gPSBbXTtcbiAgICBpZiAoaGFzT3Bwb25lbnQgJiYgaGFzQmVuY2gpIHtcbiAgICAgIG9wcG9uZW50LmJlbmNoLmZpbHRlcihiID0+IGIuY2FyZHMubGVuZ3RoKS5mb3JFYWNoKGIgPT4ge1xuICAgICAgICByZXN1bHQucHVzaCh7IGNhcmRMaXN0OiBiLCBwbGF5ZXI6IFBsYXllclR5cGUuVE9QX1BMQVlFUiB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaGFzT3Bwb25lbnQgJiYgaGFzQWN0aXZlKSB7XG4gICAgICByZXN1bHQucHVzaCh7IGNhcmRMaXN0OiBvcHBvbmVudC5hY3RpdmUsIHBsYXllcjogUGxheWVyVHlwZS5UT1BfUExBWUVSIH0pO1xuICAgIH1cbiAgICBpZiAoaGFzUGxheWVyICYmIGhhc0FjdGl2ZSkge1xuICAgICAgcmVzdWx0LnB1c2goeyBjYXJkTGlzdDogcGxheWVyLmFjdGl2ZSwgcGxheWVyOiBQbGF5ZXJUeXBlLkJPVFRPTV9QTEFZRVIgfSk7XG4gICAgfVxuICAgIGlmIChoYXNQbGF5ZXIgJiYgaGFzQmVuY2gpIHtcbiAgICAgIHBsYXllci5iZW5jaC5maWx0ZXIoYiA9PiBiLmNhcmRzLmxlbmd0aCkuZm9yRWFjaChiID0+IHtcbiAgICAgICAgcmVzdWx0LnB1c2goeyBjYXJkTGlzdDogYiwgcGxheWVyOiBQbGF5ZXJUeXBlLkJPVFRPTV9QTEFZRVIgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBibG9ja2VkID0gcHJvbXB0Lm9wdGlvbnMuYmxvY2tlZC5tYXAoYiA9PiBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCBiKSk7XG4gICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcihyID0+ICFibG9ja2VkLmluY2x1ZGVzKHIuY2FyZExpc3QpKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9zaW1wbGUtYm90L3Byb21wdC1yZXNvbHZlci9jaG9vc2UtcG9rZW1vbi1wcm9tcHQtcmVzb2x2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IisybEJBcUJJOytPQXJCSixLQUFBLENBQUEsTUFBQSwwQkFBQSxPQUFBLENBQUEsWUFBQSxDQUFBLENBQUEsQ0FFQSxLQUFBLENBQUEsaUJBQUEsMEJBQUEsT0FBQSxDQUFBLG1CQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSx1QkFBQSwwQkFBQSxPQUFBLENBQUEsZ0RBQUEsQ0FBQSxDQUFBLENBT0EsS0FBYSxDQUFBLDJCQUFiLFNBQWlELGlCQUFBLENBQUEsY0FBakQsQ0FBK0QsQ0FFdEQsYUFBYSxDQUFDLEtBQUQsQ0FBZSxNQUFmLENBQStCLE1BQS9CLENBQWtELGlEQUNwRSxHQUFJLE1BQU0sV0FBWSxDQUFBLHVCQUFBLENBQUEsbUJBQXRCLENBQTJDLDRCQUN6QyxLQUFNLENBQUEsS0FBSywwQkFBRyxLQUFLLG9CQUFMLENBQTBCLEtBQTFCLENBQWlDLE1BQWpDLENBQUgsQ0FBWCxDQUNBLEtBQU0sQ0FBQSxNQUFNLDBCQUFHLEtBQUssZUFBTCxDQUFxQixNQUFyQixDQUE2QixLQUE3QixDQUFILENBQVosQ0FGeUMsd0JBR3pDLE1BQU8sSUFBSSxDQUFBLE1BQUEsQ0FBQSxtQkFBSixDQUF3QixNQUFNLENBQUMsRUFBL0IsQ0FBbUMsTUFBbkMsQ0FBUCxDQUNELENBSkQsaUNBS0QsQ0FFTyxlQUFlLENBQUMsTUFBRCxDQUE4QixRQUE5QixDQUF3RCx5QkFDN0UsS0FBTSxDQUFBLEtBQUssMEJBQUcsUUFBUSxDQUFDLEdBQVQsQ0FBYSxJQUFJLEVBQUcseUJBQ2hDLEtBQU0sQ0FBQSxLQUFLLDJCQUFHLEtBQUssd0JBQUwsQ0FBOEIsTUFBOUIsQ0FBc0MsSUFBdEMsQ0FBSCxD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QXBDLEVBQXNDLENBQXRFLENBQUgsQ0FBYixDQTdCb0UseUJBOEJwRSxNQUFNLENBQUcsTUFBTSxDQUFDLE1BQVAsQ0FBYyxDQUFDLEVBQUksMERBQUMsT0FBTyxDQUFDLFFBQVIsQ0FBaUIsQ0FBQyxDQUFDLFFBQW5CLENBQUQsQ0FBNkIsQ0FBaEQsQ0FBVCxDQTlCb0UseUJBK0JwRSxNQUFPLENBQUEsTUFBUCxDQUNELENBcEc0RCxDLHlCQUEvRCxPQUFBLENBQUEsMkJBQUEsQ0FBQSwyQkFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGxheWVyLCBTdGF0ZSwgQWN0aW9uLCBSZXNvbHZlUHJvbXB0QWN0aW9uLCBQcm9tcHQsIFBva2Vtb25DYXJkTGlzdCxcbiAgUGxheWVyVHlwZSwgU2xvdFR5cGUsIFN0YXRlVXRpbHMsIEdhbWVNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZ2FtZSc7XG5pbXBvcnQgeyBQcm9tcHRSZXNvbHZlciB9IGZyb20gJy4vcHJvbXB0LXJlc29sdmVyJztcbmltcG9ydCB7IENob29zZVBva2Vtb25Qcm9tcHQgfSBmcm9tICcuLi8uLi9nYW1lL3N0b3JlL3Byb21wdHMvY2hvb3NlLXBva2Vtb24tcHJvbXB0JztcblxuaW50ZXJmYWNlIFBsYXllckNhcmRMaXN0IHtcbiAgY2FyZExpc3Q6IFBva2Vtb25DYXJkTGlzdDtcbiAgcGxheWVyOiBQbGF5ZXJUeXBlO1xufVxuXG5leHBvcnQgY2xhc3MgQ2hvb3NlUG9rZW1vblByb21wdFJlc29sdmVyIGV4dGVuZHMgUHJvbXB0UmVzb2x2ZXIge1xuXG4gIHB1YmxpYyByZXNvbHZlUHJvbXB0KHN0YXRlOiBTdGF0ZSwgcGxheWVyOiBQbGF5ZXIsIHByb21wdDogUHJvbXB0PGFueT4pOiBBY3Rpb24gfCB1bmRlZmluZWQge1xuICAgIGlmIChwcm9tcHQgaW5zdGFuY2VvZiBDaG9vc2VQb2tlbW9uUHJvbXB0KSB7XG4gICAgICBjb25zdCBpdGVtcyA9IHRoaXMuYnVpbGRQb2tlbW9uVG9DaG9vc2Uoc3RhdGUsIHByb21wdCk7XG4gICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmdldFByb21wdFJlc3VsdChwcm9tcHQsIGl0ZW1zKTtcbiAgICAgIHJldHVybiBuZXcgUmVzb2x2ZVByb21wdEFjdGlvbihwcm9tcHQuaWQsIHJlc3VsdCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRQcm9tcHRSZXN1bHQocHJvbXB0OiBDaG9vc2VQb2tlbW9uUHJvbXB0LCBwb2tlbW9uczogUGxheWVyQ2FyZExpc3RbXSk6IFBva2Vtb25DYXJkTGlzdFtdIHwgbnVsbCB7XG4gICAgY29uc3QgaXRlbXMgPSBwb2tlbW9ucy5tYXAoaXRlbSA9PiB7XG4gICAgICBjb25zdCBzY29yZSA9IHRoaXMuZ2V0UG9rZW1vblNjb3JlRm9yUHJvbXB0KHByb21wdCwgaXRlbSk7XG4gICAgICByZXR1cm4geyBjYXJkTGlzdDogaXRlbS5jYXJkTGlzdCwgc2NvcmUgfTtcbiAgICB9KTtcbiAgICBpdGVtcy5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSk7XG5cbiAgICBjb25zdCByZXN1bHQ6IFBva2Vtb25DYXJkTGlzdFtdID0gW107XG4gICAgY29uc3QgbWluID0gcHJvbXB0Lm9wdGlvbnMubWluO1xuICAgIGNvbnN0IG1heCA9IHByb21wdC5vcHRpb25zLm1heDtcbiAgICBsZXQgc2NvcmUgPSAwO1xuXG4gICAgd2hpbGUgKGl0ZW1zLmxlbmd0aCA+IDAgJiYgKGl0ZW1zWzBdLnNjb3JlID4gMCB8fCByZXN1bHQubGVuZ3RoIDwgbWluKSkge1xuICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zLnNoaWZ0KCk7XG4gICAgICBpZiAoaXRlbSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVzdWx0LnB1c2goaXRlbS5jYXJkTGlzdCk7XG4gICAgICBzY29yZSArPSBpdGVtLnNjb3JlO1xuXG4gICAgICBpZiAocmVzdWx0Lmxlbmd0aCA+PSBtYXgpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDAgJiYgcHJvbXB0Lm9wdGlvbnMuYWxsb3dDYW5jZWwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmIChzY29yZSA8IDAgJiYgcHJvbXB0Lm9wdGlvbnMuYWxsb3dDYW5jZWwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwcml2YXRlIGdldFBva2Vtb25TY29yZUZvclByb21wdChwcm9tcHQ6IENob29zZVBva2Vtb25Qcm9tcHQsIGl0ZW06IFBsYXllckNhcmRMaXN0KTogbnVtYmVyIHtcbiAgICBsZXQgc2NvcmUgPSB0aGlzLnN0YXRlU2NvcmUuZ2V0UG9rZW1vblNjb3JlKGl0ZW0uY2FyZExpc3QpO1xuXG4gICAgaWYgKGl0ZW0ucGxheWVyID09PSBQbGF5ZXJUeXBlLlRPUF9QTEFZRVIpIHtcbiAgICAgIHNjb3JlID0gLXNjb3JlO1xuICAgIH1cblxuICAgIC8vIHJldmVyc2UgbWVzc2FnZXNcbiAgICBjb25zdCB3ZWFrZXN0TWVzc2FnZXM6IEdhbWVNZXNzYWdlW10gPSBbXG4gICAgICBHYW1lTWVzc2FnZS5DSE9PU0VfUE9LRU1PTl9UT19EQU1BR0UsXG4gICAgICBHYW1lTWVzc2FnZS5DSE9PU0VfUE9LRU1PTl9UT19ESVNDQVJELFxuICAgICAgR2FtZU1lc3NhZ2UuQ0hPT1NFX1BPS0VNT05fVE9fRElTQ0FSRF9DQVJEUyxcbiAgICAgIEdhbWVNZXNzYWdlLkNIT09TRV9QT0tFTU9OX1RPX1BJQ0tfVVBcbiAgICBdO1xuXG4gICAgaWYgKHdlYWtlc3RNZXNzYWdlcy5pbmNsdWRlcyhwcm9tcHQubWVzc2FnZSkpIHtcbiAgICAgIHNjb3JlID0gLXNjb3JlO1xuICAgIH1cblxuICAgIHJldHVybiBzY29yZTtcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRQb2tlbW9uVG9DaG9vc2Uoc3RhdGU6IFN0YXRlLCBwcm9tcHQ6IENob29zZVBva2Vtb25Qcm9tcHQpOiBQbGF5ZXJDYXJkTGlzdFtdIHtcbiAgICBjb25zdCBwbGF5ZXIgPSBzdGF0ZS5wbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBwcm9tcHQucGxheWVySWQpO1xuICAgIGNvbnN0IG9wcG9uZW50ID0gc3RhdGUucGxheWVycy5maW5kKHAgPT4gcC5pZCAhPT0gcHJvbXB0LnBsYXllcklkKTtcbiAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQgfHwgb3Bwb25lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBoYXNPcHBvbmVudCA9IFtQbGF5ZXJUeXBlLlRPUF9QTEFZRVIsIFBsYXllclR5cGUuQU5ZXS5pbmNsdWRlcyhwcm9tcHQucGxheWVyVHlwZSk7XG4gICAgY29uc3QgaGFzUGxheWVyID0gW1BsYXllclR5cGUuQk9UVE9NX1BMQVlFUiwgUGxheWVyVHlwZS5BTlldLmluY2x1ZGVzKHByb21wdC5wbGF5ZXJUeXBlKTtcbiAgICBjb25zdCBoYXNCZW5jaCA9IHByb21wdC5zbG90cy5pbmNsdWRlcyhTbG90VHlwZS5CRU5DSCk7XG4gICAgY29uc3QgaGFzQWN0aXZlID0gcHJvbXB0LnNsb3RzLmluY2x1ZGVzKFNsb3RUeXBlLkFDVElWRSk7XG5cbiAgICBsZXQgcmVzdWx0OiBQbGF5ZXJDYXJkTGlzdFtdID0gW107XG4gICAgaWYgKGhhc09wcG9uZW50ICYmIGhhc0JlbmNoKSB7XG4gICAgICBvcHBvbmVudC5iZW5jaC5maWx0ZXIoYiA9PiBiLmNhcmRzLmxlbmd0aCkuZm9yRWFjaChiID0+IHtcbiAgICAgICAgcmVzdWx0LnB1c2goeyBjYXJkTGlzdDogYiwgcGxheWVyOiBQbGF5ZXJUeXBlLlRPUF9QTEFZRVIgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGhhc09wcG9uZW50ICYmIGhhc0FjdGl2ZSkge1xuICAgICAgcmVzdWx0LnB1c2goeyBjYXJkTGlzdDogb3Bwb25lbnQuYWN0aXZlLCBwbGF5ZXI6IFBsYXllclR5cGUuVE9QX1BMQVlFUiB9KTtcbiAgICB9XG4gICAgaWYgKGhhc1BsYXllciAmJiBoYXNBY3RpdmUpIHtcbiAgICAgIHJlc3VsdC5wdXNoKHsgY2FyZExpc3Q6IHBsYXllci5hY3RpdmUsIHBsYXllcjogUGxheWVyVHlwZS5CT1RUT01fUExBWUVSIH0pO1xuICAgIH1cbiAgICBpZiAoaGFzUGxheWVyICYmIGhhc0JlbmNoKSB7XG4gICAgICBwbGF5ZXIuYmVuY2guZmlsdGVyKGIgPT4gYi5jYXJkcy5sZW5ndGgpLmZvckVhY2goYiA9PiB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHsgY2FyZExpc3Q6IGIsIHBsYXllcjogUGxheWVyVHlwZS5CT1RUT01fUExBWUVSIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgYmxvY2tlZCA9IHByb21wdC5vcHRpb25zLmJsb2NrZWQubWFwKGIgPT4gU3RhdGVVdGlscy5nZXRUYXJnZXQoc3RhdGUsIHBsYXllciwgYikpO1xuICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIociA9PiAhYmxvY2tlZC5pbmNsdWRlcyhyLmNhcmRMaXN0KSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG59XG4iXX0=