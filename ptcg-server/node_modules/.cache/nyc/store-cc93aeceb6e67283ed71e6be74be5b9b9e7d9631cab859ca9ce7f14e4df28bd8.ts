"use strict";function cov_2bhgcm60jl(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/store.ts";var hash="6d4855e7ff0f82a391fbf06332880a09bb2f465b";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/store.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:23}},"2":{start:{line:4,column:28},end:{line:4,column:66}},"3":{start:{line:5,column:28},end:{line:5,column:66}},"4":{start:{line:6,column:15},end:{line:6,column:37}},"5":{start:{line:7,column:31},end:{line:7,column:72}},"6":{start:{line:8,column:21},end:{line:8,column:45}},"7":{start:{line:9,column:23},end:{line:9,column:49}},"8":{start:{line:10,column:26},end:{line:10,column:62}},"9":{start:{line:11,column:32},end:{line:11,column:74}},"10":{start:{line:12,column:16},end:{line:12,column:40}},"11":{start:{line:13,column:20},end:{line:13,column:48}},"12":{start:{line:14,column:16},end:{line:14,column:44}},"13":{start:{line:15,column:24},end:{line:15,column:66}},"14":{start:{line:16,column:28},end:{line:16,column:67}},"15":{start:{line:17,column:29},end:{line:17,column:76}},"16":{start:{line:18,column:30},end:{line:18,column:78}},"17":{start:{line:19,column:30},end:{line:19,column:78}},"18":{start:{line:20,column:30},end:{line:20,column:71}},"19":{start:{line:21,column:28},end:{line:21,column:74}},"20":{start:{line:22,column:22},end:{line:22,column:62}},"21":{start:{line:23,column:23},end:{line:23,column:64}},"22":{start:{line:24,column:31},end:{line:24,column:73}},"23":{start:{line:25,column:25},end:{line:25,column:68}},"24":{start:{line:26,column:24},end:{line:26,column:59}},"25":{start:{line:27,column:29},end:{line:27,column:69}},"26":{start:{line:30,column:8},end:{line:30,column:31}},"27":{start:{line:31,column:8},end:{line:31,column:41}},"28":{start:{line:32,column:8},end:{line:32,column:30}},"29":{start:{line:33,column:8},end:{line:33,column:28}},"30":{start:{line:34,column:8},end:{line:34,column:23}},"31":{start:{line:37,column:20},end:{line:37,column:30}},"32":{start:{line:38,column:8},end:{line:42,column:9}},"33":{start:{line:39,column:12},end:{line:39,column:79}},"34":{start:{line:40,column:12},end:{line:40,column:46}},"35":{start:{line:41,column:12},end:{line:41,column:25}},"36":{start:{line:43,column:8},end:{line:49,column:9}},"37":{start:{line:46,column:12},end:{line:46,column:83}},"38":{start:{line:47,column:12},end:{line:47,column:46}},"39":{start:{line:48,column:12},end:{line:48,column:25}},"40":{start:{line:50,column:8},end:{line:57,column:9}},"41":{start:{line:51,column:12},end:{line:51,column:53}},"42":{start:{line:52,column:12},end:{line:54,column:13}},"43":{start:{line:53,column:16},end:{line:53,column:63}},"44":{start:{line:55,column:12},end:{line:55,column:46}},"45":{start:{line:56,column:12},end:{line:56,column:25}},"46":{start:{line:58,column:8},end:{line:62,column:9}},"47":{start:{line:59,column:12},end:{line:59,column:70}},"48":{start:{line:60,column:12},end:{line:60,column:46}},"49":{start:{line:61,column:12},end:{line:61,column:25}},"50":{start:{line:63,column:8},end:{line:65,column:9}},"51":{start:{line:63,column:36},end:{line:63,column:58}},"52":{start:{line:64,column:12},end:{line:64,column:92}},"53":{start:{line:66,column:8},end:{line:66,column:43}},"54":{start:{line:67,column:8},end:{line:67,column:21}},"55":{start:{line:70,column:8},end:{line:70,column:52}},"56":{start:{line:71,column:8},end:{line:73,column:9}},"57":{start:{line:72,column:12},end:{line:72,column:25}},"58":{start:{line:74,column:8},end:{line:74,column:74}},"59":{start:{line:75,column:8},end:{line:75,column:76}},"60":{start:{line:76,column:8},end:{line:76,column:78}},"61":{start:{line:77,column:8},end:{line:77,column:78}},"62":{start:{line:78,column:8},end:{line:78,column:69}},"63":{start:{line:79,column:8},end:{line:79,column:63}},"64":{start:{line:80,column:8},end:{line:80,column:67}},"65":{start:{line:81,column:8},end:{line:81,column:70}},"66":{start:{line:82,column:8},end:{line:82,column:21}},"67":{start:{line:85,column:8},end:{line:87,column:9}},"68":{start:{line:86,column:12},end:{line:86,column:32}},"69":{start:{line:88,column:8},end:{line:92,column:9}},"70":{start:{line:88,column:21},end:{line:88,column:22}},"71":{start:{line:89,column:23},end:{line:89,column:56}},"72":{start:{line:90,column:12},end:{line:90,column:31}},"73":{start:{line:91,column:12},end:{line:91,column:43}},"74":{start:{line:93,column:27},end:{line:96,column:9}},"75":{start:{line:94,column:39},end:{line:94,column:48}},"76":{start:{line:97,column:8},end:{line:97,column:42}},"77":{start:{line:98,column:8},end:{line:98,column:21}},"78":{start:{line:101,column:8},end:{line:101,column:38}},"79":{start:{line:102,column:8},end:{line:102,column:21}},"80":{start:{line:105,column:20},end:{line:105,column:69}},"81":{start:{line:106,column:8},end:{line:106,column:30}},"82":{start:{line:107,column:8},end:{line:107,column:29}},"83":{start:{line:111,column:23},end:{line:111,column:72}},"84":{start:{line:111,column:50},end:{line:111,column:71}},"85":{start:{line:112,column:27},end:{line:112,column:92}},"86":{start:{line:112,column:57},end:{line:112,column:91}},"87":{start:{line:113,column:8},end:{line:115,column:9}},"88":{start:{line:114,column:12},end:{line:114,column:88}},"89":{start:{line:116,column:8},end:{line:118,column:9}},"90":{start:{line:117,column:12},end:{line:117,column:97}},"91":{start:{line:119,column:8},end:{line:139,column:9}},"92":{start:{line:120,column:12},end:{line:120,column:42}},"93":{start:{line:121,column:28},end:{line:124,column:14}},"94":{start:{line:122,column:26},end:{line:122,column:68}},"95":{start:{line:122,column:53},end:{line:122,column:67}},"96":{start:{line:123,column:16},end:{line:123,column:62}},"97":{start:{line:125,column:12},end:{line:127,column:13}},"98":{start:{line:126,column:16},end:{line:126,column:90}},"99":{start:{line:128,column:12},end:{line:132,column:13}},"100":{start:{line:128,column:40},end:{line:128,column:60}},"101":{start:{line:129,column:34},end:{line:129,column:70}},"102":{start:{line:130,column:16},end:{line:130,column:77}},"103":{start:{line:131,column:16},end:{line:131,column:54}},"104":{start:{line:133,column:12},end:{line:133,column:36}},"105":{start:{line:137,column:12},end:{line:137,column:38}},"106":{start:{line:138,column:12},end:{line:138,column:29}},"107":{start:{line:140,column:8},end:{line:140,column:21}},"108":{start:{line:143,column:8},end:{line:148,column:9}},"109":{start:{line:144,column:29},end:{line:144,column:49}},"110":{start:{line:145,column:12},end:{line:147,column:13}},"111":{start:{line:146,column:16},end:{line:146,column:27}},"112":{start:{line:151,column:8},end:{line:151,column:43}},"113":{start:{line:154,column:28},end:{line:154,column:67}},"114":{start:{line:155,column:8},end:{line:155,column:36}},"115":{start:{line:156,column:8},end:{line:170,column:9}},"116":{start:{line:157,column:12},end:{line:157,column:75}},"117":{start:{line:158,column:12},end:{line:158,column:77}},"118":{start:{line:159,column:12},end:{line:159,column:81}},"119":{start:{line:160,column:12},end:{line:160,column:36}},"120":{start:{line:161,column:12},end:{line:163,column:13}},"121":{start:{line:162,column:16},end:{line:162,column:63}},"122":{start:{line:167,column:12},end:{line:167,column:37}},"123":{start:{line:168,column:12},end:{line:168,column:40}},"124":{start:{line:169,column:12},end:{line:169,column:29}},"125":{start:{line:171,column:8},end:{line:171,column:42}},"126":{start:{line:172,column:8},end:{line:172,column:21}},"127":{start:{line:175,column:22},end:{line:175,column:24}},"128":{start:{line:176,column:8},end:{line:189,column:9}},"129":{start:{line:177,column:12},end:{line:177,column:61}},"130":{start:{line:177,column:46},end:{line:177,column:59}},"131":{start:{line:178,column:12},end:{line:178,column:63}},"132":{start:{line:178,column:48},end:{line:178,column:61}},"133":{start:{line:179,column:12},end:{line:179,column:60}},"134":{start:{line:179,column:45},end:{line:179,column:58}},"135":{start:{line:180,column:12},end:{line:182,column:13}},"136":{start:{line:181,column:16},end:{line:181,column:56}},"137":{start:{line:181,column:41},end:{line:181,column:54}},"138":{start:{line:183,column:12},end:{line:185,column:13}},"139":{start:{line:184,column:16},end:{line:184,column:56}},"140":{start:{line:184,column:41},end:{line:184,column:54}},"141":{start:{line:186,column:12},end:{line:186,column:58}},"142":{start:{line:186,column:43},end:{line:186,column:56}},"143":{start:{line:187,column:12},end:{line:187,column:58}},"144":{start:{line:187,column:43},end:{line:187,column:56}},"145":{start:{line:188,column:12},end:{line:188,column:61}},"146":{start:{line:188,column:46},end:{line:188,column:59}},"147":{start:{line:190,column:8},end:{line:190,column:37}},"148":{start:{line:190,column:24},end:{line:190,column:35}},"149":{start:{line:191,column:8},end:{line:191,column:77}},"150":{start:{line:191,column:29},end:{line:191,column:73}},"151":{start:{line:192,column:8},end:{line:192,column:21}},"152":{start:{line:195,column:0},end:{line:195,column:22}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:29,column:4},end:{line:29,column:5}},loc:{start:{line:29,column:25},end:{line:35,column:5}},line:29},"1":{name:"(anonymous_1)",decl:{start:{line:36,column:4},end:{line:36,column:5}},loc:{start:{line:36,column:21},end:{line:68,column:5}},line:36},"2":{name:"(anonymous_2)",decl:{start:{line:63,column:31},end:{line:63,column:32}},loc:{start:{line:63,column:36},end:{line:63,column:58}},line:63},"3":{name:"(anonymous_3)",decl:{start:{line:69,column:4},end:{line:69,column:5}},loc:{start:{line:69,column:32},end:{line:83,column:5}},line:69},"4":{name:"(anonymous_4)",decl:{start:{line:84,column:4},end:{line:84,column:5}},loc:{start:{line:84,column:33},end:{line:99,column:5}},line:84},"5":{name:"(anonymous_5)",decl:{start:{line:94,column:29},end:{line:94,column:30}},loc:{start:{line:94,column:39},end:{line:94,column:48}},line:94},"6":{name:"(anonymous_6)",decl:{start:{line:100,column:4},end:{line:100,column:5}},loc:{start:{line:100,column:32},end:{line:103,column:5}},line:100},"7":{name:"(anonymous_7)",decl:{start:{line:104,column:4},end:{line:104,column:5}},loc:{start:{line:104,column:40},end:{line:108,column:5}},line:104},"8":{name:"(anonymous_8)",decl:{start:{line:109,column:4},end:{line:109,column:5}},loc:{start:{line:109,column:32},end:{line:141,column:5}},line:109},"9":{name:"(anonymous_9)",decl:{start:{line:111,column:42},end:{line:111,column:43}},loc:{start:{line:111,column:50},end:{line:111,column:71}},line:111},"10":{name:"(anonymous_10)",decl:{start:{line:112,column:49},end:{line:112,column:50}},loc:{start:{line:112,column:57},end:{line:112,column:91}},line:112},"11":{name:"(anonymous_11)",decl:{start:{line:121,column:47},end:{line:121,column:48}},loc:{start:{line:121,column:53},end:{line:124,column:13}},line:121},"12":{name:"(anonymous_12)",decl:{start:{line:122,column:45},end:{line:122,column:46}},loc:{start:{line:122,column:53},end:{line:122,column:67}},line:122},"13":{name:"(anonymous_13)",decl:{start:{line:128,column:30},end:{line:128,column:31}},loc:{start:{line:128,column:40},end:{line:128,column:60}},line:128},"14":{name:"(anonymous_14)",decl:{start:{line:142,column:4},end:{line:142,column:5}},loc:{start:{line:142,column:23},end:{line:149,column:5}},line:142},"15":{name:"(anonymous_15)",decl:{start:{line:150,column:4},end:{line:150,column:5}},loc:{start:{line:150,column:17},end:{line:152,column:5}},line:150},"16":{name:"(anonymous_16)",decl:{start:{line:153,column:4},end:{line:153,column:5}},loc:{start:{line:153,column:26},end:{line:173,column:5}},line:153},"17":{name:"(anonymous_17)",decl:{start:{line:174,column:4},end:{line:174,column:5}},loc:{start:{line:174,column:35},end:{line:193,column:5}},line:174},"18":{name:"(anonymous_18)",decl:{start:{line:177,column:41},end:{line:177,column:42}},loc:{start:{line:177,column:46},end:{line:177,column:59}},line:177},"19":{name:"(anonymous_19)",decl:{start:{line:178,column:43},end:{line:178,column:44}},loc:{start:{line:178,column:48},end:{line:178,column:61}},line:178},"20":{name:"(anonymous_20)",decl:{start:{line:179,column:40},end:{line:179,column:41}},loc:{start:{line:179,column:45},end:{line:179,column:58}},line:179},"21":{name:"(anonymous_21)",decl:{start:{line:181,column:36},end:{line:181,column:37}},loc:{start:{line:181,column:41},end:{line:181,column:54}},line:181},"22":{name:"(anonymous_22)",decl:{start:{line:184,column:36},end:{line:184,column:37}},loc:{start:{line:184,column:41},end:{line:184,column:54}},line:184},"23":{name:"(anonymous_23)",decl:{start:{line:186,column:38},end:{line:186,column:39}},loc:{start:{line:186,column:43},end:{line:186,column:56}},line:186},"24":{name:"(anonymous_24)",decl:{start:{line:187,column:38},end:{line:187,column:39}},loc:{start:{line:187,column:43},end:{line:187,column:56}},line:187},"25":{name:"(anonymous_25)",decl:{start:{line:188,column:41},end:{line:188,column:42}},loc:{start:{line:188,column:46},end:{line:188,column:59}},line:188},"26":{name:"(anonymous_26)",decl:{start:{line:190,column:19},end:{line:190,column:20}},loc:{start:{line:190,column:24},end:{line:190,column:35}},line:190},"27":{name:"(anonymous_27)",decl:{start:{line:191,column:22},end:{line:191,column:23}},loc:{start:{line:191,column:27},end:{line:191,column:75}},line:191}},branchMap:{"0":{loc:{start:{line:38,column:8},end:{line:42,column:9}},type:"if",locations:[{start:{line:38,column:8},end:{line:42,column:9}},{start:{line:38,column:8},end:{line:42,column:9}}],line:38},"1":{loc:{start:{line:43,column:8},end:{line:49,column:9}},type:"if",locations:[{start:{line:43,column:8},end:{line:49,column:9}},{start:{line:43,column:8},end:{line:49,column:9}}],line:43},"2":{loc:{start:{line:43,column:12},end:{line:45,column:74}},type:"binary-expr",locations:[{start:{line:43,column:12},end:{line:43,column:65}},{start:{line:44,column:15},end:{line:44,column:69}},{start:{line:45,column:15},end:{line:45,column:74}}],line:43},"3":{loc:{start:{line:50,column:8},end:{line:57,column:9}},type:"if",locations:[{start:{line:50,column:8},end:{line:57,column:9}},{start:{line:50,column:8},end:{line:57,column:9}}],line:50},"4":{loc:{start:{line:52,column:12},end:{line:54,column:13}},type:"if",locations:[{start:{line:52,column:12},end:{line:54,column:13}},{start:{line:52,column:12},end:{line:54,column:13}}],line:52},"5":{loc:{start:{line:58,column:8},end:{line:62,column:9}},type:"if",locations:[{start:{line:58,column:8},end:{line:62,column:9}},{start:{line:58,column:8},end:{line:62,column:9}}],line:58},"6":{loc:{start:{line:63,column:8},end:{line:65,column:9}},type:"if",locations:[{start:{line:63,column:8},end:{line:65,column:9}},{start:{line:63,column:8},end:{line:65,column:9}}],line:63},"7":{loc:{start:{line:71,column:8},end:{line:73,column:9}},type:"if",locations:[{start:{line:71,column:8},end:{line:73,column:9}},{start:{line:71,column:8},end:{line:73,column:9}}],line:71},"8":{loc:{start:{line:85,column:8},end:{line:87,column:9}},type:"if",locations:[{start:{line:85,column:8},end:{line:87,column:9}},{start:{line:85,column:8},end:{line:87,column:9}}],line:85},"9":{loc:{start:{line:113,column:8},end:{line:115,column:9}},type:"if",locations:[{start:{line:113,column:8},end:{line:115,column:9}},{start:{line:113,column:8},end:{line:115,column:9}}],line:113},"10":{loc:{start:{line:113,column:12},end:{line:113,column:60}},type:"binary-expr",locations:[{start:{line:113,column:12},end:{line:113,column:32}},{start:{line:113,column:36},end:{line:113,column:60}}],line:113},"11":{loc:{start:{line:116,column:8},end:{line:118,column:9}},type:"if",locations:[{start:{line:116,column:8},end:{line:118,column:9}},{start:{line:116,column:8},end:{line:118,column:9}}],line:116},"12":{loc:{start:{line:123,column:23},end:{line:123,column:61}},type:"cond-expr",locations:[{start:{line:123,column:41},end:{line:123,column:50}},{start:{line:123,column:53},end:{line:123,column:61}}],line:123},"13":{loc:{start:{line:125,column:12},end:{line:127,column:13}},type:"if",locations:[{start:{line:125,column:12},end:{line:127,column:13}},{start:{line:125,column:12},end:{line:127,column:13}}],line:125},"14":{loc:{start:{line:128,column:12},end:{line:132,column:13}},type:"if",locations:[{start:{line:128,column:12},end:{line:132,column:13}},{start:{line:128,column:12},end:{line:132,column:13}}],line:128},"15":{loc:{start:{line:130,column:32},end:{line:130,column:75}},type:"cond-expr",locations:[{start:{line:130,column:55},end:{line:130,column:65}},{start:{line:130,column:68},end:{line:130,column:75}}],line:130},"16":{loc:{start:{line:143,column:15},end:{line:143,column:73}},type:"binary-expr",locations:[{start:{line:143,column:15},end:{line:143,column:44}},{start:{line:143,column:48},end:{line:143,column:73}}],line:143},"17":{loc:{start:{line:145,column:12},end:{line:147,column:13}},type:"if",locations:[{start:{line:145,column:12},end:{line:147,column:13}},{start:{line:145,column:12},end:{line:147,column:13}}],line:145},"18":{loc:{start:{line:161,column:12},end:{line:163,column:13}},type:"if",locations:[{start:{line:161,column:12},end:{line:163,column:13}},{start:{line:161,column:12},end:{line:163,column:13}}],line:161}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},b:{"0":[0,0],"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/store.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/store.ts"],names:[],mappings:"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",sourcesContent:["import { Action } from './actions/action';\nimport { AbortGameAction } from './actions/abort-game-action';\nimport { AppendLogAction } from './actions/append-log-action';\nimport { Card } from './card/card';\nimport { ChangeAvatarAction } from './actions/change-avatar-action';\nimport { Effect } from './effects/effect';\nimport { GameError } from '../game-error';\nimport { GameMessage, GameLog } from '../game-message';\nimport { Prompt } from './prompts/prompt';\nimport { ReorderHandAction, ReorderBenchAction } from './actions/reorder-actions';\nimport { ResolvePromptAction } from './actions/resolve-prompt-action';\nimport { State } from './state/state';\nimport { StateLog, StateLogParam } from './state/state-log';\nimport { StoreHandler } from './store-handler';\nimport { StoreLike } from './store-like';\nimport { generateId, deepClone } from '../../utils/utils';\nimport { attackReducer } from './effect-reducers/attack-effect';\nimport { playCardReducer } from './reducers/play-card-reducer';\nimport { playEnergyReducer } from './effect-reducers/play-energy-effect';\nimport { playPokemonReducer } from './effect-reducers/play-pokemon-effect';\nimport { playTrainerReducer } from './effect-reducers/play-trainer-effect';\nimport { playerTurnReducer } from './reducers/player-turn-reducer';\nimport { gamePhaseReducer } from './effect-reducers/game-phase-effect';\nimport { gameReducer } from './effect-reducers/game-effect';\nimport { checkState, checkStateReducer } from './effect-reducers/check-effect';\nimport { playerStateReducer} from './reducers/player-state-reducer';\nimport { retreatReducer } from './effect-reducers/retreat-effect';\nimport { setupPhaseReducer } from './reducers/setup-reducer';\nimport { abortGameReducer } from './reducers/abort-game-reducer';\n\ninterface PromptItem {\n  ids: number[],\n  then: (results: any) => void;\n}\n\nexport class Store implements StoreLike {\n\n  public state: State = new State();\n  private promptItems: PromptItem[] = [];\n  private waitItems: (() => void)[] = [];\n  private logId: number = 0;\n\n  constructor(private handler: StoreHandler) { }\n\n  public dispatch(action: Action): State {\n    let state = this.state;\n\n    if (action instanceof AbortGameAction) {\n      state = abortGameReducer(this, state, action);\n      this.handler.onStateChange(state);\n      return state;\n    }\n\n    if (action instanceof ReorderHandAction\n      || action instanceof ReorderBenchAction\n      || action instanceof ChangeAvatarAction) {\n      state = playerStateReducer(this, state, action);\n      this.handler.onStateChange(state);\n      return state;\n    }\n\n    if (action instanceof ResolvePromptAction) {\n      state = this.reducePrompt(state, action);\n      if (this.promptItems.length === 0) {\n        state = checkState(this, state);\n      }\n      this.handler.onStateChange(state);\n      return state;\n    }\n\n    if (action instanceof AppendLogAction) {\n      this.log(state, action.message, action.params, action.id);\n      this.handler.onStateChange(state);\n      return state;\n    }\n\n    if (state.prompts.some(p => p.result === undefined)) {\n      throw new GameError(GameMessage.ACTION_IN_PROGRESS);\n    }\n\n    state = this.reduce(state, action);\n\n    return state;\n  }\n\n  public reduceEffect(state: State, effect: Effect): State {\n    state = this.propagateEffect(state, effect);\n\n    if (effect.preventDefault === true) {\n      return state;\n    }\n\n    state = gamePhaseReducer(this, state, effect);\n    state = playEnergyReducer(this, state, effect);\n    state = playPokemonReducer(this, state, effect);\n    state = playTrainerReducer(this, state, effect);\n    state = retreatReducer(this, state, effect);\n    state = gameReducer(this, state, effect);\n    state = attackReducer(this, state, effect);\n    state = checkStateReducer(this, state, effect);\n\n    return state;\n  }\n\n  public prompt(state: State, prompts: Prompt<any>[] | Prompt<any>, then: (results: any) => void): State {\n    if (!(prompts instanceof Array)) {\n      prompts = [prompts];\n    }\n\n    for (let i = 0; i < prompts.length; i++) {\n      const id = generateId(state.prompts);\n      prompts[i].id = id;\n      state.prompts.push(prompts[i]);\n    }\n\n    const promptItem: PromptItem = {\n      ids: prompts.map(prompt => prompt.id),\n      then: then\n    };\n\n    this.promptItems.push(promptItem);\n    return state;\n  }\n\n  public waitPrompt(state: State, callback: () => void): State {\n    this.waitItems.push(callback);\n    return state;\n  }\n\n  public log(state: State, message: GameLog, params?: StateLogParam, client?: number): void {\n    const log = new StateLog(message, params, client);\n    log.id = ++this.logId;\n    state.logs.push(log);\n  }\n\n  private reducePrompt(state: State, action: ResolvePromptAction): State {\n    // Resolve prompts actions\n    const prompt = state.prompts.find(item => item.id === action.id);\n    const promptItem = this.promptItems.find(item => item.ids.indexOf(action.id) !== -1);\n\n    if (prompt === undefined || promptItem === undefined) {\n      throw new GameError(GameMessage.ILLEGAL_ACTION);\n    }\n\n    if (prompt.result !== undefined) {\n      throw new GameError(GameMessage.PROMPT_ALREADY_RESOLVED);\n    }\n\n    try {\n      prompt.result = action.result;\n\n      const results = promptItem.ids.map(id => {\n        const p = state.prompts.find(item => item.id === id);\n        return p === undefined ? undefined : p.result;\n      });\n\n      if (action.log !== undefined) {\n        this.log(state, action.log.message, action.log.params, action.log.client);\n      }\n\n      if (results.every(result => result !== undefined)) {\n        const itemIndex = this.promptItems.indexOf(promptItem);\n        promptItem.then(results.length === 1 ? results[0] : results);\n        this.promptItems.splice(itemIndex, 1);\n      }\n\n      this.resolveWaitItems();\n    } catch (storeError) {\n      // Illegal action\n      prompt.result = undefined;\n      throw storeError;\n    }\n\n    return state;\n  }\n\n  private resolveWaitItems(): void {\n    while (this.promptItems.length === 0 && this.waitItems.length > 0) {\n      const waitItem = this.waitItems.pop();\n      if (waitItem !== undefined) {\n        waitItem();\n      }\n    }\n  }\n\n  public hasPrompts(): boolean {\n    return this.promptItems.length > 0;\n  }\n\n  private reduce(state: State, action: Action): State {\n    const stateBackup = deepClone(state, [ Card ]);\n    this.promptItems.length = 0;\n\n    try {\n      state = setupPhaseReducer(this, state, action);\n      state = playCardReducer(this, state, action);\n      state = playerTurnReducer(this, state, action);\n\n      this.resolveWaitItems();\n      if (this.promptItems.length === 0) {\n        state = checkState(this, state);\n      }\n    } catch (storeError) {\n      // Illegal action\n      this.state = stateBackup;\n      this.promptItems.length = 0;\n      throw storeError;\n    }\n\n    this.handler.onStateChange(state);\n    return state;\n  }\n\n  private propagateEffect(state: State, effect: Effect): State {\n    const cards: Card[] = [];\n    for (const player of state.players) {\n      player.stadium.cards.forEach(c => cards.push(c));\n      player.supporter.cards.forEach(c => cards.push(c));\n      player.active.cards.forEach(c => cards.push(c));\n      for (const bench of player.bench) {\n        bench.cards.forEach(c => cards.push(c));\n      }\n      for (const prize of player.prizes) {\n        prize.cards.forEach(c => cards.push(c));\n      }\n      player.hand.cards.forEach(c => cards.push(c));\n      player.deck.cards.forEach(c => cards.push(c));\n      player.discard.cards.forEach(c => cards.push(c));\n    }\n    cards.sort(c => c.superType);\n    cards.forEach(c => { state = c.reduceEffect(this, state, effect); });\n    return state;\n  }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6d4855e7ff0f82a391fbf06332880a09bb2f465b"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2bhgcm60jl=function(){return actualCoverage;};}return actualCoverage;}cov_2bhgcm60jl();cov_2bhgcm60jl().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_2bhgcm60jl().s[1]++;exports.Store=void 0;const abort_game_action_1=(cov_2bhgcm60jl().s[2]++,require("./actions/abort-game-action"));const append_log_action_1=(cov_2bhgcm60jl().s[3]++,require("./actions/append-log-action"));const card_1=(cov_2bhgcm60jl().s[4]++,require("./card/card"));const change_avatar_action_1=(cov_2bhgcm60jl().s[5]++,require("./actions/change-avatar-action"));const game_error_1=(cov_2bhgcm60jl().s[6]++,require("../game-error"));const game_message_1=(cov_2bhgcm60jl().s[7]++,require("../game-message"));const reorder_actions_1=(cov_2bhgcm60jl().s[8]++,require("./actions/reorder-actions"));const resolve_prompt_action_1=(cov_2bhgcm60jl().s[9]++,require("./actions/resolve-prompt-action"));const state_1=(cov_2bhgcm60jl().s[10]++,require("./state/state"));const state_log_1=(cov_2bhgcm60jl().s[11]++,require("./state/state-log"));const utils_1=(cov_2bhgcm60jl().s[12]++,require("../../utils/utils"));const attack_effect_1=(cov_2bhgcm60jl().s[13]++,require("./effect-reducers/attack-effect"));const play_card_reducer_1=(cov_2bhgcm60jl().s[14]++,require("./reducers/play-card-reducer"));const play_energy_effect_1=(cov_2bhgcm60jl().s[15]++,require("./effect-reducers/play-energy-effect"));const play_pokemon_effect_1=(cov_2bhgcm60jl().s[16]++,require("./effect-reducers/play-pokemon-effect"));const play_trainer_effect_1=(cov_2bhgcm60jl().s[17]++,require("./effect-reducers/play-trainer-effect"));const player_turn_reducer_1=(cov_2bhgcm60jl().s[18]++,require("./reducers/player-turn-reducer"));const game_phase_effect_1=(cov_2bhgcm60jl().s[19]++,require("./effect-reducers/game-phase-effect"));const game_effect_1=(cov_2bhgcm60jl().s[20]++,require("./effect-reducers/game-effect"));const check_effect_1=(cov_2bhgcm60jl().s[21]++,require("./effect-reducers/check-effect"));const player_state_reducer_1=(cov_2bhgcm60jl().s[22]++,require("./reducers/player-state-reducer"));const retreat_effect_1=(cov_2bhgcm60jl().s[23]++,require("./effect-reducers/retreat-effect"));const setup_reducer_1=(cov_2bhgcm60jl().s[24]++,require("./reducers/setup-reducer"));const abort_game_reducer_1=(cov_2bhgcm60jl().s[25]++,require("./reducers/abort-game-reducer"));class Store{constructor(handler){cov_2bhgcm60jl().f[0]++;cov_2bhgcm60jl().s[26]++;this.handler=handler;cov_2bhgcm60jl().s[27]++;this.state=new state_1.State();cov_2bhgcm60jl().s[28]++;this.promptItems=[];cov_2bhgcm60jl().s[29]++;this.waitItems=[];cov_2bhgcm60jl().s[30]++;this.logId=0;}dispatch(action){cov_2bhgcm60jl().f[1]++;let state=(cov_2bhgcm60jl().s[31]++,this.state);cov_2bhgcm60jl().s[32]++;if(action instanceof abort_game_action_1.AbortGameAction){cov_2bhgcm60jl().b[0][0]++;cov_2bhgcm60jl().s[33]++;state=abort_game_reducer_1.abortGameReducer(this,state,action);cov_2bhgcm60jl().s[34]++;this.handler.onStateChange(state);cov_2bhgcm60jl().s[35]++;return state;}else{cov_2bhgcm60jl().b[0][1]++;}cov_2bhgcm60jl().s[36]++;if((cov_2bhgcm60jl().b[2][0]++,action instanceof reorder_actions_1.ReorderHandAction)||(cov_2bhgcm60jl().b[2][1]++,action instanceof reorder_actions_1.ReorderBenchAction)||(cov_2bhgcm60jl().b[2][2]++,action instanceof change_avatar_action_1.ChangeAvatarAction)){cov_2bhgcm60jl().b[1][0]++;cov_2bhgcm60jl().s[37]++;state=player_state_reducer_1.playerStateReducer(this,state,action);cov_2bhgcm60jl().s[38]++;this.handler.onStateChange(state);cov_2bhgcm60jl().s[39]++;return state;}else{cov_2bhgcm60jl().b[1][1]++;}cov_2bhgcm60jl().s[40]++;if(action instanceof resolve_prompt_action_1.ResolvePromptAction){cov_2bhgcm60jl().b[3][0]++;cov_2bhgcm60jl().s[41]++;state=this.reducePrompt(state,action);cov_2bhgcm60jl().s[42]++;if(this.promptItems.length===0){cov_2bhgcm60jl().b[4][0]++;cov_2bhgcm60jl().s[43]++;state=check_effect_1.checkState(this,state);}else{cov_2bhgcm60jl().b[4][1]++;}cov_2bhgcm60jl().s[44]++;this.handler.onStateChange(state);cov_2bhgcm60jl().s[45]++;return state;}else{cov_2bhgcm60jl().b[3][1]++;}cov_2bhgcm60jl().s[46]++;if(action instanceof append_log_action_1.AppendLogAction){cov_2bhgcm60jl().b[5][0]++;cov_2bhgcm60jl().s[47]++;this.log(state,action.message,action.params,action.id);cov_2bhgcm60jl().s[48]++;this.handler.onStateChange(state);cov_2bhgcm60jl().s[49]++;return state;}else{cov_2bhgcm60jl().b[5][1]++;}cov_2bhgcm60jl().s[50]++;if(state.prompts.some(p=>{cov_2bhgcm60jl().f[2]++;cov_2bhgcm60jl().s[51]++;return p.result===undefined;})){cov_2bhgcm60jl().b[6][0]++;cov_2bhgcm60jl().s[52]++;throw new game_error_1.GameError(game_message_1.GameMessage.ACTION_IN_PROGRESS);}else{cov_2bhgcm60jl().b[6][1]++;}cov_2bhgcm60jl().s[53]++;state=this.reduce(state,action);cov_2bhgcm60jl().s[54]++;return state;}reduceEffect(state,effect){cov_2bhgcm60jl().f[3]++;cov_2bhgcm60jl().s[55]++;state=this.propagateEffect(state,effect);cov_2bhgcm60jl().s[56]++;if(effect.preventDefault===true){cov_2bhgcm60jl().b[7][0]++;cov_2bhgcm60jl().s[57]++;return state;}else{cov_2bhgcm60jl().b[7][1]++;}cov_2bhgcm60jl().s[58]++;state=game_phase_effect_1.gamePhaseReducer(this,state,effect);cov_2bhgcm60jl().s[59]++;state=play_energy_effect_1.playEnergyReducer(this,state,effect);cov_2bhgcm60jl().s[60]++;state=play_pokemon_effect_1.playPokemonReducer(this,state,effect);cov_2bhgcm60jl().s[61]++;state=play_trainer_effect_1.playTrainerReducer(this,state,effect);cov_2bhgcm60jl().s[62]++;state=retreat_effect_1.retreatReducer(this,state,effect);cov_2bhgcm60jl().s[63]++;state=game_effect_1.gameReducer(this,state,effect);cov_2bhgcm60jl().s[64]++;state=attack_effect_1.attackReducer(this,state,effect);cov_2bhgcm60jl().s[65]++;state=check_effect_1.checkStateReducer(this,state,effect);cov_2bhgcm60jl().s[66]++;return state;}prompt(state,prompts,then){cov_2bhgcm60jl().f[4]++;cov_2bhgcm60jl().s[67]++;if(!(prompts instanceof Array)){cov_2bhgcm60jl().b[8][0]++;cov_2bhgcm60jl().s[68]++;prompts=[prompts];}else{cov_2bhgcm60jl().b[8][1]++;}cov_2bhgcm60jl().s[69]++;for(let i=(cov_2bhgcm60jl().s[70]++,0);i<prompts.length;i++){const id=(cov_2bhgcm60jl().s[71]++,utils_1.generateId(state.prompts));cov_2bhgcm60jl().s[72]++;prompts[i].id=id;cov_2bhgcm60jl().s[73]++;state.prompts.push(prompts[i]);}const promptItem=(cov_2bhgcm60jl().s[74]++,{ids:prompts.map(prompt=>{cov_2bhgcm60jl().f[5]++;cov_2bhgcm60jl().s[75]++;return prompt.id;}),then:then});cov_2bhgcm60jl().s[76]++;this.promptItems.push(promptItem);cov_2bhgcm60jl().s[77]++;return state;}waitPrompt(state,callback){cov_2bhgcm60jl().f[6]++;cov_2bhgcm60jl().s[78]++;this.waitItems.push(callback);cov_2bhgcm60jl().s[79]++;return state;}log(state,message,params,client){cov_2bhgcm60jl().f[7]++;const log=(cov_2bhgcm60jl().s[80]++,new state_log_1.StateLog(message,params,client));cov_2bhgcm60jl().s[81]++;log.id=++this.logId;cov_2bhgcm60jl().s[82]++;state.logs.push(log);}reducePrompt(state,action){cov_2bhgcm60jl().f[8]++;// Resolve prompts actions
const prompt=(cov_2bhgcm60jl().s[83]++,state.prompts.find(item=>{cov_2bhgcm60jl().f[9]++;cov_2bhgcm60jl().s[84]++;return item.id===action.id;}));const promptItem=(cov_2bhgcm60jl().s[85]++,this.promptItems.find(item=>{cov_2bhgcm60jl().f[10]++;cov_2bhgcm60jl().s[86]++;return item.ids.indexOf(action.id)!==-1;}));cov_2bhgcm60jl().s[87]++;if((cov_2bhgcm60jl().b[10][0]++,prompt===undefined)||(cov_2bhgcm60jl().b[10][1]++,promptItem===undefined)){cov_2bhgcm60jl().b[9][0]++;cov_2bhgcm60jl().s[88]++;throw new game_error_1.GameError(game_message_1.GameMessage.ILLEGAL_ACTION);}else{cov_2bhgcm60jl().b[9][1]++;}cov_2bhgcm60jl().s[89]++;if(prompt.result!==undefined){cov_2bhgcm60jl().b[11][0]++;cov_2bhgcm60jl().s[90]++;throw new game_error_1.GameError(game_message_1.GameMessage.PROMPT_ALREADY_RESOLVED);}else{cov_2bhgcm60jl().b[11][1]++;}cov_2bhgcm60jl().s[91]++;try{cov_2bhgcm60jl().s[92]++;prompt.result=action.result;const results=(cov_2bhgcm60jl().s[93]++,promptItem.ids.map(id=>{cov_2bhgcm60jl().f[11]++;const p=(cov_2bhgcm60jl().s[94]++,state.prompts.find(item=>{cov_2bhgcm60jl().f[12]++;cov_2bhgcm60jl().s[95]++;return item.id===id;}));cov_2bhgcm60jl().s[96]++;return p===undefined?(cov_2bhgcm60jl().b[12][0]++,undefined):(cov_2bhgcm60jl().b[12][1]++,p.result);}));cov_2bhgcm60jl().s[97]++;if(action.log!==undefined){cov_2bhgcm60jl().b[13][0]++;cov_2bhgcm60jl().s[98]++;this.log(state,action.log.message,action.log.params,action.log.client);}else{cov_2bhgcm60jl().b[13][1]++;}cov_2bhgcm60jl().s[99]++;if(results.every(result=>{cov_2bhgcm60jl().f[13]++;cov_2bhgcm60jl().s[100]++;return result!==undefined;})){cov_2bhgcm60jl().b[14][0]++;const itemIndex=(cov_2bhgcm60jl().s[101]++,this.promptItems.indexOf(promptItem));cov_2bhgcm60jl().s[102]++;promptItem.then(results.length===1?(cov_2bhgcm60jl().b[15][0]++,results[0]):(cov_2bhgcm60jl().b[15][1]++,results));cov_2bhgcm60jl().s[103]++;this.promptItems.splice(itemIndex,1);}else{cov_2bhgcm60jl().b[14][1]++;}cov_2bhgcm60jl().s[104]++;this.resolveWaitItems();}catch(storeError){cov_2bhgcm60jl().s[105]++;// Illegal action
prompt.result=undefined;cov_2bhgcm60jl().s[106]++;throw storeError;}cov_2bhgcm60jl().s[107]++;return state;}resolveWaitItems(){cov_2bhgcm60jl().f[14]++;cov_2bhgcm60jl().s[108]++;while((cov_2bhgcm60jl().b[16][0]++,this.promptItems.length===0)&&(cov_2bhgcm60jl().b[16][1]++,this.waitItems.length>0)){const waitItem=(cov_2bhgcm60jl().s[109]++,this.waitItems.pop());cov_2bhgcm60jl().s[110]++;if(waitItem!==undefined){cov_2bhgcm60jl().b[17][0]++;cov_2bhgcm60jl().s[111]++;waitItem();}else{cov_2bhgcm60jl().b[17][1]++;}}}hasPrompts(){cov_2bhgcm60jl().f[15]++;cov_2bhgcm60jl().s[112]++;return this.promptItems.length>0;}reduce(state,action){cov_2bhgcm60jl().f[16]++;const stateBackup=(cov_2bhgcm60jl().s[113]++,utils_1.deepClone(state,[card_1.Card]));cov_2bhgcm60jl().s[114]++;this.promptItems.length=0;cov_2bhgcm60jl().s[115]++;try{cov_2bhgcm60jl().s[116]++;state=setup_reducer_1.setupPhaseReducer(this,state,action);cov_2bhgcm60jl().s[117]++;state=play_card_reducer_1.playCardReducer(this,state,action);cov_2bhgcm60jl().s[118]++;state=player_turn_reducer_1.playerTurnReducer(this,state,action);cov_2bhgcm60jl().s[119]++;this.resolveWaitItems();cov_2bhgcm60jl().s[120]++;if(this.promptItems.length===0){cov_2bhgcm60jl().b[18][0]++;cov_2bhgcm60jl().s[121]++;state=check_effect_1.checkState(this,state);}else{cov_2bhgcm60jl().b[18][1]++;}}catch(storeError){cov_2bhgcm60jl().s[122]++;// Illegal action
this.state=stateBackup;cov_2bhgcm60jl().s[123]++;this.promptItems.length=0;cov_2bhgcm60jl().s[124]++;throw storeError;}cov_2bhgcm60jl().s[125]++;this.handler.onStateChange(state);cov_2bhgcm60jl().s[126]++;return state;}propagateEffect(state,effect){cov_2bhgcm60jl().f[17]++;const cards=(cov_2bhgcm60jl().s[127]++,[]);cov_2bhgcm60jl().s[128]++;for(const player of state.players){cov_2bhgcm60jl().s[129]++;player.stadium.cards.forEach(c=>{cov_2bhgcm60jl().f[18]++;cov_2bhgcm60jl().s[130]++;return cards.push(c);});cov_2bhgcm60jl().s[131]++;player.supporter.cards.forEach(c=>{cov_2bhgcm60jl().f[19]++;cov_2bhgcm60jl().s[132]++;return cards.push(c);});cov_2bhgcm60jl().s[133]++;player.active.cards.forEach(c=>{cov_2bhgcm60jl().f[20]++;cov_2bhgcm60jl().s[134]++;return cards.push(c);});cov_2bhgcm60jl().s[135]++;for(const bench of player.bench){cov_2bhgcm60jl().s[136]++;bench.cards.forEach(c=>{cov_2bhgcm60jl().f[21]++;cov_2bhgcm60jl().s[137]++;return cards.push(c);});}cov_2bhgcm60jl().s[138]++;for(const prize of player.prizes){cov_2bhgcm60jl().s[139]++;prize.cards.forEach(c=>{cov_2bhgcm60jl().f[22]++;cov_2bhgcm60jl().s[140]++;return cards.push(c);});}cov_2bhgcm60jl().s[141]++;player.hand.cards.forEach(c=>{cov_2bhgcm60jl().f[23]++;cov_2bhgcm60jl().s[142]++;return cards.push(c);});cov_2bhgcm60jl().s[143]++;player.deck.cards.forEach(c=>{cov_2bhgcm60jl().f[24]++;cov_2bhgcm60jl().s[144]++;return cards.push(c);});cov_2bhgcm60jl().s[145]++;player.discard.cards.forEach(c=>{cov_2bhgcm60jl().f[25]++;cov_2bhgcm60jl().s[146]++;return cards.push(c);});}cov_2bhgcm60jl().s[147]++;cards.sort(c=>{cov_2bhgcm60jl().f[26]++;cov_2bhgcm60jl().s[148]++;return c.superType;});cov_2bhgcm60jl().s[149]++;cards.forEach(c=>{cov_2bhgcm60jl().f[27]++;cov_2bhgcm60jl().s[150]++;state=c.reduceEffect(this,state,effect);});cov_2bhgcm60jl().s[151]++;return state;}}cov_2bhgcm60jl().s[152]++;exports.Store=Store;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvc3RvcmUudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3N0b3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLG1FQUE4RDtBQUM5RCxtRUFBOEQ7QUFDOUQsc0NBQW1DO0FBQ25DLHlFQUFvRTtBQUVwRSw4Q0FBMEM7QUFDMUMsa0RBQXVEO0FBRXZELCtEQUFrRjtBQUNsRiwyRUFBc0U7QUFDdEUseUNBQXNDO0FBQ3RDLGlEQUE0RDtBQUc1RCw2Q0FBMEQ7QUFDMUQsbUVBQWdFO0FBQ2hFLG9FQUErRDtBQUMvRCw2RUFBeUU7QUFDekUsK0VBQTJFO0FBQzNFLCtFQUEyRTtBQUMzRSx3RUFBbUU7QUFDbkUsMkVBQXVFO0FBQ3ZFLCtEQUE0RDtBQUM1RCxpRUFBK0U7QUFDL0UsMEVBQW9FO0FBQ3BFLHFFQUFrRTtBQUNsRSw0REFBNkQ7QUFDN0Qsc0VBQWlFO0FBT2pFLE1BQWEsS0FBSztJQU9oQixZQUFvQixPQUFxQjtRQUFyQixZQUFPLEdBQVAsT0FBTyxDQUFjO1FBTGxDLFVBQUssR0FBVSxJQUFJLGFBQUssRUFBRSxDQUFDO1FBQzFCLGdCQUFXLEdBQWlCLEVBQUUsQ0FBQztRQUMvQixjQUFTLEdBQW1CLEVBQUUsQ0FBQztRQUMvQixVQUFLLEdBQVcsQ0FBQyxDQUFDO0lBRW1CLENBQUM7SUFFdkMsUUFBUSxDQUFDLE1BQWM7UUFDNUIsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztRQUV2QixJQUFJLE1BQU0sWUFBWSxtQ0FBZSxFQUFFO1lBQ3JDLEtBQUssR0FBRyxxQ0FBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQzlDLElBQUksQ0FB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UUFDN0IsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLEtBQUssR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNyRSxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7Q0FDRjtBQXRNRCxzQkFzTUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuL2FjdGlvbnMvYWN0aW9uJztcbmltcG9ydCB7IEFib3J0R2FtZUFjdGlvbiB9IGZyb20gJy4vYWN0aW9ucy9hYm9ydC1nYW1lLWFjdGlvbic7XG5pbXBvcnQgeyBBcHBlbmRMb2dBY3Rpb24gfSBmcm9tICcuL2FjdGlvbnMvYXBwZW5kLWxvZy1hY3Rpb24nO1xuaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4vY2FyZC9jYXJkJztcbmltcG9ydCB7IENoYW5nZUF2YXRhckFjdGlvbiB9IGZyb20gJy4vYWN0aW9ucy9jaGFuZ2UtYXZhdGFyLWFjdGlvbic7XG5pbXBvcnQgeyBFZmZlY3QgfSBmcm9tICcuL2VmZmVjdHMvZWZmZWN0JztcbmltcG9ydCB7IEdhbWVFcnJvciB9IGZyb20gJy4uL2dhbWUtZXJyb3InO1xuaW1wb3J0IHsgR2FtZU1lc3NhZ2UsIEdhbWVMb2cgfSBmcm9tICcuLi9nYW1lLW1lc3NhZ2UnO1xuaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi9wcm9tcHRzL3Byb21wdCc7XG5pbXBvcnQgeyBSZW9yZGVySGFuZEFjdGlvbiwgUmVvcmRlckJlbmNoQWN0aW9uIH0gZnJvbSAnLi9hY3Rpb25zL3Jlb3JkZXItYWN0aW9ucyc7XG5pbXBvcnQgeyBSZXNvbHZlUHJvbXB0QWN0aW9uIH0gZnJvbSAnLi9hY3Rpb25zL3Jlc29sdmUtcHJvbXB0LWFjdGlvbic7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4vc3RhdGUvc3RhdGUnO1xuaW1wb3J0IHsgU3RhdGVMb2csIFN0YXRlTG9nUGFyYW0gfSBmcm9tICcuL3N0YXRlL3N0YXRlLWxvZyc7XG5pbXBvcnQgeyBTdG9yZUhhbmRsZXIgfSBmcm9tICcuL3N0b3JlLWhhbmRsZXInO1xuaW1wb3J0IHsgU3RvcmVMaWtlIH0gZnJvbSAnLi9zdG9yZS1saWtlJztcbmltcG9ydCB7IGdlbmVyYXRlSWQsIGRlZXBDbG9uZSB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IGF0dGFja1JlZHVjZXIgfSBmcm9tICcuL2VmZmVjdC1yZWR1Y2Vycy9hdHRhY2stZWZmZWN0JztcbmltcG9ydCB7IHBsYXlDYXJkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlcnMvcGxheS1jYXJkLXJlZHVjZXInO1xuaW1wb3J0IHsgcGxheUVuZXJneVJlZHVjZXIgfSBmcm9tICcuL2VmZmVjdC1yZWR1Y2Vycy9wbGF5LWVuZXJneS1lZmZlY3QnO1xuaW1wb3J0IHsgcGxheVBva2Vtb25SZWR1Y2VyIH0gZnJvbSAnLi9lZmZlY3QtcmVkdWNlcnMvcGxheS1wb2tlbW9uLWVmZmVjdCc7XG5pbXBvcnQgeyBwbGF5VHJhaW5lclJlZHVjZXIgfSBmcm9tICcuL2VmZmVjdC1yZWR1Y2Vycy9wbGF5LXRyYWluZXItZWZmZWN0JztcbmltcG9ydCB7IHBsYXllclR1cm5SZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2Vycy9wbGF5ZXItdHVybi1yZWR1Y2VyJztcbmltcG9ydCB7IGdhbWVQaGFzZVJlZHVjZXIgfSBmcm9tICcuL2VmZmVjdC1yZWR1Y2Vycy9nYW1lLXBoYXNlLWVmZmVjdCc7XG5pbXBvcnQgeyBnYW1lUmVkdWNlciB9IGZyb20gJy4vZWZmZWN0LXJlZHVjZXJzL2dhbWUtZWZmZWN0JztcbmltcG9ydCB7IGNoZWNrU3RhdGUsIGNoZWNrU3RhdGVSZWR1Y2VyIH0gZnJvbSAnLi9lZmZlY3QtcmVkdWNlcnMvY2hlY2stZWZmZWN0JztcbmltcG9ydCB7IHBsYXllclN0YXRlUmVkdWNlcn0gZnJvbSAnLi9yZWR1Y2Vycy9wbGF5ZXItc3RhdGUtcmVkdWNlcic7XG5pbXBvcnQgeyByZXRyZWF0UmVkdWNlciB9IGZyb20gJy4vZWZmZWN0LXJlZHVjZXJzL3JldHJlYXQtZWZmZWN0JztcbmltcG9ydCB7IHNldHVwUGhhc2VSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2Vycy9zZXR1cC1yZWR1Y2VyJztcbmltcG9ydCB7IGFib3J0R2FtZVJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXJzL2Fib3J0LWdhbWUtcmVkdWNlcic7XG5cbmludGVyZmFjZSBQcm9tcHRJdGVtIHtcbiAgaWRzOiBudW1iZXJbXSxcbiAgdGhlbjogKHJlc3VsdHM6IGFueSkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIFN0b3JlIGltcGxlbWVudHMgU3RvcmVMaWtlIHtcblxuICBwdWJsaWMgc3RhdGU6IFN0YXRlID0gbmV3IFN0YXRlKCk7XG4gIHByaXZhdGUgcHJvbXB0SXRlbXM6IFByb21wdEl0ZW1bXSA9IFtdO1xuICBwcml2YXRlIHdhaXRJdGVtczogKCgpID0+IHZvaWQpW10gPSBbXTtcbiAgcHJpdmF0ZSBsb2dJZDogbnVtYmVyID0gMDtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGhhbmRsZXI6IFN0b3JlSGFuZGxlcikgeyB9XG5cbiAgcHVibGljIGRpc3BhdGNoKGFjdGlvbjogQWN0aW9uKTogU3RhdGUge1xuICAgIGxldCBzdGF0ZSA9IHRoaXMuc3RhdGU7XG5cbiAgICBpZiAoYWN0aW9uIGluc3RhbmNlb2YgQWJvcnRHYW1lQWN0aW9uKSB7XG4gICAgICBzdGF0ZSA9IGFib3J0R2FtZVJlZHVjZXIodGhpcywgc3RhdGUsIGFjdGlvbik7XG4gICAgICB0aGlzLmhhbmRsZXIub25TdGF0ZUNoYW5nZShzdGF0ZSk7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIFJlb3JkZXJIYW5kQWN0aW9uXG4gICAgICB8fCBhY3Rpb24gaW5zdGFuY2VvZiBSZW9yZGVyQmVuY2hBY3Rpb25cbiAgICAgIHx8IGFjdGlvbiBpbnN0YW5jZW9mIENoYW5nZUF2YXRhckFjdGlvbikge1xuICAgICAgc3RhdGUgPSBwbGF5ZXJTdGF0ZVJlZHVjZXIodGhpcywgc3RhdGUsIGFjdGlvbik7XG4gICAgICB0aGlzLmhhbmRsZXIub25TdGF0ZUNoYW5nZShzdGF0ZSk7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIFJlc29sdmVQcm9tcHRBY3Rpb24pIHtcbiAgICAgIHN0YXRlID0gdGhpcy5yZWR1Y2VQcm9tcHQoc3RhdGUsIGFjdGlvbik7XG4gICAgICBpZiAodGhpcy5wcm9tcHRJdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc3RhdGUgPSBjaGVja1N0YXRlKHRoaXMsIHN0YXRlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaGFuZGxlci5vblN0YXRlQ2hhbmdlKHN0YXRlKTtcbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9XG5cbiAgICBpZiAoYWN0aW9uIGluc3RhbmNlb2YgQXBwZW5kTG9nQWN0aW9uKSB7XG4gICAgICB0aGlzLmxvZyhzdGF0ZSwgYWN0aW9uLm1lc3NhZ2UsIGFjdGlvbi5wYXJhbXMsIGFjdGlvbi5pZCk7XG4gICAgICB0aGlzLmhhbmRsZXIub25TdGF0ZUNoYW5nZShzdGF0ZSk7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgaWYgKHN0YXRlLnByb21wdHMuc29tZShwID0+IHAucmVzdWx0ID09PSB1bmRlZmluZWQpKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLkFDVElPTl9JTl9QUk9HUkVTUyk7XG4gICAgfVxuXG4gICAgc3RhdGUgPSB0aGlzLnJlZHVjZShzdGF0ZSwgYWN0aW9uKTtcblxuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHB1YmxpYyByZWR1Y2VFZmZlY3Qoc3RhdGU6IFN0YXRlLCBlZmZlY3Q6IEVmZmVjdCk6IFN0YXRlIHtcbiAgICBzdGF0ZSA9IHRoaXMucHJvcGFnYXRlRWZmZWN0KHN0YXRlLCBlZmZlY3QpO1xuXG4gICAgaWYgKGVmZmVjdC5wcmV2ZW50RGVmYXVsdCA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIHN0YXRlID0gZ2FtZVBoYXNlUmVkdWNlcih0aGlzLCBzdGF0ZSwgZWZmZWN0KTtcbiAgICBzdGF0ZSA9IHBsYXlFbmVyZ3lSZWR1Y2VyKHRoaXMsIHN0YXRlLCBlZmZlY3QpO1xuICAgIHN0YXRlID0gcGxheVBva2Vtb25SZWR1Y2VyKHRoaXMsIHN0YXRlLCBlZmZlY3QpO1xuICAgIHN0YXRlID0gcGxheVRyYWluZXJSZWR1Y2VyKHRoaXMsIHN0YXRlLCBlZmZlY3QpO1xuICAgIHN0YXRlID0gcmV0cmVhdFJlZHVjZXIodGhpcywgc3RhdGUsIGVmZmVjdCk7XG4gICAgc3RhdGUgPSBnYW1lUmVkdWNlcih0aGlzLCBzdGF0ZSwgZWZmZWN0KTtcbiAgICBzdGF0ZSA9IGF0dGFja1JlZHVjZXIodGhpcywgc3RhdGUsIGVmZmVjdCk7XG4gICAgc3RhdGUgPSBjaGVja1N0YXRlUmVkdWNlcih0aGlzLCBzdGF0ZSwgZWZmZWN0KTtcblxuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHB1YmxpYyBwcm9tcHQoc3RhdGU6IFN0YXRlLCBwcm9tcHRzOiBQcm9tcHQ8YW55PltdIHwgUHJvbXB0PGFueT4sIHRoZW46IChyZXN1bHRzOiBhbnkpID0+IHZvaWQpOiBTdGF0ZSB7XG4gICAgaWYgKCEocHJvbXB0cyBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgcHJvbXB0cyA9IFtwcm9tcHRzXTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb21wdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGlkID0gZ2VuZXJhdGVJZChzdGF0ZS5wcm9tcHRzKTtcbiAgICAgIHByb21wdHNbaV0uaWQgPSBpZDtcbiAgICAgIHN0YXRlLnByb21wdHMucHVzaChwcm9tcHRzW2ldKTtcbiAgICB9XG5cbiAgICBjb25zdCBwcm9tcHRJdGVtOiBQcm9tcHRJdGVtID0ge1xuICAgICAgaWRzOiBwcm9tcHRzLm1hcChwcm9tcHQgPT4gcHJvbXB0LmlkKSxcbiAgICAgIHRoZW46IHRoZW5cbiAgICB9O1xuXG4gICAgdGhpcy5wcm9tcHRJdGVtcy5wdXNoKHByb21wdEl0ZW0pO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHB1YmxpYyB3YWl0UHJvbXB0KHN0YXRlOiBTdGF0ZSwgY2FsbGJhY2s6ICgpID0+IHZvaWQpOiBTdGF0ZSB7XG4gICAgdGhpcy53YWl0SXRlbXMucHVzaChjYWxsYmFjayk7XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgcHVibGljIGxvZyhzdGF0ZTogU3RhdGUsIG1lc3NhZ2U6IEdhbWVMb2csIHBhcmFtcz86IFN0YXRlTG9nUGFyYW0sIGNsaWVudD86IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IGxvZyA9IG5ldyBTdGF0ZUxvZyhtZXNzYWdlLCBwYXJhbXMsIGNsaWVudCk7XG4gICAgbG9nLmlkID0gKyt0aGlzLmxvZ0lkO1xuICAgIHN0YXRlLmxvZ3MucHVzaChsb2cpO1xuICB9XG5cbiAgcHJpdmF0ZSByZWR1Y2VQcm9tcHQoc3RhdGU6IFN0YXRlLCBhY3Rpb246IFJlc29sdmVQcm9tcHRBY3Rpb24pOiBTdGF0ZSB7XG4gICAgLy8gUmVzb2x2ZSBwcm9tcHRzIGFjdGlvbnNcbiAgICBjb25zdCBwcm9tcHQgPSBzdGF0ZS5wcm9tcHRzLmZpbmQoaXRlbSA9PiBpdGVtLmlkID09PSBhY3Rpb24uaWQpO1xuICAgIGNvbnN0IHByb21wdEl0ZW0gPSB0aGlzLnByb21wdEl0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmlkcy5pbmRleE9mKGFjdGlvbi5pZCkgIT09IC0xKTtcblxuICAgIGlmIChwcm9tcHQgPT09IHVuZGVmaW5lZCB8fCBwcm9tcHRJdGVtID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSUxMRUdBTF9BQ1RJT04pO1xuICAgIH1cblxuICAgIGlmIChwcm9tcHQucmVzdWx0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuUFJPTVBUX0FMUkVBRFlfUkVTT0xWRUQpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBwcm9tcHQucmVzdWx0ID0gYWN0aW9uLnJlc3VsdDtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IHByb21wdEl0ZW0uaWRzLm1hcChpZCA9PiB7XG4gICAgICAgIGNvbnN0IHAgPSBzdGF0ZS5wcm9tcHRzLmZpbmQoaXRlbSA9PiBpdGVtLmlkID09PSBpZCk7XG4gICAgICAgIHJldHVybiBwID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBwLnJlc3VsdDtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoYWN0aW9uLmxvZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMubG9nKHN0YXRlLCBhY3Rpb24ubG9nLm1lc3NhZ2UsIGFjdGlvbi5sb2cucGFyYW1zLCBhY3Rpb24ubG9nLmNsaWVudCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZXN1bHRzLmV2ZXJ5KHJlc3VsdCA9PiByZXN1bHQgIT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgY29uc3QgaXRlbUluZGV4ID0gdGhpcy5wcm9tcHRJdGVtcy5pbmRleE9mKHByb21wdEl0ZW0pO1xuICAgICAgICBwcm9tcHRJdGVtLnRoZW4ocmVzdWx0cy5sZW5ndGggPT09IDEgPyByZXN1bHRzWzBdIDogcmVzdWx0cyk7XG4gICAgICAgIHRoaXMucHJvbXB0SXRlbXMuc3BsaWNlKGl0ZW1JbmRleCwgMSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmVzb2x2ZVdhaXRJdGVtcygpO1xuICAgIH0gY2F0Y2ggKHN0b3JlRXJyb3IpIHtcbiAgICAgIC8vIElsbGVnYWwgYWN0aW9uXG4gICAgICBwcm9tcHQucmVzdWx0ID0gdW5kZWZpbmVkO1xuICAgICAgdGhyb3cgc3RvcmVFcnJvcjtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBwcml2YXRlIHJlc29sdmVXYWl0SXRlbXMoKTogdm9pZCB7XG4gICAgd2hpbGUgKHRoaXMucHJvbXB0SXRlbXMubGVuZ3RoID09PSAwICYmIHRoaXMud2FpdEl0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHdhaXRJdGVtID0gdGhpcy53YWl0SXRlbXMucG9wKCk7XG4gICAgICBpZiAod2FpdEl0ZW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB3YWl0SXRlbSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBoYXNQcm9tcHRzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnByb21wdEl0ZW1zLmxlbmd0aCA+IDA7XG4gIH1cblxuICBwcml2YXRlIHJlZHVjZShzdGF0ZTogU3RhdGUsIGFjdGlvbjogQWN0aW9uKTogU3RhdGUge1xuICAgIGNvbnN0IHN0YXRlQmFja3VwID0gZGVlcENsb25lKHN0YXRlLCBbIENhcmQgXSk7XG4gICAgdGhpcy5wcm9tcHRJdGVtcy5sZW5ndGggPSAwO1xuXG4gICAgdHJ5IHtcbiAgICAgIHN0YXRlID0gc2V0dXBQaGFzZVJlZHVjZXIodGhpcywgc3RhdGUsIGFjdGlvbik7XG4gICAgICBzdGF0ZSA9IHBsYXlDYXJkUmVkdWNlcih0aGlzLCBzdGF0ZSwgYWN0aW9uKTtcbiAgICAgIHN0YXRlID0gcGxheWVyVHVyblJlZHVjZXIodGhpcywgc3RhdGUsIGFjdGlvbik7XG5cbiAgICAgIHRoaXMucmVzb2x2ZVdhaXRJdGVtcygpO1xuICAgICAgaWYgKHRoaXMucHJvbXB0SXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHN0YXRlID0gY2hlY2tTdGF0ZSh0aGlzLCBzdGF0ZSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoc3RvcmVFcnJvcikge1xuICAgICAgLy8gSWxsZWdhbCBhY3Rpb25cbiAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZUJhY2t1cDtcbiAgICAgIHRoaXMucHJvbXB0SXRlbXMubGVuZ3RoID0gMDtcbiAgICAgIHRocm93IHN0b3JlRXJyb3I7XG4gICAgfVxuXG4gICAgdGhpcy5oYW5kbGVyLm9uU3RhdGVDaGFuZ2Uoc3RhdGUpO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHByaXZhdGUgcHJvcGFnYXRlRWZmZWN0KHN0YXRlOiBTdGF0ZSwgZWZmZWN0OiBFZmZlY3QpOiBTdGF0ZSB7XG4gICAgY29uc3QgY2FyZHM6IENhcmRbXSA9IFtdO1xuICAgIGZvciAoY29uc3QgcGxheWVyIG9mIHN0YXRlLnBsYXllcnMpIHtcbiAgICAgIHBsYXllci5zdGFkaXVtLmNhcmRzLmZvckVhY2goYyA9PiBjYXJkcy5wdXNoKGMpKTtcbiAgICAgIHBsYXllci5zdXBwb3J0ZXIuY2FyZHMuZm9yRWFjaChjID0+IGNhcmRzLnB1c2goYykpO1xuICAgICAgcGxheWVyLmFjdGl2ZS5jYXJkcy5mb3JFYWNoKGMgPT4gY2FyZHMucHVzaChjKSk7XG4gICAgICBmb3IgKGNvbnN0IGJlbmNoIG9mIHBsYXllci5iZW5jaCkge1xuICAgICAgICBiZW5jaC5jYXJkcy5mb3JFYWNoKGMgPT4gY2FyZHMucHVzaChjKSk7XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IHByaXplIG9mIHBsYXllci5wcml6ZXMpIHtcbiAgICAgICAgcHJpemUuY2FyZHMuZm9yRWFjaChjID0+IGNhcmRzLnB1c2goYykpO1xuICAgICAgfVxuICAgICAgcGxheWVyLmhhbmQuY2FyZHMuZm9yRWFjaChjID0+IGNhcmRzLnB1c2goYykpO1xuICAgICAgcGxheWVyLmRlY2suY2FyZHMuZm9yRWFjaChjID0+IGNhcmRzLnB1c2goYykpO1xuICAgICAgcGxheWVyLmRpc2NhcmQuY2FyZHMuZm9yRWFjaChjID0+IGNhcmRzLnB1c2goYykpO1xuICAgIH1cbiAgICBjYXJkcy5zb3J0KGMgPT4gYy5zdXBlclR5cGUpO1xuICAgIGNhcmRzLmZvckVhY2goYyA9PiB7IHN0YXRlID0gYy5yZWR1Y2VFZmZlY3QodGhpcywgc3RhdGUsIGVmZmVjdCk7IH0pO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxufVxuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3N0b3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJnb2pDQWlCQTt5TkFoQkEsS0FBQSxDQUFBLG1CQUFBLDBCQUFBLE9BQUEsQ0FBQSw2QkFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsbUJBQUEsMEJBQUEsT0FBQSxDQUFBLDZCQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxNQUFBLDBCQUFBLE9BQUEsQ0FBQSxhQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxzQkFBQSwwQkFBQSxPQUFBLENBQUEsZ0NBQUEsQ0FBQSxDQUFBLENBRUEsS0FBQSxDQUFBLFlBQUEsMEJBQUEsT0FBQSxDQUFBLGVBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGNBQUEsMEJBQUEsT0FBQSxDQUFBLGlCQUFBLENBQUEsQ0FBQSxDQUVBLEtBQUEsQ0FBQSxpQkFBQSwwQkFBQSxPQUFBLENBQUEsMkJBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLHVCQUFBLDBCQUFBLE9BQUEsQ0FBQSxpQ0FBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsT0FBQSwyQkFBQSxPQUFBLENBQUEsZUFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsV0FBQSwyQkFBQSxPQUFBLENBQUEsbUJBQUEsQ0FBQSxDQUFBLENBR0EsS0FBQSxDQUFBLE9BQUEsMkJBQUEsT0FBQSxDQUFBLG1CQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxlQUFBLDJCQUFBLE9BQUEsQ0FBQSxpQ0FBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsbUJBQUEsMkJBQUEsT0FBQSxDQUFBLDhCQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxvQkFBQSwyQkFBQSxPQUFBLENBQUEsc0NBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLHFCQUFBLDJC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RCwwQkFpQmxELEtBQUssQ0FBQyxPQUFOLENBQWMsQ0FBQyxFQUFHLG9EQUFHLEtBQUssQ0FBRyxDQUFDLENBQUMsWUFBRixDQUFlLElBQWYsQ0FBcUIsS0FBckIsQ0FBNEIsTUFBNUIsQ0FBUixDQUE4QyxDQUFuRSxFQWpCa0QsMEJBa0JsRCxNQUFPLENBQUEsS0FBUCxDQUNELENBck1lLEMsMEJBQWxCLE9BQUEsQ0FBQSxLQUFBLENBQUEsS0FBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAnLi9hY3Rpb25zL2FjdGlvbic7XG5pbXBvcnQgeyBBYm9ydEdhbWVBY3Rpb24gfSBmcm9tICcuL2FjdGlvbnMvYWJvcnQtZ2FtZS1hY3Rpb24nO1xuaW1wb3J0IHsgQXBwZW5kTG9nQWN0aW9uIH0gZnJvbSAnLi9hY3Rpb25zL2FwcGVuZC1sb2ctYWN0aW9uJztcbmltcG9ydCB7IENhcmQgfSBmcm9tICcuL2NhcmQvY2FyZCc7XG5pbXBvcnQgeyBDaGFuZ2VBdmF0YXJBY3Rpb24gfSBmcm9tICcuL2FjdGlvbnMvY2hhbmdlLWF2YXRhci1hY3Rpb24nO1xuaW1wb3J0IHsgRWZmZWN0IH0gZnJvbSAnLi9lZmZlY3RzL2VmZmVjdCc7XG5pbXBvcnQgeyBHYW1lRXJyb3IgfSBmcm9tICcuLi9nYW1lLWVycm9yJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlLCBHYW1lTG9nIH0gZnJvbSAnLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IFByb21wdCB9IGZyb20gJy4vcHJvbXB0cy9wcm9tcHQnO1xuaW1wb3J0IHsgUmVvcmRlckhhbmRBY3Rpb24sIFJlb3JkZXJCZW5jaEFjdGlvbiB9IGZyb20gJy4vYWN0aW9ucy9yZW9yZGVyLWFjdGlvbnMnO1xuaW1wb3J0IHsgUmVzb2x2ZVByb21wdEFjdGlvbiB9IGZyb20gJy4vYWN0aW9ucy9yZXNvbHZlLXByb21wdC1hY3Rpb24nO1xuaW1wb3J0IHsgU3RhdGUgfSBmcm9tICcuL3N0YXRlL3N0YXRlJztcbmltcG9ydCB7IFN0YXRlTG9nLCBTdGF0ZUxvZ1BhcmFtIH0gZnJvbSAnLi9zdGF0ZS9zdGF0ZS1sb2cnO1xuaW1wb3J0IHsgU3RvcmVIYW5kbGVyIH0gZnJvbSAnLi9zdG9yZS1oYW5kbGVyJztcbmltcG9ydCB7IFN0b3JlTGlrZSB9IGZyb20gJy4vc3RvcmUtbGlrZSc7XG5pbXBvcnQgeyBnZW5lcmF0ZUlkLCBkZWVwQ2xvbmUgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBhdHRhY2tSZWR1Y2VyIH0gZnJvbSAnLi9lZmZlY3QtcmVkdWNlcnMvYXR0YWNrLWVmZmVjdCc7XG5pbXBvcnQgeyBwbGF5Q2FyZFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXJzL3BsYXktY2FyZC1yZWR1Y2VyJztcbmltcG9ydCB7IHBsYXlFbmVyZ3lSZWR1Y2VyIH0gZnJvbSAnLi9lZmZlY3QtcmVkdWNlcnMvcGxheS1lbmVyZ3ktZWZmZWN0JztcbmltcG9ydCB7IHBsYXlQb2tlbW9uUmVkdWNlciB9IGZyb20gJy4vZWZmZWN0LXJlZHVjZXJzL3BsYXktcG9rZW1vbi1lZmZlY3QnO1xuaW1wb3J0IHsgcGxheVRyYWluZXJSZWR1Y2VyIH0gZnJvbSAnLi9lZmZlY3QtcmVkdWNlcnMvcGxheS10cmFpbmVyLWVmZmVjdCc7XG5pbXBvcnQgeyBwbGF5ZXJUdXJuUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlcnMvcGxheWVyLXR1cm4tcmVkdWNlcic7XG5pbXBvcnQgeyBnYW1lUGhhc2VSZWR1Y2VyIH0gZnJvbSAnLi9lZmZlY3QtcmVkdWNlcnMvZ2FtZS1waGFzZS1lZmZlY3QnO1xuaW1wb3J0IHsgZ2FtZVJlZHVjZXIgfSBmcm9tICcuL2VmZmVjdC1yZWR1Y2Vycy9nYW1lLWVmZmVjdCc7XG5pbXBvcnQgeyBjaGVja1N0YXRlLCBjaGVja1N0YXRlUmVkdWNlciB9IGZyb20gJy4vZWZmZWN0LXJlZHVjZXJzL2NoZWNrLWVmZmVjdCc7XG5pbXBvcnQgeyBwbGF5ZXJTdGF0ZVJlZHVjZXJ9IGZyb20gJy4vcmVkdWNlcnMvcGxheWVyLXN0YXRlLXJlZHVjZXInO1xuaW1wb3J0IHsgcmV0cmVhdFJlZHVjZXIgfSBmcm9tICcuL2VmZmVjdC1yZWR1Y2Vycy9yZXRyZWF0LWVmZmVjdCc7XG5pbXBvcnQgeyBzZXR1cFBoYXNlUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlcnMvc2V0dXAtcmVkdWNlcic7XG5pbXBvcnQgeyBhYm9ydEdhbWVSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2Vycy9hYm9ydC1nYW1lLXJlZHVjZXInO1xuXG5pbnRlcmZhY2UgUHJvbXB0SXRlbSB7XG4gIGlkczogbnVtYmVyW10sXG4gIHRoZW46IChyZXN1bHRzOiBhbnkpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBTdG9yZSBpbXBsZW1lbnRzIFN0b3JlTGlrZSB7XG5cbiAgcHVibGljIHN0YXRlOiBTdGF0ZSA9IG5ldyBTdGF0ZSgpO1xuICBwcml2YXRlIHByb21wdEl0ZW1zOiBQcm9tcHRJdGVtW10gPSBbXTtcbiAgcHJpdmF0ZSB3YWl0SXRlbXM6ICgoKSA9PiB2b2lkKVtdID0gW107XG4gIHByaXZhdGUgbG9nSWQ6IG51bWJlciA9IDA7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBoYW5kbGVyOiBTdG9yZUhhbmRsZXIpIHsgfVxuXG4gIHB1YmxpYyBkaXNwYXRjaChhY3Rpb246IEFjdGlvbik6IFN0YXRlIHtcbiAgICBsZXQgc3RhdGUgPSB0aGlzLnN0YXRlO1xuXG4gICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIEFib3J0R2FtZUFjdGlvbikge1xuICAgICAgc3RhdGUgPSBhYm9ydEdhbWVSZWR1Y2VyKHRoaXMsIHN0YXRlLCBhY3Rpb24pO1xuICAgICAgdGhpcy5oYW5kbGVyLm9uU3RhdGVDaGFuZ2Uoc3RhdGUpO1xuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIGlmIChhY3Rpb24gaW5zdGFuY2VvZiBSZW9yZGVySGFuZEFjdGlvblxuICAgICAgfHwgYWN0aW9uIGluc3RhbmNlb2YgUmVvcmRlckJlbmNoQWN0aW9uXG4gICAgICB8fCBhY3Rpb24gaW5zdGFuY2VvZiBDaGFuZ2VBdmF0YXJBY3Rpb24pIHtcbiAgICAgIHN0YXRlID0gcGxheWVyU3RhdGVSZWR1Y2VyKHRoaXMsIHN0YXRlLCBhY3Rpb24pO1xuICAgICAgdGhpcy5oYW5kbGVyLm9uU3RhdGVDaGFuZ2Uoc3RhdGUpO1xuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIGlmIChhY3Rpb24gaW5zdGFuY2VvZiBSZXNvbHZlUHJvbXB0QWN0aW9uKSB7XG4gICAgICBzdGF0ZSA9IHRoaXMucmVkdWNlUHJvbXB0KHN0YXRlLCBhY3Rpb24pO1xuICAgICAgaWYgKHRoaXMucHJvbXB0SXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHN0YXRlID0gY2hlY2tTdGF0ZSh0aGlzLCBzdGF0ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLmhhbmRsZXIub25TdGF0ZUNoYW5nZShzdGF0ZSk7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIEFwcGVuZExvZ0FjdGlvbikge1xuICAgICAgdGhpcy5sb2coc3RhdGUsIGFjdGlvbi5tZXNzYWdlLCBhY3Rpb24ucGFyYW1zLCBhY3Rpb24uaWQpO1xuICAgICAgdGhpcy5oYW5kbGVyLm9uU3RhdGVDaGFuZ2Uoc3RhdGUpO1xuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIGlmIChzdGF0ZS5wcm9tcHRzLnNvbWUocCA9PiBwLnJlc3VsdCA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5BQ1RJT05fSU5fUFJPR1JFU1MpO1xuICAgIH1cblxuICAgIHN0YXRlID0gdGhpcy5yZWR1Y2Uoc3RhdGUsIGFjdGlvbik7XG5cbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBwdWJsaWMgcmVkdWNlRWZmZWN0KHN0YXRlOiBTdGF0ZSwgZWZmZWN0OiBFZmZlY3QpOiBTdGF0ZSB7XG4gICAgc3RhdGUgPSB0aGlzLnByb3BhZ2F0ZUVmZmVjdChzdGF0ZSwgZWZmZWN0KTtcblxuICAgIGlmIChlZmZlY3QucHJldmVudERlZmF1bHQgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9XG5cbiAgICBzdGF0ZSA9IGdhbWVQaGFzZVJlZHVjZXIodGhpcywgc3RhdGUsIGVmZmVjdCk7XG4gICAgc3RhdGUgPSBwbGF5RW5lcmd5UmVkdWNlcih0aGlzLCBzdGF0ZSwgZWZmZWN0KTtcbiAgICBzdGF0ZSA9IHBsYXlQb2tlbW9uUmVkdWNlcih0aGlzLCBzdGF0ZSwgZWZmZWN0KTtcbiAgICBzdGF0ZSA9IHBsYXlUcmFpbmVyUmVkdWNlcih0aGlzLCBzdGF0ZSwgZWZmZWN0KTtcbiAgICBzdGF0ZSA9IHJldHJlYXRSZWR1Y2VyKHRoaXMsIHN0YXRlLCBlZmZlY3QpO1xuICAgIHN0YXRlID0gZ2FtZVJlZHVjZXIodGhpcywgc3RhdGUsIGVmZmVjdCk7XG4gICAgc3RhdGUgPSBhdHRhY2tSZWR1Y2VyKHRoaXMsIHN0YXRlLCBlZmZlY3QpO1xuICAgIHN0YXRlID0gY2hlY2tTdGF0ZVJlZHVjZXIodGhpcywgc3RhdGUsIGVmZmVjdCk7XG5cbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBwdWJsaWMgcHJvbXB0KHN0YXRlOiBTdGF0ZSwgcHJvbXB0czogUHJvbXB0PGFueT5bXSB8IFByb21wdDxhbnk+LCB0aGVuOiAocmVzdWx0czogYW55KSA9PiB2b2lkKTogU3RhdGUge1xuICAgIGlmICghKHByb21wdHMgaW5zdGFuY2VvZiBBcnJheSkpIHtcbiAgICAgIHByb21wdHMgPSBbcHJvbXB0c107XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9tcHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpZCA9IGdlbmVyYXRlSWQoc3RhdGUucHJvbXB0cyk7XG4gICAgICBwcm9tcHRzW2ldLmlkID0gaWQ7XG4gICAgICBzdGF0ZS5wcm9tcHRzLnB1c2gocHJvbXB0c1tpXSk7XG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0SXRlbTogUHJvbXB0SXRlbSA9IHtcbiAgICAgIGlkczogcHJvbXB0cy5tYXAocHJvbXB0ID0+IHByb21wdC5pZCksXG4gICAgICB0aGVuOiB0aGVuXG4gICAgfTtcblxuICAgIHRoaXMucHJvbXB0SXRlbXMucHVzaChwcm9tcHRJdGVtKTtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBwdWJsaWMgd2FpdFByb21wdChzdGF0ZTogU3RhdGUsIGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogU3RhdGUge1xuICAgIHRoaXMud2FpdEl0ZW1zLnB1c2goY2FsbGJhY2spO1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIHB1YmxpYyBsb2coc3RhdGU6IFN0YXRlLCBtZXNzYWdlOiBHYW1lTG9nLCBwYXJhbXM/OiBTdGF0ZUxvZ1BhcmFtLCBjbGllbnQ/OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBsb2cgPSBuZXcgU3RhdGVMb2cobWVzc2FnZSwgcGFyYW1zLCBjbGllbnQpO1xuICAgIGxvZy5pZCA9ICsrdGhpcy5sb2dJZDtcbiAgICBzdGF0ZS5sb2dzLnB1c2gobG9nKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVkdWNlUHJvbXB0KHN0YXRlOiBTdGF0ZSwgYWN0aW9uOiBSZXNvbHZlUHJvbXB0QWN0aW9uKTogU3RhdGUge1xuICAgIC8vIFJlc29sdmUgcHJvbXB0cyBhY3Rpb25zXG4gICAgY29uc3QgcHJvbXB0ID0gc3RhdGUucHJvbXB0cy5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PT0gYWN0aW9uLmlkKTtcbiAgICBjb25zdCBwcm9tcHRJdGVtID0gdGhpcy5wcm9tcHRJdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5pZHMuaW5kZXhPZihhY3Rpb24uaWQpICE9PSAtMSk7XG5cbiAgICBpZiAocHJvbXB0ID09PSB1bmRlZmluZWQgfHwgcHJvbXB0SXRlbSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLklMTEVHQUxfQUNUSU9OKTtcbiAgICB9XG5cbiAgICBpZiAocHJvbXB0LnJlc3VsdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLlBST01QVF9BTFJFQURZX1JFU09MVkVEKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcHJvbXB0LnJlc3VsdCA9IGFjdGlvbi5yZXN1bHQ7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBwcm9tcHRJdGVtLmlkcy5tYXAoaWQgPT4ge1xuICAgICAgICBjb25zdCBwID0gc3RhdGUucHJvbXB0cy5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PT0gaWQpO1xuICAgICAgICByZXR1cm4gcCA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogcC5yZXN1bHQ7XG4gICAgICB9KTtcblxuICAgICAgaWYgKGFjdGlvbi5sb2cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmxvZyhzdGF0ZSwgYWN0aW9uLmxvZy5tZXNzYWdlLCBhY3Rpb24ubG9nLnBhcmFtcywgYWN0aW9uLmxvZy5jbGllbnQpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVzdWx0cy5ldmVyeShyZXN1bHQgPT4gcmVzdWx0ICE9PSB1bmRlZmluZWQpKSB7XG4gICAgICAgIGNvbnN0IGl0ZW1JbmRleCA9IHRoaXMucHJvbXB0SXRlbXMuaW5kZXhPZihwcm9tcHRJdGVtKTtcbiAgICAgICAgcHJvbXB0SXRlbS50aGVuKHJlc3VsdHMubGVuZ3RoID09PSAxID8gcmVzdWx0c1swXSA6IHJlc3VsdHMpO1xuICAgICAgICB0aGlzLnByb21wdEl0ZW1zLnNwbGljZShpdGVtSW5kZXgsIDEpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnJlc29sdmVXYWl0SXRlbXMoKTtcbiAgICB9IGNhdGNoIChzdG9yZUVycm9yKSB7XG4gICAgICAvLyBJbGxlZ2FsIGFjdGlvblxuICAgICAgcHJvbXB0LnJlc3VsdCA9IHVuZGVmaW5lZDtcbiAgICAgIHRocm93IHN0b3JlRXJyb3I7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgcHJpdmF0ZSByZXNvbHZlV2FpdEl0ZW1zKCk6IHZvaWQge1xuICAgIHdoaWxlICh0aGlzLnByb21wdEl0ZW1zLmxlbmd0aCA9PT0gMCAmJiB0aGlzLndhaXRJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCB3YWl0SXRlbSA9IHRoaXMud2FpdEl0ZW1zLnBvcCgpO1xuICAgICAgaWYgKHdhaXRJdGVtICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgd2FpdEl0ZW0oKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwdWJsaWMgaGFzUHJvbXB0cygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5wcm9tcHRJdGVtcy5sZW5ndGggPiAwO1xuICB9XG5cbiAgcHJpdmF0ZSByZWR1Y2Uoc3RhdGU6IFN0YXRlLCBhY3Rpb246IEFjdGlvbik6IFN0YXRlIHtcbiAgICBjb25zdCBzdGF0ZUJhY2t1cCA9IGRlZXBDbG9uZShzdGF0ZSwgWyBDYXJkIF0pO1xuICAgIHRoaXMucHJvbXB0SXRlbXMubGVuZ3RoID0gMDtcblxuICAgIHRyeSB7XG4gICAgICBzdGF0ZSA9IHNldHVwUGhhc2VSZWR1Y2VyKHRoaXMsIHN0YXRlLCBhY3Rpb24pO1xuICAgICAgc3RhdGUgPSBwbGF5Q2FyZFJlZHVjZXIodGhpcywgc3RhdGUsIGFjdGlvbik7XG4gICAgICBzdGF0ZSA9IHBsYXllclR1cm5SZWR1Y2VyKHRoaXMsIHN0YXRlLCBhY3Rpb24pO1xuXG4gICAgICB0aGlzLnJlc29sdmVXYWl0SXRlbXMoKTtcbiAgICAgIGlmICh0aGlzLnByb21wdEl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzdGF0ZSA9IGNoZWNrU3RhdGUodGhpcywgc3RhdGUpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKHN0b3JlRXJyb3IpIHtcbiAgICAgIC8vIElsbGVnYWwgYWN0aW9uXG4gICAgICB0aGlzLnN0YXRlID0gc3RhdGVCYWNrdXA7XG4gICAgICB0aGlzLnByb21wdEl0ZW1zLmxlbmd0aCA9IDA7XG4gICAgICB0aHJvdyBzdG9yZUVycm9yO1xuICAgIH1cblxuICAgIHRoaXMuaGFuZGxlci5vblN0YXRlQ2hhbmdlKHN0YXRlKTtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBwcml2YXRlIHByb3BhZ2F0ZUVmZmVjdChzdGF0ZTogU3RhdGUsIGVmZmVjdDogRWZmZWN0KTogU3RhdGUge1xuICAgIGNvbnN0IGNhcmRzOiBDYXJkW10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IHBsYXllciBvZiBzdGF0ZS5wbGF5ZXJzKSB7XG4gICAgICBwbGF5ZXIuc3RhZGl1bS5jYXJkcy5mb3JFYWNoKGMgPT4gY2FyZHMucHVzaChjKSk7XG4gICAgICBwbGF5ZXIuc3VwcG9ydGVyLmNhcmRzLmZvckVhY2goYyA9PiBjYXJkcy5wdXNoKGMpKTtcbiAgICAgIHBsYXllci5hY3RpdmUuY2FyZHMuZm9yRWFjaChjID0+IGNhcmRzLnB1c2goYykpO1xuICAgICAgZm9yIChjb25zdCBiZW5jaCBvZiBwbGF5ZXIuYmVuY2gpIHtcbiAgICAgICAgYmVuY2guY2FyZHMuZm9yRWFjaChjID0+IGNhcmRzLnB1c2goYykpO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBwcml6ZSBvZiBwbGF5ZXIucHJpemVzKSB7XG4gICAgICAgIHByaXplLmNhcmRzLmZvckVhY2goYyA9PiBjYXJkcy5wdXNoKGMpKTtcbiAgICAgIH1cbiAgICAgIHBsYXllci5oYW5kLmNhcmRzLmZvckVhY2goYyA9PiBjYXJkcy5wdXNoKGMpKTtcbiAgICAgIHBsYXllci5kZWNrLmNhcmRzLmZvckVhY2goYyA9PiBjYXJkcy5wdXNoKGMpKTtcbiAgICAgIHBsYXllci5kaXNjYXJkLmNhcmRzLmZvckVhY2goYyA9PiBjYXJkcy5wdXNoKGMpKTtcbiAgICB9XG4gICAgY2FyZHMuc29ydChjID0+IGMuc3VwZXJUeXBlKTtcbiAgICBjYXJkcy5mb3JFYWNoKGMgPT4geyBzdGF0ZSA9IGMucmVkdWNlRWZmZWN0KHRoaXMsIHN0YXRlLCBlZmZlY3QpOyB9KTtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cbn1cbiJdfQ==