"use strict";function cov_1bbtkx90sw(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/retreat-effect.ts";var hash="7b8e098d18ea46d06ff47858824406ee5771090b";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/retreat-effect.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:32}},"2":{start:{line:4,column:31},end:{line:4,column:73}},"3":{start:{line:5,column:21},end:{line:5,column:48}},"4":{start:{line:6,column:23},end:{line:6,column:52}},"5":{start:{line:7,column:23},end:{line:7,column:57}},"6":{start:{line:8,column:22},end:{line:8,column:47}},"7":{start:{line:9,column:24},end:{line:9,column:59}},"8":{start:{line:10,column:21},end:{line:10,column:50}},"9":{start:{line:12,column:19},end:{line:12,column:32}},"10":{start:{line:13,column:26},end:{line:13,column:56}},"11":{start:{line:14,column:27},end:{line:14,column:75}},"12":{start:{line:15,column:4},end:{line:17,column:5}},"13":{start:{line:16,column:8},end:{line:16,column:15}},"14":{start:{line:18,column:4},end:{line:22,column:7}},"15":{start:{line:23,column:4},end:{line:23,column:38}},"16":{start:{line:24,column:4},end:{line:24,column:58}},"17":{start:{line:28,column:4},end:{line:65,column:5}},"18":{start:{line:29,column:23},end:{line:29,column:36}},"19":{start:{line:30,column:8},end:{line:32,column:9}},"20":{start:{line:31,column:12},end:{line:31,column:88}},"21":{start:{line:33,column:19},end:{line:33,column:50}},"22":{start:{line:34,column:8},end:{line:36,column:9}},"23":{start:{line:35,column:12},end:{line:35,column:102}},"24":{start:{line:37,column:8},end:{line:39,column:9}},"25":{start:{line:38,column:12},end:{line:38,column:94}},"26":{start:{line:40,column:33},end:{line:40,column:90}},"27":{start:{line:41,column:8},end:{line:41,column:60}},"28":{start:{line:42,column:8},end:{line:45,column:9}},"29":{start:{line:43,column:12},end:{line:43,column:49}},"30":{start:{line:44,column:12},end:{line:44,column:25}},"31":{start:{line:46,column:36},end:{line:46,column:89}},"32":{start:{line:47,column:8},end:{line:47,column:63}},"33":{start:{line:48,column:31},end:{line:48,column:127}},"34":{start:{line:49,column:8},end:{line:51,column:9}},"35":{start:{line:50,column:12},end:{line:50,column:91}},"36":{start:{line:52,column:8},end:{line:64,column:11}},"37":{start:{line:53,column:12},end:{line:55,column:13}},"38":{start:{line:54,column:16},end:{line:54,column:23}},"39":{start:{line:56,column:34},end:{line:56,column:64}},"40":{start:{line:57,column:35},end:{line:57,column:83}},"41":{start:{line:58,column:12},end:{line:60,column:13}},"42":{start:{line:59,column:16},end:{line:59,column:23}},"43":{start:{line:61,column:26},end:{line:61,column:49}},"44":{start:{line:61,column:42},end:{line:61,column:48}},"45":{start:{line:62,column:12},end:{line:62,column:61}},"46":{start:{line:63,column:12},end:{line:63,column:49}},"47":{start:{line:66,column:4},end:{line:66,column:17}},"48":{start:{line:68,column:0},end:{line:68,column:40}}},fnMap:{"0":{name:"retreatPokemon",decl:{start:{line:11,column:9},end:{line:11,column:23}},loc:{start:{line:11,column:46},end:{line:25,column:1}},line:11},"1":{name:"retreatReducer",decl:{start:{line:26,column:9},end:{line:26,column:23}},loc:{start:{line:26,column:46},end:{line:67,column:1}},line:26},"2":{name:"(anonymous_2)",decl:{start:{line:52,column:200},end:{line:52,column:201}},loc:{start:{line:52,column:210},end:{line:64,column:9}},line:52},"3":{name:"(anonymous_3)",decl:{start:{line:61,column:37},end:{line:61,column:38}},loc:{start:{line:61,column:42},end:{line:61,column:48}},line:61}},branchMap:{"0":{loc:{start:{line:15,column:4},end:{line:17,column:5}},type:"if",locations:[{start:{line:15,column:4},end:{line:17,column:5}},{start:{line:15,column:4},end:{line:17,column:5}}],line:15},"1":{loc:{start:{line:15,column:8},end:{line:15,column:67}},type:"binary-expr",locations:[{start:{line:15,column:8},end:{line:15,column:35}},{start:{line:15,column:39},end:{line:15,column:67}}],line:15},"2":{loc:{start:{line:28,column:4},end:{line:65,column:5}},type:"if",locations:[{start:{line:28,column:4},end:{line:65,column:5}},{start:{line:28,column:4},end:{line:65,column:5}}],line:28},"3":{loc:{start:{line:30,column:8},end:{line:32,column:9}},type:"if",locations:[{start:{line:30,column:8},end:{line:32,column:9}},{start:{line:30,column:8},end:{line:32,column:9}}],line:30},"4":{loc:{start:{line:34,column:8},end:{line:36,column:9}},type:"if",locations:[{start:{line:34,column:8},end:{line:36,column:9}},{start:{line:34,column:8},end:{line:36,column:9}}],line:34},"5":{loc:{start:{line:34,column:12},end:{line:34,column:117}},type:"binary-expr",locations:[{start:{line:34,column:12},end:{line:34,column:64}},{start:{line:34,column:68},end:{line:34,column:117}}],line:34},"6":{loc:{start:{line:37,column:8},end:{line:39,column:9}},type:"if",locations:[{start:{line:37,column:8},end:{line:39,column:9}},{start:{line:37,column:8},end:{line:39,column:9}}],line:37},"7":{loc:{start:{line:42,column:8},end:{line:45,column:9}},type:"if",locations:[{start:{line:42,column:8},end:{line:45,column:9}},{start:{line:42,column:8},end:{line:45,column:9}}],line:42},"8":{loc:{start:{line:49,column:8},end:{line:51,column:9}},type:"if",locations:[{start:{line:49,column:8},end:{line:51,column:9}},{start:{line:49,column:8},end:{line:51,column:9}}],line:49},"9":{loc:{start:{line:53,column:12},end:{line:55,column:13}},type:"if",locations:[{start:{line:53,column:12},end:{line:55,column:13}},{start:{line:53,column:12},end:{line:55,column:13}}],line:53},"10":{loc:{start:{line:58,column:12},end:{line:60,column:13}},type:"if",locations:[{start:{line:58,column:12},end:{line:60,column:13}},{start:{line:58,column:12},end:{line:60,column:13}}],line:58},"11":{loc:{start:{line:58,column:16},end:{line:58,column:75}},type:"binary-expr",locations:[{start:{line:58,column:16},end:{line:58,column:43}},{start:{line:58,column:47},end:{line:58,column:75}}],line:58}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/retreat-effect.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/effect-reducers/retreat-effect.ts"],names:[],mappings:"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",sourcesContent:["import { ChooseEnergyPrompt } from '../prompts/choose-energy-prompt';\nimport { GameError } from '../../game-error';\nimport { GameMessage, GameLog } from '../../game-message';\nimport { Effect } from '../effects/effect';\nimport { State } from '../state/state';\nimport { StoreLike } from '../store-like';\nimport { RetreatEffect } from '../effects/game-effects';\nimport { StateUtils } from '../state-utils';\nimport { CheckRetreatCostEffect, CheckProvidedEnergyEffect } from '../effects/check-effects';\nimport { SpecialCondition } from '../card/card-types';\n\n\nfunction retreatPokemon(store: StoreLike, state: State, effect: RetreatEffect) {\n  const player = effect.player;\n  const activePokemon = player.active.getPokemonCard();\n  const benchedPokemon = player.bench[effect.benchIndex].getPokemonCard();\n  if (activePokemon === undefined || benchedPokemon === undefined) {\n    return;\n  }\n\n  store.log(state, GameLog.LOG_PLAYER_RETREATS, {\n    name: player.name,\n    active: activePokemon.name,\n    benched: benchedPokemon.name\n  });\n  player.retreatedTurn = state.turn;\n  player.switchPokemon(player.bench[effect.benchIndex]);\n}\n\nexport function retreatReducer(store: StoreLike, state: State, effect: Effect): State {\n\n  /* Retreat pokemon */\n  if (effect instanceof RetreatEffect) {\n    const player = effect.player;\n\n    if (player.bench[effect.benchIndex].cards.length === 0) {\n      throw new GameError(GameMessage.INVALID_TARGET);\n    }\n\n    const sp = player.active.specialConditions;\n    if (sp.includes(SpecialCondition.PARALYZED) || sp.includes(SpecialCondition.ASLEEP)) {\n      throw new GameError(GameMessage.BLOCKED_BY_SPECIAL_CONDITION);\n    }\n\n    if (player.retreatedTurn === state.turn) {\n      throw new GameError(GameMessage.RETREAT_ALREADY_USED);\n    }\n\n    const checkRetreatCost = new CheckRetreatCostEffect(effect.player);\n    state = store.reduceEffect(state, checkRetreatCost);\n\n    if (checkRetreatCost.cost.length === 0) {\n      retreatPokemon(store, state, effect);\n      return state;\n    }\n\n    const checkProvidedEnergy = new CheckProvidedEnergyEffect(player);\n    state = store.reduceEffect(state, checkProvidedEnergy);\n\n    const enoughEnergies = StateUtils.checkEnoughEnergy(checkProvidedEnergy.energyMap, checkRetreatCost.cost);\n    if (enoughEnergies === false) {\n      throw new GameError(GameMessage.NOT_ENOUGH_ENERGY);\n    }\n\n    return store.prompt(state, new ChooseEnergyPrompt(\n      player.id,\n      GameMessage.CHOOSE_POKEMON_TO_SWITCH,\n      checkProvidedEnergy.energyMap,\n      checkRetreatCost.cost\n    ), energy => {\n      if (energy === null) {\n        return; // operation cancelled\n      }\n      const activePokemon = player.active.getPokemonCard();\n      const benchedPokemon = player.bench[effect.benchIndex].getPokemonCard();\n      if (activePokemon === undefined || benchedPokemon === undefined) {\n        return;\n      }\n\n      const cards = energy.map(e => e.card);\n      player.active.moveCardsTo(cards, player.discard);\n      retreatPokemon(store, state, effect);\n    });\n  }\n\n  return state;\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"7b8e098d18ea46d06ff47858824406ee5771090b"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1bbtkx90sw=function(){return actualCoverage;};}return actualCoverage;}cov_1bbtkx90sw();cov_1bbtkx90sw().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1bbtkx90sw().s[1]++;exports.retreatReducer=void 0;const choose_energy_prompt_1=(cov_1bbtkx90sw().s[2]++,require("../prompts/choose-energy-prompt"));const game_error_1=(cov_1bbtkx90sw().s[3]++,require("../../game-error"));const game_message_1=(cov_1bbtkx90sw().s[4]++,require("../../game-message"));const game_effects_1=(cov_1bbtkx90sw().s[5]++,require("../effects/game-effects"));const state_utils_1=(cov_1bbtkx90sw().s[6]++,require("../state-utils"));const check_effects_1=(cov_1bbtkx90sw().s[7]++,require("../effects/check-effects"));const card_types_1=(cov_1bbtkx90sw().s[8]++,require("../card/card-types"));function retreatPokemon(store,state,effect){cov_1bbtkx90sw().f[0]++;const player=(cov_1bbtkx90sw().s[9]++,effect.player);const activePokemon=(cov_1bbtkx90sw().s[10]++,player.active.getPokemonCard());const benchedPokemon=(cov_1bbtkx90sw().s[11]++,player.bench[effect.benchIndex].getPokemonCard());cov_1bbtkx90sw().s[12]++;if((cov_1bbtkx90sw().b[1][0]++,activePokemon===undefined)||(cov_1bbtkx90sw().b[1][1]++,benchedPokemon===undefined)){cov_1bbtkx90sw().b[0][0]++;cov_1bbtkx90sw().s[13]++;return;}else{cov_1bbtkx90sw().b[0][1]++;}cov_1bbtkx90sw().s[14]++;store.log(state,game_message_1.GameLog.LOG_PLAYER_RETREATS,{name:player.name,active:activePokemon.name,benched:benchedPokemon.name});cov_1bbtkx90sw().s[15]++;player.retreatedTurn=state.turn;cov_1bbtkx90sw().s[16]++;player.switchPokemon(player.bench[effect.benchIndex]);}function retreatReducer(store,state,effect){cov_1bbtkx90sw().f[1]++;cov_1bbtkx90sw().s[17]++;/* Retreat pokemon */if(effect instanceof game_effects_1.RetreatEffect){cov_1bbtkx90sw().b[2][0]++;const player=(cov_1bbtkx90sw().s[18]++,effect.player);cov_1bbtkx90sw().s[19]++;if(player.bench[effect.benchIndex].cards.length===0){cov_1bbtkx90sw().b[3][0]++;cov_1bbtkx90sw().s[20]++;throw new game_error_1.GameError(game_message_1.GameMessage.INVALID_TARGET);}else{cov_1bbtkx90sw().b[3][1]++;}const sp=(cov_1bbtkx90sw().s[21]++,player.active.specialConditions);cov_1bbtkx90sw().s[22]++;if((cov_1bbtkx90sw().b[5][0]++,sp.includes(card_types_1.SpecialCondition.PARALYZED))||(cov_1bbtkx90sw().b[5][1]++,sp.includes(card_types_1.SpecialCondition.ASLEEP))){cov_1bbtkx90sw().b[4][0]++;cov_1bbtkx90sw().s[23]++;throw new game_error_1.GameError(game_message_1.GameMessage.BLOCKED_BY_SPECIAL_CONDITION);}else{cov_1bbtkx90sw().b[4][1]++;}cov_1bbtkx90sw().s[24]++;if(player.retreatedTurn===state.turn){cov_1bbtkx90sw().b[6][0]++;cov_1bbtkx90sw().s[25]++;throw new game_error_1.GameError(game_message_1.GameMessage.RETREAT_ALREADY_USED);}else{cov_1bbtkx90sw().b[6][1]++;}const checkRetreatCost=(cov_1bbtkx90sw().s[26]++,new check_effects_1.CheckRetreatCostEffect(effect.player));cov_1bbtkx90sw().s[27]++;state=store.reduceEffect(state,checkRetreatCost);cov_1bbtkx90sw().s[28]++;if(checkRetreatCost.cost.length===0){cov_1bbtkx90sw().b[7][0]++;cov_1bbtkx90sw().s[29]++;retreatPokemon(store,state,effect);cov_1bbtkx90sw().s[30]++;return state;}else{cov_1bbtkx90sw().b[7][1]++;}const checkProvidedEnergy=(cov_1bbtkx90sw().s[31]++,new check_effects_1.CheckProvidedEnergyEffect(player));cov_1bbtkx90sw().s[32]++;state=store.reduceEffect(state,checkProvidedEnergy);const enoughEnergies=(cov_1bbtkx90sw().s[33]++,state_utils_1.StateUtils.checkEnoughEnergy(checkProvidedEnergy.energyMap,checkRetreatCost.cost));cov_1bbtkx90sw().s[34]++;if(enoughEnergies===false){cov_1bbtkx90sw().b[8][0]++;cov_1bbtkx90sw().s[35]++;throw new game_error_1.GameError(game_message_1.GameMessage.NOT_ENOUGH_ENERGY);}else{cov_1bbtkx90sw().b[8][1]++;}cov_1bbtkx90sw().s[36]++;return store.prompt(state,new choose_energy_prompt_1.ChooseEnergyPrompt(player.id,game_message_1.GameMessage.CHOOSE_POKEMON_TO_SWITCH,checkProvidedEnergy.energyMap,checkRetreatCost.cost),energy=>{cov_1bbtkx90sw().f[2]++;cov_1bbtkx90sw().s[37]++;if(energy===null){cov_1bbtkx90sw().b[9][0]++;cov_1bbtkx90sw().s[38]++;return;// operation cancelled
}else{cov_1bbtkx90sw().b[9][1]++;}const activePokemon=(cov_1bbtkx90sw().s[39]++,player.active.getPokemonCard());const benchedPokemon=(cov_1bbtkx90sw().s[40]++,player.bench[effect.benchIndex].getPokemonCard());cov_1bbtkx90sw().s[41]++;if((cov_1bbtkx90sw().b[11][0]++,activePokemon===undefined)||(cov_1bbtkx90sw().b[11][1]++,benchedPokemon===undefined)){cov_1bbtkx90sw().b[10][0]++;cov_1bbtkx90sw().s[42]++;return;}else{cov_1bbtkx90sw().b[10][1]++;}const cards=(cov_1bbtkx90sw().s[43]++,energy.map(e=>{cov_1bbtkx90sw().f[3]++;cov_1bbtkx90sw().s[44]++;return e.card;}));cov_1bbtkx90sw().s[45]++;player.active.moveCardsTo(cards,player.discard);cov_1bbtkx90sw().s[46]++;retreatPokemon(store,state,effect);});}else{cov_1bbtkx90sw().b[2][1]++;}cov_1bbtkx90sw().s[47]++;return state;}cov_1bbtkx90sw().s[48]++;exports.retreatReducer=retreatReducer;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvZWZmZWN0LXJlZHVjZXJzL3JldHJlYXQtZWZmZWN0LnRzIiwic291cmNlcyI6WyIvVXNlcnMvam9lbXllcnNjb3VnaC9Eb2N1bWVudHMvR2l0SHViL3B0Y2ctZXBzZC9wdGNnLXNlcnZlci9zcmMvZ2FtZS9zdG9yZS9lZmZlY3QtcmVkdWNlcnMvcmV0cmVhdC1lZmZlY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsMEVBQXFFO0FBQ3JFLGlEQUE2QztBQUM3QyxxREFBMEQ7QUFJMUQsMERBQXdEO0FBQ3hELGdEQUE0QztBQUM1Qyw0REFBNkY7QUFDN0YsbURBQXNEO0FBR3RELFNBQVMsY0FBYyxDQUFDLEtBQWdCLEVBQUUsS0FBWSxFQUFFLE1BQXFCO0lBQzNFLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7SUFDN0IsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUNyRCxNQUFNLGNBQWMsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN4RSxJQUFJLGFBQWEsS0FBSyxTQUFTLElBQUksY0FBYyxLQUFLLFNBQVMsRUFBRTtRQUMvRCxPQUFPO0tBQ1I7SUFFRCxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxzQkFBTyxDQUFDLG1CQUFtQixFQUFFO1FBQzVDLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSTtRQUNqQixNQUFNLEVBQUUsYUFBYSxDQUFDLElBQUk7UUFDMUIsT0FBTyxFQUFFLGNBQWMsQ0FBQyxJQUFJO0tBQzdCLENBQUMsQ0FBQztJQUNILE1BQU0sQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQztJQUNsQyxNQUFNLENBQUMsYUFBYSxDQUFD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LE9BQU8sQ0FBQyxDQUFDO1lBQ2pELGNBQWMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO0tBQ0o7SUFFRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUF6REQsd0NBeURDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hvb3NlRW5lcmd5UHJvbXB0IH0gZnJvbSAnLi4vcHJvbXB0cy9jaG9vc2UtZW5lcmd5LXByb21wdCc7XG5pbXBvcnQgeyBHYW1lRXJyb3IgfSBmcm9tICcuLi8uLi9nYW1lLWVycm9yJztcbmltcG9ydCB7IEdhbWVNZXNzYWdlLCBHYW1lTG9nIH0gZnJvbSAnLi4vLi4vZ2FtZS1tZXNzYWdlJztcbmltcG9ydCB7IEVmZmVjdCB9IGZyb20gJy4uL2VmZmVjdHMvZWZmZWN0JztcbmltcG9ydCB7IFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvc3RhdGUnO1xuaW1wb3J0IHsgU3RvcmVMaWtlIH0gZnJvbSAnLi4vc3RvcmUtbGlrZSc7XG5pbXBvcnQgeyBSZXRyZWF0RWZmZWN0IH0gZnJvbSAnLi4vZWZmZWN0cy9nYW1lLWVmZmVjdHMnO1xuaW1wb3J0IHsgU3RhdGVVdGlscyB9IGZyb20gJy4uL3N0YXRlLXV0aWxzJztcbmltcG9ydCB7IENoZWNrUmV0cmVhdENvc3RFZmZlY3QsIENoZWNrUHJvdmlkZWRFbmVyZ3lFZmZlY3QgfSBmcm9tICcuLi9lZmZlY3RzL2NoZWNrLWVmZmVjdHMnO1xuaW1wb3J0IHsgU3BlY2lhbENvbmRpdGlvbiB9IGZyb20gJy4uL2NhcmQvY2FyZC10eXBlcyc7XG5cblxuZnVuY3Rpb24gcmV0cmVhdFBva2Vtb24oc3RvcmU6IFN0b3JlTGlrZSwgc3RhdGU6IFN0YXRlLCBlZmZlY3Q6IFJldHJlYXRFZmZlY3QpIHtcbiAgY29uc3QgcGxheWVyID0gZWZmZWN0LnBsYXllcjtcbiAgY29uc3QgYWN0aXZlUG9rZW1vbiA9IHBsYXllci5hY3RpdmUuZ2V0UG9rZW1vbkNhcmQoKTtcbiAgY29uc3QgYmVuY2hlZFBva2Vtb24gPSBwbGF5ZXIuYmVuY2hbZWZmZWN0LmJlbmNoSW5kZXhdLmdldFBva2Vtb25DYXJkKCk7XG4gIGlmIChhY3RpdmVQb2tlbW9uID09PSB1bmRlZmluZWQgfHwgYmVuY2hlZFBva2Vtb24gPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHN0b3JlLmxvZyhzdGF0ZSwgR2FtZUxvZy5MT0dfUExBWUVSX1JFVFJFQVRTLCB7XG4gICAgbmFtZTogcGxheWVyLm5hbWUsXG4gICAgYWN0aXZlOiBhY3RpdmVQb2tlbW9uLm5hbWUsXG4gICAgYmVuY2hlZDogYmVuY2hlZFBva2Vtb24ubmFtZVxuICB9KTtcbiAgcGxheWVyLnJldHJlYXRlZFR1cm4gPSBzdGF0ZS50dXJuO1xuICBwbGF5ZXIuc3dpdGNoUG9rZW1vbihwbGF5ZXIuYmVuY2hbZWZmZWN0LmJlbmNoSW5kZXhdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJldHJlYXRSZWR1Y2VyKHN0b3JlOiBTdG9yZUxpa2UsIHN0YXRlOiBTdGF0ZSwgZWZmZWN0OiBFZmZlY3QpOiBTdGF0ZSB7XG5cbiAgLyogUmV0cmVhdCBwb2tlbW9uICovXG4gIGlmIChlZmZlY3QgaW5zdGFuY2VvZiBSZXRyZWF0RWZmZWN0KSB7XG4gICAgY29uc3QgcGxheWVyID0gZWZmZWN0LnBsYXllcjtcblxuICAgIGlmIChwbGF5ZXIuYmVuY2hbZWZmZWN0LmJlbmNoSW5kZXhdLmNhcmRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTlZBTElEX1RBUkdFVCk7XG4gICAgfVxuXG4gICAgY29uc3Qgc3AgPSBwbGF5ZXIuYWN0aXZlLnNwZWNpYWxDb25kaXRpb25zO1xuICAgIGlmIChzcC5pbmNsdWRlcyhTcGVjaWFsQ29uZGl0aW9uLlBBUkFMWVpFRCkgfHwgc3AuaW5jbHVkZXMoU3BlY2lhbENvbmRpdGlvbi5BU0xFRVApKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLkJMT0NLRURfQllfU1BFQ0lBTF9DT05ESVRJT04pO1xuICAgIH1cblxuICAgIGlmIChwbGF5ZXIucmV0cmVhdGVkVHVybiA9PT0gc3RhdGUudHVybikge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5SRVRSRUFUX0FMUkVBRFlfVVNFRCk7XG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tSZXRyZWF0Q29zdCA9IG5ldyBDaGVja1JldHJlYXRDb3N0RWZmZWN0KGVmZmVjdC5wbGF5ZXIpO1xuICAgIHN0YXRlID0gc3RvcmUucmVkdWNlRWZmZWN0KHN0YXRlLCBjaGVja1JldHJlYXRDb3N0KTtcblxuICAgIGlmIChjaGVja1JldHJlYXRDb3N0LmNvc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXRyZWF0UG9rZW1vbihzdG9yZSwgc3RhdGUsIGVmZmVjdCk7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tQcm92aWRlZEVuZXJneSA9IG5ldyBDaGVja1Byb3ZpZGVkRW5lcmd5RWZmZWN0KHBsYXllcik7XG4gICAgc3RhdGUgPSBzdG9yZS5yZWR1Y2VFZmZlY3Qoc3RhdGUsIGNoZWNrUHJvdmlkZWRFbmVyZ3kpO1xuXG4gICAgY29uc3QgZW5vdWdoRW5lcmdpZXMgPSBTdGF0ZVV0aWxzLmNoZWNrRW5vdWdoRW5lcmd5KGNoZWNrUHJvdmlkZWRFbmVyZ3kuZW5lcmd5TWFwLCBjaGVja1JldHJlYXRDb3N0LmNvc3QpO1xuICAgIGlmIChlbm91Z2hFbmVyZ2llcyA9PT0gZmFsc2UpIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuTk9UX0VOT1VHSF9FTkVSR1kpO1xuICAgIH1cblxuICAgIHJldHVybiBzdG9yZS5wcm9tcHQoc3RhdGUsIG5ldyBDaG9vc2VFbmVyZ3lQcm9tcHQoXG4gICAgICBwbGF5ZXIuaWQsXG4gICAgICBHYW1lTWVzc2FnZS5DSE9PU0VfUE9LRU1PTl9UT19TV0lUQ0gsXG4gICAgICBjaGVja1Byb3ZpZGVkRW5lcmd5LmVuZXJneU1hcCxcbiAgICAgIGNoZWNrUmV0cmVhdENvc3QuY29zdFxuICAgICksIGVuZXJneSA9PiB7XG4gICAgICBpZiAoZW5lcmd5ID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybjsgLy8gb3BlcmF0aW9uIGNhbmNlbGxlZFxuICAgICAgfVxuICAgICAgY29uc3QgYWN0aXZlUG9rZW1vbiA9IHBsYXllci5hY3RpdmUuZ2V0UG9rZW1vbkNhcmQoKTtcbiAgICAgIGNvbnN0IGJlbmNoZWRQb2tlbW9uID0gcGxheWVyLmJlbmNoW2VmZmVjdC5iZW5jaEluZGV4XS5nZXRQb2tlbW9uQ2FyZCgpO1xuICAgICAgaWYgKGFjdGl2ZVBva2Vtb24gPT09IHVuZGVmaW5lZCB8fCBiZW5jaGVkUG9rZW1vbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FyZHMgPSBlbmVyZ3kubWFwKGUgPT4gZS5jYXJkKTtcbiAgICAgIHBsYXllci5hY3RpdmUubW92ZUNhcmRzVG8oY2FyZHMsIHBsYXllci5kaXNjYXJkKTtcbiAgICAgIHJldHJlYXRQb2tlbW9uKHN0b3JlLCBzdGF0ZSwgZWZmZWN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBzdGF0ZTtcbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL2VmZmVjdC1yZWR1Y2Vycy9yZXRyZWF0LWVmZmVjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoidWtaQWlCSTtrT0FqQkosS0FBQSxDQUFBLHNCQUFBLDBCQUFBLE9BQUEsQ0FBQSxpQ0FBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsWUFBQSwwQkFBQSxPQUFBLENBQUEsa0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGNBQUEsMEJBQUEsT0FBQSxDQUFBLG9CQUFBLENBQUEsQ0FBQSxDQUlBLEtBQUEsQ0FBQSxjQUFBLDBCQUFBLE9BQUEsQ0FBQSx5QkFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsYUFBQSwwQkFBQSxPQUFBLENBQUEsZ0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGVBQUEsMEJBQUEsT0FBQSxDQUFBLDBCQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxZQUFBLDBCQUFBLE9BQUEsQ0FBQSxvQkFBQSxDQUFBLENBQUEsQ0FHQSxRQUFTLENBQUEsY0FBVCxDQUF3QixLQUF4QixDQUEwQyxLQUExQyxDQUF3RCxNQUF4RCxDQUE2RSx5QkFDM0UsS0FBTSxDQUFBLE1BQU0sMEJBQUcsTUFBTSxDQUFDLE1BQVYsQ0FBWixDQUNBLEtBQU0sQ0FBQSxhQUFhLDJCQUFHLE1BQU0sQ0FBQyxNQUFQLENBQWMsY0FBZCxFQUFILENBQW5CLENBQ0EsS0FBTSxDQUFBLGNBQWMsMkJBQUcsTUFBTSxDQUFDLEtBQVAsQ0FBYSxNQUFNLENBQUMsVUFBcEIsRUFBZ0MsY0FBaEMsRUFBSCxDQUFwQixDQUgyRSx5QkFJM0UsR0FBSSw0QkFBQSxhQUFhLEdBQUssU0FBbEIsK0JBQStCLGNBQWMsR0FBSyxTQUFsRCxDQUFKLENBQWlFLHFEQUMvRCxPQUNELENBRkQsaUNBSjJFLHlCQVEzRSxLQUFL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QUFDLE1BQU4sQ0FBYSxLQUFiLENBQW9CLEdBQUksQ0FBQSxzQkFBQSxDQUFBLGtCQUFKLENBQ3pCLE1BQU0sQ0FBQyxFQURrQixDQUV6QixjQUFBLENBQUEsV0FBQSxDQUFZLHdCQUZhLENBR3pCLG1CQUFtQixDQUFDLFNBSEssQ0FJekIsZ0JBQWdCLENBQUMsSUFKUSxDQUFwQixDQUtKLE1BQU0sRUFBRyxrREFDVixHQUFJLE1BQU0sR0FBSyxJQUFmLENBQXFCLHFEQUNuQixPQUFRO0FBQ1QsQ0FGRCxpQ0FHQSxLQUFNLENBQUEsYUFBYSwyQkFBRyxNQUFNLENBQUMsTUFBUCxDQUFjLGNBQWQsRUFBSCxDQUFuQixDQUNBLEtBQU0sQ0FBQSxjQUFjLDJCQUFHLE1BQU0sQ0FBQyxLQUFQLENBQWEsTUFBTSxDQUFDLFVBQXBCLEVBQWdDLGNBQWhDLEVBQUgsQ0FBcEIsQ0FMVSx5QkFNVixHQUFJLDZCQUFBLGFBQWEsR0FBSyxTQUFsQixnQ0FBK0IsY0FBYyxHQUFLLFNBQWxELENBQUosQ0FBaUUsc0RBQy9ELE9BQ0QsQ0FGRCxrQ0FJQSxLQUFNLENBQUEsS0FBSywyQkFBRyxNQUFNLENBQUMsR0FBUCxDQUFXLENBQUMsRUFBSSx3REFBQSxDQUFBLENBQUMsQ0FBQyxJQUFGLENBQU0sQ0FBdEIsQ0FBSCxDQUFYLENBVlUseUJBV1YsTUFBTSxDQUFDLE1BQVAsQ0FBYyxXQUFkLENBQTBCLEtBQTFCLENBQWlDLE1BQU0sQ0FBQyxPQUF4QyxFQVhVLHlCQVlWLGNBQWMsQ0FBQyxLQUFELENBQVEsS0FBUixDQUFlLE1BQWYsQ0FBZCxDQUNELENBbEJNLENBQVAsQ0FtQkQsQ0FuREQsaUNBSDJFLHlCQXdEM0UsTUFBTyxDQUFBLEtBQVAsQ0FDRCxDLHlCQXpERCxPQUFBLENBQUEsY0FBQSxDQUFBLGNBQUEsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENob29zZUVuZXJneVByb21wdCB9IGZyb20gJy4uL3Byb21wdHMvY2hvb3NlLWVuZXJneS1wcm9tcHQnO1xuaW1wb3J0IHsgR2FtZUVycm9yIH0gZnJvbSAnLi4vLi4vZ2FtZS1lcnJvcic7XG5pbXBvcnQgeyBHYW1lTWVzc2FnZSwgR2FtZUxvZyB9IGZyb20gJy4uLy4uL2dhbWUtbWVzc2FnZSc7XG5pbXBvcnQgeyBFZmZlY3QgfSBmcm9tICcuLi9lZmZlY3RzL2VmZmVjdCc7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3N0YXRlJztcbmltcG9ydCB7IFN0b3JlTGlrZSB9IGZyb20gJy4uL3N0b3JlLWxpa2UnO1xuaW1wb3J0IHsgUmV0cmVhdEVmZmVjdCB9IGZyb20gJy4uL2VmZmVjdHMvZ2FtZS1lZmZlY3RzJztcbmltcG9ydCB7IFN0YXRlVXRpbHMgfSBmcm9tICcuLi9zdGF0ZS11dGlscyc7XG5pbXBvcnQgeyBDaGVja1JldHJlYXRDb3N0RWZmZWN0LCBDaGVja1Byb3ZpZGVkRW5lcmd5RWZmZWN0IH0gZnJvbSAnLi4vZWZmZWN0cy9jaGVjay1lZmZlY3RzJztcbmltcG9ydCB7IFNwZWNpYWxDb25kaXRpb24gfSBmcm9tICcuLi9jYXJkL2NhcmQtdHlwZXMnO1xuXG5cbmZ1bmN0aW9uIHJldHJlYXRQb2tlbW9uKHN0b3JlOiBTdG9yZUxpa2UsIHN0YXRlOiBTdGF0ZSwgZWZmZWN0OiBSZXRyZWF0RWZmZWN0KSB7XG4gIGNvbnN0IHBsYXllciA9IGVmZmVjdC5wbGF5ZXI7XG4gIGNvbnN0IGFjdGl2ZVBva2Vtb24gPSBwbGF5ZXIuYWN0aXZlLmdldFBva2Vtb25DYXJkKCk7XG4gIGNvbnN0IGJlbmNoZWRQb2tlbW9uID0gcGxheWVyLmJlbmNoW2VmZmVjdC5iZW5jaEluZGV4XS5nZXRQb2tlbW9uQ2FyZCgpO1xuICBpZiAoYWN0aXZlUG9rZW1vbiA9PT0gdW5kZWZpbmVkIHx8IGJlbmNoZWRQb2tlbW9uID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBzdG9yZS5sb2coc3RhdGUsIEdhbWVMb2cuTE9HX1BMQVlFUl9SRVRSRUFUUywge1xuICAgIG5hbWU6IHBsYXllci5uYW1lLFxuICAgIGFjdGl2ZTogYWN0aXZlUG9rZW1vbi5uYW1lLFxuICAgIGJlbmNoZWQ6IGJlbmNoZWRQb2tlbW9uLm5hbWVcbiAgfSk7XG4gIHBsYXllci5yZXRyZWF0ZWRUdXJuID0gc3RhdGUudHVybjtcbiAgcGxheWVyLnN3aXRjaFBva2Vtb24ocGxheWVyLmJlbmNoW2VmZmVjdC5iZW5jaEluZGV4XSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXRyZWF0UmVkdWNlcihzdG9yZTogU3RvcmVMaWtlLCBzdGF0ZTogU3RhdGUsIGVmZmVjdDogRWZmZWN0KTogU3RhdGUge1xuXG4gIC8qIFJldHJlYXQgcG9rZW1vbiAqL1xuICBpZiAoZWZmZWN0IGluc3RhbmNlb2YgUmV0cmVhdEVmZmVjdCkge1xuICAgIGNvbnN0IHBsYXllciA9IGVmZmVjdC5wbGF5ZXI7XG5cbiAgICBpZiAocGxheWVyLmJlbmNoW2VmZmVjdC5iZW5jaEluZGV4XS5jYXJkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuSU5WQUxJRF9UQVJHRVQpO1xuICAgIH1cblxuICAgIGNvbnN0IHNwID0gcGxheWVyLmFjdGl2ZS5zcGVjaWFsQ29uZGl0aW9ucztcbiAgICBpZiAoc3AuaW5jbHVkZXMoU3BlY2lhbENvbmRpdGlvbi5QQVJBTFlaRUQpIHx8IHNwLmluY2x1ZGVzKFNwZWNpYWxDb25kaXRpb24uQVNMRUVQKSkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5CTE9DS0VEX0JZX1NQRUNJQUxfQ09ORElUSU9OKTtcbiAgICB9XG5cbiAgICBpZiAocGxheWVyLnJldHJlYXRlZFR1cm4gPT09IHN0YXRlLnR1cm4pIHtcbiAgICAgIHRocm93IG5ldyBHYW1lRXJyb3IoR2FtZU1lc3NhZ2UuUkVUUkVBVF9BTFJFQURZX1VTRUQpO1xuICAgIH1cblxuICAgIGNvbnN0IGNoZWNrUmV0cmVhdENvc3QgPSBuZXcgQ2hlY2tSZXRyZWF0Q29zdEVmZmVjdChlZmZlY3QucGxheWVyKTtcbiAgICBzdGF0ZSA9IHN0b3JlLnJlZHVjZUVmZmVjdChzdGF0ZSwgY2hlY2tSZXRyZWF0Q29zdCk7XG5cbiAgICBpZiAoY2hlY2tSZXRyZWF0Q29zdC5jb3N0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0cmVhdFBva2Vtb24oc3RvcmUsIHN0YXRlLCBlZmZlY3QpO1xuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIGNvbnN0IGNoZWNrUHJvdmlkZWRFbmVyZ3kgPSBuZXcgQ2hlY2tQcm92aWRlZEVuZXJneUVmZmVjdChwbGF5ZXIpO1xuICAgIHN0YXRlID0gc3RvcmUucmVkdWNlRWZmZWN0KHN0YXRlLCBjaGVja1Byb3ZpZGVkRW5lcmd5KTtcblxuICAgIGNvbnN0IGVub3VnaEVuZXJnaWVzID0gU3RhdGVVdGlscy5jaGVja0Vub3VnaEVuZXJneShjaGVja1Byb3ZpZGVkRW5lcmd5LmVuZXJneU1hcCwgY2hlY2tSZXRyZWF0Q29zdC5jb3N0KTtcbiAgICBpZiAoZW5vdWdoRW5lcmdpZXMgPT09IGZhbHNlKSB7XG4gICAgICB0aHJvdyBuZXcgR2FtZUVycm9yKEdhbWVNZXNzYWdlLk5PVF9FTk9VR0hfRU5FUkdZKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RvcmUucHJvbXB0KHN0YXRlLCBuZXcgQ2hvb3NlRW5lcmd5UHJvbXB0KFxuICAgICAgcGxheWVyLmlkLFxuICAgICAgR2FtZU1lc3NhZ2UuQ0hPT1NFX1BPS0VNT05fVE9fU1dJVENILFxuICAgICAgY2hlY2tQcm92aWRlZEVuZXJneS5lbmVyZ3lNYXAsXG4gICAgICBjaGVja1JldHJlYXRDb3N0LmNvc3RcbiAgICApLCBlbmVyZ3kgPT4ge1xuICAgICAgaWYgKGVuZXJneSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm47IC8vIG9wZXJhdGlvbiBjYW5jZWxsZWRcbiAgICAgIH1cbiAgICAgIGNvbnN0IGFjdGl2ZVBva2Vtb24gPSBwbGF5ZXIuYWN0aXZlLmdldFBva2Vtb25DYXJkKCk7XG4gICAgICBjb25zdCBiZW5jaGVkUG9rZW1vbiA9IHBsYXllci5iZW5jaFtlZmZlY3QuYmVuY2hJbmRleF0uZ2V0UG9rZW1vbkNhcmQoKTtcbiAgICAgIGlmIChhY3RpdmVQb2tlbW9uID09PSB1bmRlZmluZWQgfHwgYmVuY2hlZFBva2Vtb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNhcmRzID0gZW5lcmd5Lm1hcChlID0+IGUuY2FyZCk7XG4gICAgICBwbGF5ZXIuYWN0aXZlLm1vdmVDYXJkc1RvKGNhcmRzLCBwbGF5ZXIuZGlzY2FyZCk7XG4gICAgICByZXRyZWF0UG9rZW1vbihzdG9yZSwgc3RhdGUsIGVmZmVjdCk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gc3RhdGU7XG59XG4iXX0=