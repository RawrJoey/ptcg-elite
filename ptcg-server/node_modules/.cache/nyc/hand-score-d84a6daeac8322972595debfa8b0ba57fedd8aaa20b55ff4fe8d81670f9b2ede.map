{"version":3,"file":"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/state-score/hand-score.ts","sources":["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/simple-bot/state-score/hand-score.ts"],"names":[],"mappings":";;;AAAA,qCAA+C;AAC/C,mCAAsC;AACtC,mEAA+D;AAC/D,qEAAiE;AACjE,iEAAsE;AACtE,qEAAiE;AAGjE,MAAa,SAAU,SAAQ,mBAAW;IAEjC,QAAQ,CAAC,KAAY,EAAE,QAAgB;QAC5C,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;QAC/C,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC;QAExC,MAAM,YAAY,GAAG,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;QAEnE,MAAM,gBAAgB,GAAa,EAAE,CAAC;QACtC,MAAM,CAAC,cAAc,CAAC,iBAAU,CAAC,aAAa,EAAE,CAAC,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE;YACzE,IAAI,QAAQ,CAAC,iBAAiB,GAAG,KAAK,CAAC,IAAI,EAAE;gBAC3C,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAClC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,IAAI,SAAS,GAAG,KAAK,CAAC;QACtB,IAAI,UAAU,GAAG,KAAK,CAAC;QACvB,IAAI,QAAQ,GAAG,KAAK,CAAC;QACrB,IAAI,YAAY,GAAG,KAAK,CAAC;QAEzB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;YAC5B,IAAI,CAAC,YAAY,wBAAU,EAAE;gBAC3B,SAAS,GAAG,IAAI,CAAC;gBACjB,KAAK,IAAI,MAAM,CAAC,SAAS,CAAC;aAC3B;iBAAM,IAAI,CAAC,YAAY,0BAAW,EAAE;gBACnC,UAAU,GAAG,IAAI,CAAC;gBAClB,KAAK,IAAI,MAAM,CAAC,SAAS,CAAC;gBAC1B,IAAI,CAAC,CAAC,KAAK,KAAK,kBAAK,CAAC,KAAK,EAAE;oBAC3B,QAAQ,GAAG,IAAI,CAAC;iBACjB;gBACD,MAAM,KAAK,GAAG,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;gBACtD,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;oBAChB,KAAK,IAAI,MAAM,CAAC,cAAc,CAAC;oBAC/B,gBAAgB,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;iBACnC;aACF;iBAAM,IAAI,CAAC,YAAY,0BAAW,EAAE;gBACnC,IAAI,CAAC,CAAC,WAAW,KAAK,wBAAW,CAAC,SAAS,EAAE;oBAC3C,YAAY,GAAG,IAAI,CAAC;iBACrB;gBACD,KAAK,IAAI,MAAM,CAAC,SAAS,CAAC;aAC3B;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,SAAS,EAAE;YACb,KAAK,IAAI,MAAM,CAAC,SAAS,CAAC;SAC3B;QAED,IAAI,UAAU,EAAE;YACd,KAAK,IAAI,MAAM,CAAC,UAAU,CAAC;SAC5B;QAED,IAAI,QAAQ,IAAI,YAAY,EAAE;YAC5B,KAAK,IAAI,MAAM,CAAC,sBAAsB,CAAC;SACxC;QAED,IAAI,YAAY,EAAE;YAChB,KAAK,IAAI,MAAM,CAAC,YAAY,CAAC;SAC9B;QAED,OAAO,KAAK,CAAC;IACf,CAAC;CAEF;AA/DD,8BA+DC","sourcesContent":["import { State, PlayerType } from '../../game';\nimport { SimpleScore } from './score';\nimport { EnergyCard } from '../../game/store/card/energy-card';\nimport { PokemonCard } from '../../game/store/card/pokemon-card';\nimport { Stage, TrainerType } from '../../game/store/card/card-types';\nimport { TrainerCard } from '../../game/store/card/trainer-card';\n\n\nexport class HandScore extends SimpleScore {\n\n  public getScore(state: State, playerId: number): number {\n    const player = this.getPlayer(state, playerId);\n    const scores = this.options.scores.hand;\n\n    const isBenchEmpty = player.bench.every(b => b.cards.length === 0);\n\n    const pokemonsToEvolve: string[] = [];\n    player.forEachPokemon(PlayerType.BOTTOM_PLAYER, (cardList, card, target) => {\n      if (cardList.pokemonPlayedTurn < state.turn) {\n        pokemonsToEvolve.push(card.name);\n      }\n    });\n\n    let score = 0;\n    let hasEnergy = false;\n    let hasPokemon = false;\n    let hasBasic = false;\n    let hasSupporter = false;\n\n    player.hand.cards.forEach(c => {\n      if (c instanceof EnergyCard) {\n        hasEnergy = true;\n        score += scores.cardScore;\n      } else if (c instanceof PokemonCard) {\n        hasPokemon = true;\n        score += scores.cardScore;\n        if (c.stage === Stage.BASIC) {\n          hasBasic = true;\n        }\n        const index = pokemonsToEvolve.indexOf(c.evolvesFrom);\n        if (index !== -1) {\n          score += scores.evolutionScore;\n          pokemonsToEvolve.splice(index, 1);\n        }\n      } else if (c instanceof TrainerCard) {\n        if (c.trainerType === TrainerType.SUPPORTER) {\n          hasSupporter = true;\n        }\n        score += scores.itemScore;\n      }\n    });\n\n    if (hasEnergy) {\n      score += scores.hasEnergy;\n    }\n\n    if (hasPokemon) {\n      score += scores.hasPokemon;\n    }\n\n    if (hasBasic && isBenchEmpty) {\n      score += scores.hasBasicWhenBenchEmpty;\n    }\n\n    if (hasSupporter) {\n      score += scores.hasSupporter;\n    }\n\n    return score;\n  }\n\n}\n"]}