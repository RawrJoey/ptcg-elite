"use strict";function cov_2lamjzbxo3(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-damage-prompt.ts";var hash="6d9d2d35320b27ad33a18e9b7968ff394e2e76e7";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-damage-prompt.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:65}},"2":{start:{line:4,column:21},end:{line:4,column:48}},"3":{start:{line:5,column:23},end:{line:5,column:52}},"4":{start:{line:6,column:17},end:{line:6,column:36}},"5":{start:{line:7,column:27},end:{line:7,column:65}},"6":{start:{line:8,column:22},end:{line:8,column:47}},"7":{start:{line:9,column:0},end:{line:9,column:45}},"8":{start:{line:12,column:8},end:{line:12,column:24}},"9":{start:{line:13,column:8},end:{line:13,column:31}},"10":{start:{line:14,column:8},end:{line:14,column:37}},"11":{start:{line:15,column:8},end:{line:15,column:27}},"12":{start:{line:16,column:8},end:{line:16,column:49}},"13":{start:{line:17,column:8},end:{line:17,column:49}},"14":{start:{line:19,column:8},end:{line:25,column:20}},"15":{start:{line:28,column:8},end:{line:30,column:9}},"16":{start:{line:29,column:12},end:{line:29,column:26}},"17":{start:{line:31,column:23},end:{line:31,column:70}},"18":{start:{line:31,column:47},end:{line:31,column:69}},"19":{start:{line:32,column:8},end:{line:34,column:9}},"20":{start:{line:33,column:12},end:{line:33,column:95}},"21":{start:{line:35,column:8},end:{line:35,column:22}},"22":{start:{line:38,column:8},end:{line:40,column:9}},"23":{start:{line:39,column:12},end:{line:39,column:44}},"24":{start:{line:41,column:8},end:{line:43,column:9}},"25":{start:{line:42,column:12},end:{line:42,column:25}},"26":{start:{line:44,column:8},end:{line:46,column:9}},"27":{start:{line:45,column:12},end:{line:45,column:25}},"28":{start:{line:47,column:23},end:{line:47,column:70}},"29":{start:{line:47,column:47},end:{line:47,column:69}},"30":{start:{line:48,column:8},end:{line:50,column:9}},"31":{start:{line:49,column:12},end:{line:49,column:25}},"32":{start:{line:51,column:28},end:{line:51,column:115}},"33":{start:{line:51,column:62},end:{line:51,column:114}},"34":{start:{line:52,column:26},end:{line:52,column:111}},"35":{start:{line:52,column:58},end:{line:52,column:110}},"36":{start:{line:53,column:8},end:{line:62,column:9}},"37":{start:{line:54,column:25},end:{line:54,column:82}},"38":{start:{line:55,column:12},end:{line:57,column:13}},"39":{start:{line:56,column:16},end:{line:56,column:29}},"40":{start:{line:58,column:23},end:{line:58,column:78}},"41":{start:{line:59,column:12},end:{line:61,column:13}},"42":{start:{line:60,column:16},end:{line:60,column:29}},"43":{start:{line:63,column:8},end:{line:68,column:9}},"44":{start:{line:64,column:12},end:{line:67,column:13}},"45":{start:{line:64,column:33},end:{line:64,column:66}},"46":{start:{line:65,column:36},end:{line:65,column:67}},"47":{start:{line:66,column:16},end:{line:66,column:29}},"48":{start:{line:69,column:8},end:{line:72,column:9}},"49":{start:{line:69,column:29},end:{line:69,column:62}},"50":{start:{line:70,column:32},end:{line:70,column:63}},"51":{start:{line:71,column:12},end:{line:71,column:25}},"52":{start:{line:73,column:8},end:{line:73,column:20}},"53":{start:{line:76,column:0},end:{line:76,column:44}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:4},end:{line:11,column:5}},loc:{start:{line:11,column:81},end:{line:26,column:5}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:27,column:4},end:{line:27,column:5}},loc:{start:{line:27,column:26},end:{line:36,column:5}},line:27},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:42},end:{line:31,column:43}},loc:{start:{line:31,column:47},end:{line:31,column:69}},line:31},"3":{name:"(anonymous_3)",decl:{start:{line:37,column:4},end:{line:37,column:5}},loc:{start:{line:37,column:28},end:{line:74,column:5}},line:37},"4":{name:"(anonymous_4)",decl:{start:{line:47,column:42},end:{line:47,column:43}},loc:{start:{line:47,column:47},end:{line:47,column:69}},line:47},"5":{name:"(anonymous_5)",decl:{start:{line:51,column:57},end:{line:51,column:58}},loc:{start:{line:51,column:62},end:{line:51,column:114}},line:51},"6":{name:"(anonymous_6)",decl:{start:{line:52,column:53},end:{line:52,column:54}},loc:{start:{line:52,column:58},end:{line:52,column:110}},line:52},"7":{name:"(anonymous_7)",decl:{start:{line:64,column:28},end:{line:64,column:29}},loc:{start:{line:64,column:33},end:{line:64,column:66}},line:64},"8":{name:"(anonymous_8)",decl:{start:{line:65,column:31},end:{line:65,column:32}},loc:{start:{line:65,column:36},end:{line:65,column:67}},line:65},"9":{name:"(anonymous_9)",decl:{start:{line:69,column:24},end:{line:69,column:25}},loc:{start:{line:69,column:29},end:{line:69,column:62}},line:69},"10":{name:"(anonymous_10)",decl:{start:{line:70,column:27},end:{line:70,column:28}},loc:{start:{line:70,column:32},end:{line:70,column:63}},line:70}},branchMap:{"0":{loc:{start:{line:28,column:8},end:{line:30,column:9}},type:"if",locations:[{start:{line:28,column:8},end:{line:30,column:9}},{start:{line:28,column:8},end:{line:30,column:9}}],line:28},"1":{loc:{start:{line:32,column:8},end:{line:34,column:9}},type:"if",locations:[{start:{line:32,column:8},end:{line:34,column:9}},{start:{line:32,column:8},end:{line:34,column:9}}],line:32},"2":{loc:{start:{line:38,column:8},end:{line:40,column:9}},type:"if",locations:[{start:{line:38,column:8},end:{line:40,column:9}},{start:{line:38,column:8},end:{line:40,column:9}}],line:38},"3":{loc:{start:{line:41,column:8},end:{line:43,column:9}},type:"if",locations:[{start:{line:41,column:8},end:{line:43,column:9}},{start:{line:41,column:8},end:{line:43,column:9}}],line:41},"4":{loc:{start:{line:44,column:8},end:{line:46,column:9}},type:"if",locations:[{start:{line:44,column:8},end:{line:46,column:9}},{start:{line:44,column:8},end:{line:46,column:9}}],line:44},"5":{loc:{start:{line:44,column:12},end:{line:44,column:78}},type:"binary-expr",locations:[{start:{line:44,column:12},end:{line:44,column:42}},{start:{line:44,column:46},end:{line:44,column:78}}],line:44},"6":{loc:{start:{line:48,column:8},end:{line:50,column:9}},type:"if",locations:[{start:{line:48,column:8},end:{line:50,column:9}},{start:{line:48,column:8},end:{line:50,column:9}}],line:48},"7":{loc:{start:{line:55,column:12},end:{line:57,column:13}},type:"if",locations:[{start:{line:55,column:12},end:{line:57,column:13}},{start:{line:55,column:12},end:{line:57,column:13}}],line:55},"8":{loc:{start:{line:55,column:16},end:{line:55,column:64}},type:"binary-expr",locations:[{start:{line:55,column:16},end:{line:55,column:34}},{start:{line:55,column:38},end:{line:55,column:64}}],line:55},"9":{loc:{start:{line:59,column:12},end:{line:61,column:13}},type:"if",locations:[{start:{line:59,column:12},end:{line:61,column:13}},{start:{line:59,column:12},end:{line:61,column:13}}],line:59},"10":{loc:{start:{line:59,column:16},end:{line:59,column:58}},type:"binary-expr",locations:[{start:{line:59,column:16},end:{line:59,column:32}},{start:{line:59,column:36},end:{line:59,column:58}}],line:59},"11":{loc:{start:{line:63,column:8},end:{line:68,column:9}},type:"if",locations:[{start:{line:63,column:8},end:{line:68,column:9}},{start:{line:63,column:8},end:{line:68,column:9}}],line:63},"12":{loc:{start:{line:64,column:12},end:{line:67,column:13}},type:"if",locations:[{start:{line:64,column:12},end:{line:67,column:13}},{start:{line:64,column:12},end:{line:67,column:13}}],line:64},"13":{loc:{start:{line:64,column:16},end:{line:65,column:68}},type:"binary-expr",locations:[{start:{line:64,column:16},end:{line:64,column:67}},{start:{line:65,column:19},end:{line:65,column:68}}],line:64},"14":{loc:{start:{line:69,column:8},end:{line:72,column:9}},type:"if",locations:[{start:{line:69,column:8},end:{line:72,column:9}},{start:{line:69,column:8},end:{line:72,column:9}}],line:69},"15":{loc:{start:{line:69,column:12},end:{line:70,column:64}},type:"binary-expr",locations:[{start:{line:69,column:12},end:{line:69,column:63}},{start:{line:70,column:15},end:{line:70,column:64}}],line:69}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-damage-prompt.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/store/prompts/move-damage-prompt.ts"],names:[],mappings:"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",sourcesContent:["import { GameError } from '../../game-error';\nimport { GameMessage } from '../../game-message';\nimport { Prompt } from './prompt';\nimport { PlayerType, SlotType, CardTarget } from '../actions/play-card-action';\nimport { State } from '../state/state';\nimport { StateUtils } from '../state-utils';\n\nexport const MoveDamagePromptType = 'Move damage';\n\nexport type MoveDamageResultType = DamageTransfer[];\n\nexport interface DamageTransfer {\n  from: CardTarget;\n  to: CardTarget;\n}\n\nexport interface DamageMap {\n  target: CardTarget;\n  damage: number;\n}\n\nexport interface MoveDamageOptions {\n  allowCancel: boolean;\n  min: number;\n  max: number | undefined;\n  blockedFrom: CardTarget[];\n  blockedTo: CardTarget[];\n}\n\nexport class MoveDamagePrompt extends Prompt<DamageTransfer[]> {\n\n  readonly type: string = MoveDamagePromptType;\n\n  public options: MoveDamageOptions;\n\n  constructor(\n    playerId: number,\n    public message: GameMessage,\n    public playerType: PlayerType,\n    public slots: SlotType[],\n    public maxAllowedDamage: DamageMap[],\n    options?: Partial<MoveDamageOptions>\n  ) {\n    super(playerId);\n\n    // Default options\n    this.options = Object.assign({}, {\n      allowCancel: true,\n      min: 0,\n      max: undefined,\n      blockedFrom: [],\n      blockedTo: []\n    }, options);\n  }\n\n  public decode(result: MoveDamageResultType | null, state: State): DamageTransfer[] | null {\n    if (result === null) {\n      return result;  // operation cancelled\n    }\n    const player = state.players.find(p => p.id === this.playerId);\n    if (player === undefined) {\n      throw new GameError(GameMessage.INVALID_PROMPT_RESULT);\n    }\n    return result;\n  }\n\n  public validate(result: DamageTransfer[] | null, state: State): boolean {\n    if (result === null) {\n      return this.options.allowCancel;  // operation cancelled\n    }\n\n    if (result.length < this.options.min) {\n      return false;\n    }\n\n    if (this.options.max !== undefined && result.length > this.options.max) {\n      return false;\n    }\n\n    const player = state.players.find(p => p.id === this.playerId);\n    if (player === undefined) {\n      return false;\n    }\n    const blockedFrom = this.options.blockedFrom.map(b => StateUtils.getTarget(state, player, b));\n    const blockedTo = this.options.blockedTo.map(b => StateUtils.getTarget(state, player, b));\n\n    for (const r of result) {\n      const from = StateUtils.getTarget(state, player, r.from);\n      if (from === undefined || blockedFrom.includes(from)) {\n        return false;\n      }\n      const to = StateUtils.getTarget(state, player, r.to);\n      if (to === undefined || blockedTo.includes(to)) {\n        return false;\n      }\n    }\n\n    if (this.playerType !== PlayerType.ANY) {\n      if (result.some(r => r.from.player !== this.playerType)\n        || result.some(r => r.to.player !== this.playerType)) {\n        return false;\n      }\n    }\n\n    if (result.some(r => !this.slots.includes(r.from.slot))\n      || result.some(r => !this.slots.includes(r.to.slot))) {\n      return false;\n    }\n\n    return true;\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6d9d2d35320b27ad33a18e9b7968ff394e2e76e7"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2lamjzbxo3=function(){return actualCoverage;};}return actualCoverage;}cov_2lamjzbxo3();cov_2lamjzbxo3().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_2lamjzbxo3().s[1]++;exports.MoveDamagePrompt=exports.MoveDamagePromptType=void 0;const game_error_1=(cov_2lamjzbxo3().s[2]++,require("../../game-error"));const game_message_1=(cov_2lamjzbxo3().s[3]++,require("../../game-message"));const prompt_1=(cov_2lamjzbxo3().s[4]++,require("./prompt"));const play_card_action_1=(cov_2lamjzbxo3().s[5]++,require("../actions/play-card-action"));const state_utils_1=(cov_2lamjzbxo3().s[6]++,require("../state-utils"));cov_2lamjzbxo3().s[7]++;exports.MoveDamagePromptType='Move damage';class MoveDamagePrompt extends(prompt_1.Prompt){constructor(playerId,message,playerType,slots,maxAllowedDamage,options){cov_2lamjzbxo3().f[0]++;cov_2lamjzbxo3().s[8]++;super(playerId);cov_2lamjzbxo3().s[9]++;this.message=message;cov_2lamjzbxo3().s[10]++;this.playerType=playerType;cov_2lamjzbxo3().s[11]++;this.slots=slots;cov_2lamjzbxo3().s[12]++;this.maxAllowedDamage=maxAllowedDamage;cov_2lamjzbxo3().s[13]++;this.type=exports.MoveDamagePromptType;// Default options
cov_2lamjzbxo3().s[14]++;this.options=Object.assign({},{allowCancel:true,min:0,max:undefined,blockedFrom:[],blockedTo:[]},options);}decode(result,state){cov_2lamjzbxo3().f[1]++;cov_2lamjzbxo3().s[15]++;if(result===null){cov_2lamjzbxo3().b[0][0]++;cov_2lamjzbxo3().s[16]++;return result;// operation cancelled
}else{cov_2lamjzbxo3().b[0][1]++;}const player=(cov_2lamjzbxo3().s[17]++,state.players.find(p=>{cov_2lamjzbxo3().f[2]++;cov_2lamjzbxo3().s[18]++;return p.id===this.playerId;}));cov_2lamjzbxo3().s[19]++;if(player===undefined){cov_2lamjzbxo3().b[1][0]++;cov_2lamjzbxo3().s[20]++;throw new game_error_1.GameError(game_message_1.GameMessage.INVALID_PROMPT_RESULT);}else{cov_2lamjzbxo3().b[1][1]++;}cov_2lamjzbxo3().s[21]++;return result;}validate(result,state){cov_2lamjzbxo3().f[3]++;cov_2lamjzbxo3().s[22]++;if(result===null){cov_2lamjzbxo3().b[2][0]++;cov_2lamjzbxo3().s[23]++;return this.options.allowCancel;// operation cancelled
}else{cov_2lamjzbxo3().b[2][1]++;}cov_2lamjzbxo3().s[24]++;if(result.length<this.options.min){cov_2lamjzbxo3().b[3][0]++;cov_2lamjzbxo3().s[25]++;return false;}else{cov_2lamjzbxo3().b[3][1]++;}cov_2lamjzbxo3().s[26]++;if((cov_2lamjzbxo3().b[5][0]++,this.options.max!==undefined)&&(cov_2lamjzbxo3().b[5][1]++,result.length>this.options.max)){cov_2lamjzbxo3().b[4][0]++;cov_2lamjzbxo3().s[27]++;return false;}else{cov_2lamjzbxo3().b[4][1]++;}const player=(cov_2lamjzbxo3().s[28]++,state.players.find(p=>{cov_2lamjzbxo3().f[4]++;cov_2lamjzbxo3().s[29]++;return p.id===this.playerId;}));cov_2lamjzbxo3().s[30]++;if(player===undefined){cov_2lamjzbxo3().b[6][0]++;cov_2lamjzbxo3().s[31]++;return false;}else{cov_2lamjzbxo3().b[6][1]++;}const blockedFrom=(cov_2lamjzbxo3().s[32]++,this.options.blockedFrom.map(b=>{cov_2lamjzbxo3().f[5]++;cov_2lamjzbxo3().s[33]++;return state_utils_1.StateUtils.getTarget(state,player,b);}));const blockedTo=(cov_2lamjzbxo3().s[34]++,this.options.blockedTo.map(b=>{cov_2lamjzbxo3().f[6]++;cov_2lamjzbxo3().s[35]++;return state_utils_1.StateUtils.getTarget(state,player,b);}));cov_2lamjzbxo3().s[36]++;for(const r of result){const from=(cov_2lamjzbxo3().s[37]++,state_utils_1.StateUtils.getTarget(state,player,r.from));cov_2lamjzbxo3().s[38]++;if((cov_2lamjzbxo3().b[8][0]++,from===undefined)||(cov_2lamjzbxo3().b[8][1]++,blockedFrom.includes(from))){cov_2lamjzbxo3().b[7][0]++;cov_2lamjzbxo3().s[39]++;return false;}else{cov_2lamjzbxo3().b[7][1]++;}const to=(cov_2lamjzbxo3().s[40]++,state_utils_1.StateUtils.getTarget(state,player,r.to));cov_2lamjzbxo3().s[41]++;if((cov_2lamjzbxo3().b[10][0]++,to===undefined)||(cov_2lamjzbxo3().b[10][1]++,blockedTo.includes(to))){cov_2lamjzbxo3().b[9][0]++;cov_2lamjzbxo3().s[42]++;return false;}else{cov_2lamjzbxo3().b[9][1]++;}}cov_2lamjzbxo3().s[43]++;if(this.playerType!==play_card_action_1.PlayerType.ANY){cov_2lamjzbxo3().b[11][0]++;cov_2lamjzbxo3().s[44]++;if((cov_2lamjzbxo3().b[13][0]++,result.some(r=>{cov_2lamjzbxo3().f[7]++;cov_2lamjzbxo3().s[45]++;return r.from.player!==this.playerType;}))||(cov_2lamjzbxo3().b[13][1]++,result.some(r=>{cov_2lamjzbxo3().f[8]++;cov_2lamjzbxo3().s[46]++;return r.to.player!==this.playerType;}))){cov_2lamjzbxo3().b[12][0]++;cov_2lamjzbxo3().s[47]++;return false;}else{cov_2lamjzbxo3().b[12][1]++;}}else{cov_2lamjzbxo3().b[11][1]++;}cov_2lamjzbxo3().s[48]++;if((cov_2lamjzbxo3().b[15][0]++,result.some(r=>{cov_2lamjzbxo3().f[9]++;cov_2lamjzbxo3().s[49]++;return!this.slots.includes(r.from.slot);}))||(cov_2lamjzbxo3().b[15][1]++,result.some(r=>{cov_2lamjzbxo3().f[10]++;cov_2lamjzbxo3().s[50]++;return!this.slots.includes(r.to.slot);}))){cov_2lamjzbxo3().b[14][0]++;cov_2lamjzbxo3().s[51]++;return false;}else{cov_2lamjzbxo3().b[14][1]++;}cov_2lamjzbxo3().s[52]++;return true;}}cov_2lamjzbxo3().s[53]++;exports.MoveDamagePrompt=MoveDamagePrompt;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc3RvcmUvcHJvbXB0cy9tb3ZlLWRhbWFnZS1wcm9tcHQudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvbW92ZS1kYW1hZ2UtcHJvbXB0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLGlEQUE2QztBQUM3QyxxREFBaUQ7QUFDakQscUNBQWtDO0FBQ2xDLGtFQUErRTtBQUUvRSxnREFBNEM7QUFFL0IsUUFBQSxvQkFBb0IsR0FBRyxhQUFhLENBQUM7QUFzQmxELE1BQWEsZ0JBQWlCLFNBQVEsZUFBd0I7SUFNNUQsWUFDRSxRQUFnQixFQUNULE9BQW9CLEVBQ3BCLFVBQXNCLEVBQ3RCLEtBQWlCLEVBQ2pCLGdCQUE2QixFQUNwQyxPQUFvQztRQUVwQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7UUFOVCxZQUFPLEdBQVAsT0FBTyxDQUFhO1FBQ3BCLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsVUFBSyxHQUFMLEtBQUssQ0FBWTtRQUNqQixxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWE7UUFUN0IsU0FBSSxHQUFXLDRCQUFvQixDQUFDO1FBYzNDLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFO1lBQy9CLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLEdBQUcsRUFBRSxDQUFDO1lBQ04sR0FBRyxFQUFFLFNBQVM7WUFDZCxXQUFXLEVBQUUsRUFBRTtZQUNmLFNBQVMsRUFBRSxFQUFFO1NBQ2QsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNkLENBQUM7SUFFTSxNQUFNLENBQUMsTUFBbUMsRUFBRSxLQUFZO1FBQzdELElBQUksTUFBTSxLQUFL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QyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2VBQ2xELE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRTtZQUN0RCxPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0NBRUY7QUFuRkQsNENBbUZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR2FtZUVycm9yIH0gZnJvbSAnLi4vLi4vZ2FtZS1lcnJvcic7XG5pbXBvcnQgeyBHYW1lTWVzc2FnZSB9IGZyb20gJy4uLy4uL2dhbWUtbWVzc2FnZSc7XG5pbXBvcnQgeyBQcm9tcHQgfSBmcm9tICcuL3Byb21wdCc7XG5pbXBvcnQgeyBQbGF5ZXJUeXBlLCBTbG90VHlwZSwgQ2FyZFRhcmdldCB9IGZyb20gJy4uL2FjdGlvbnMvcGxheS1jYXJkLWFjdGlvbic7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3N0YXRlJztcbmltcG9ydCB7IFN0YXRlVXRpbHMgfSBmcm9tICcuLi9zdGF0ZS11dGlscyc7XG5cbmV4cG9ydCBjb25zdCBNb3ZlRGFtYWdlUHJvbXB0VHlwZSA9ICdNb3ZlIGRhbWFnZSc7XG5cbmV4cG9ydCB0eXBlIE1vdmVEYW1hZ2VSZXN1bHRUeXBlID0gRGFtYWdlVHJhbnNmZXJbXTtcblxuZXhwb3J0IGludGVyZmFjZSBEYW1hZ2VUcmFuc2ZlciB7XG4gIGZyb206IENhcmRUYXJnZXQ7XG4gIHRvOiBDYXJkVGFyZ2V0O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERhbWFnZU1hcCB7XG4gIHRhcmdldDogQ2FyZFRhcmdldDtcbiAgZGFtYWdlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW92ZURhbWFnZU9wdGlvbnMge1xuICBhbGxvd0NhbmNlbDogYm9vbGVhbjtcbiAgbWluOiBudW1iZXI7XG4gIG1heDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuICBibG9ja2VkRnJvbTogQ2FyZFRhcmdldFtdO1xuICBibG9ja2VkVG86IENhcmRUYXJnZXRbXTtcbn1cblxuZXhwb3J0IGNsYXNzIE1vdmVEYW1hZ2VQcm9tcHQgZXh0ZW5kcyBQcm9tcHQ8RGFtYWdlVHJhbnNmZXJbXT4ge1xuXG4gIHJlYWRvbmx5IHR5cGU6IHN0cmluZyA9IE1vdmVEYW1hZ2VQcm9tcHRUeXBlO1xuXG4gIHB1YmxpYyBvcHRpb25zOiBNb3ZlRGFtYWdlT3B0aW9ucztcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwbGF5ZXJJZDogbnVtYmVyLFxuICAgIHB1YmxpYyBtZXNzYWdlOiBHYW1lTWVzc2FnZSxcbiAgICBwdWJsaWMgcGxheWVyVHlwZTogUGxheWVyVHlwZSxcbiAgICBwdWJsaWMgc2xvdHM6IFNsb3RUeXBlW10sXG4gICAgcHVibGljIG1heEFsbG93ZWREYW1hZ2U6IERhbWFnZU1hcFtdLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPE1vdmVEYW1hZ2VPcHRpb25zPlxuICApIHtcbiAgICBzdXBlcihwbGF5ZXJJZCk7XG5cbiAgICAvLyBEZWZhdWx0IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcbiAgICAgIG1pbjogMCxcbiAgICAgIG1heDogdW5kZWZpbmVkLFxuICAgICAgYmxvY2tlZEZyb206IFtdLFxuICAgICAgYmxvY2tlZFRvOiBbXVxuICAgIH0sIG9wdGlvbnMpO1xuICB9XG5cbiAgcHVibGljIGRlY29kZShyZXN1bHQ6IE1vdmVEYW1hZ2VSZXN1bHRUeXBlIHwgbnVsbCwgc3RhdGU6IFN0YXRlKTogRGFtYWdlVHJhbnNmZXJbXSB8IG51bGwge1xuICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiByZXN1bHQ7ICAvLyBvcGVyYXRpb24gY2FuY2VsbGVkXG4gICAgfVxuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHRoaXMucGxheWVySWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTlZBTElEX1BST01QVF9SRVNVTFQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHVibGljIHZhbGlkYXRlKHJlc3VsdDogRGFtYWdlVHJhbnNmZXJbXSB8IG51bGwsIHN0YXRlOiBTdGF0ZSk6IGJvb2xlYW4ge1xuICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYWxsb3dDYW5jZWw7ICAvLyBvcGVyYXRpb24gY2FuY2VsbGVkXG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPCB0aGlzLm9wdGlvbnMubWluKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5tYXggIT09IHVuZGVmaW5lZCAmJiByZXN1bHQubGVuZ3RoID4gdGhpcy5vcHRpb25zLm1heCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHRoaXMucGxheWVySWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBibG9ja2VkRnJvbSA9IHRoaXMub3B0aW9ucy5ibG9ja2VkRnJvbS5tYXAoYiA9PiBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCBiKSk7XG4gICAgY29uc3QgYmxvY2tlZFRvID0gdGhpcy5vcHRpb25zLmJsb2NrZWRUby5tYXAoYiA9PiBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCBiKSk7XG5cbiAgICBmb3IgKGNvbnN0IHIgb2YgcmVzdWx0KSB7XG4gICAgICBjb25zdCBmcm9tID0gU3RhdGVVdGlscy5nZXRUYXJnZXQoc3RhdGUsIHBsYXllciwgci5mcm9tKTtcbiAgICAgIGlmIChmcm9tID09PSB1bmRlZmluZWQgfHwgYmxvY2tlZEZyb20uaW5jbHVkZXMoZnJvbSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgdG8gPSBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCByLnRvKTtcbiAgICAgIGlmICh0byA9PT0gdW5kZWZpbmVkIHx8IGJsb2NrZWRUby5pbmNsdWRlcyh0bykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLnBsYXllclR5cGUgIT09IFBsYXllclR5cGUuQU5ZKSB7XG4gICAgICBpZiAocmVzdWx0LnNvbWUociA9PiByLmZyb20ucGxheWVyICE9PSB0aGlzLnBsYXllclR5cGUpXG4gICAgICAgIHx8IHJlc3VsdC5zb21lKHIgPT4gci50by5wbGF5ZXIgIT09IHRoaXMucGxheWVyVHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChyZXN1bHQuc29tZShyID0+ICF0aGlzLnNsb3RzLmluY2x1ZGVzKHIuZnJvbS5zbG90KSlcbiAgICAgIHx8IHJlc3VsdC5zb21lKHIgPT4gIXRoaXMuc2xvdHMuaW5jbHVkZXMoci50by5zbG90KSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG59XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3N0b3JlL3Byb21wdHMvbW92ZS1kYW1hZ2UtcHJvbXB0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJzNmRBd0NXO2lRQXhDWCxLQUFBLENBQUEsWUFBQSwwQkFBQSxPQUFBLENBQUEsa0JBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLGNBQUEsMEJBQUEsT0FBQSxDQUFBLG9CQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxRQUFBLDBCQUFBLE9BQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxrQkFBQSwwQkFBQSxPQUFBLENBQUEsNkJBQUEsQ0FBQSxDQUFBLENBRUEsS0FBQSxDQUFBLGFBQUEsMEJBQUEsT0FBQSxDQUFBLGdCQUFBLENBQUEsQ0FBQSxDLHdCQUVhLE9BQUEsQ0FBQSxvQkFBQSxDQUF1QixhQUF2QixDQXNCYixLQUFhLENBQUEsZ0JBQWIsU0FBc0MsUUFBQSxDQUFBLE1BQXRDLENBQThELENBTTVELFdBQUEsQ0FDRSxRQURGLENBRVMsT0FGVCxDQUdTLFVBSFQsQ0FJUyxLQUpULENBS1MsZ0JBTFQsQ0FNRSxPQU5GLENBTXNDLGlEQUVwQyxNQUFNLFFBQU4sRUFGb0Msd0JBSjdCLEtBQUEsT0FBQSxDQUFBLE9BQUEsQ0FJNkIseUJBSDdCLEtBQUEsVUFBQSxDQUFBLFVBQUEsQ0FHNkIseUJBRjdCLEtBQUEsS0FBQSxDQUFBLEtBQUEsQ0FFNkIseUJBRDdCLEtBQUEsZ0JBQUEsQ0FBQSxnQkFBQSxDQUM2Qix5QkFWN0IsS0FBQSxJQUFBLENBQWUsT0FBQSxDQUFBLG9CQUFmLENBY1A7QUFKb0MseUJBS3BDLEtBQUssT0FBTCxDQUFlLE1BQU0sQ0FBQyxNQUFQLENBQWMsRUFBZCxDQUFrQixDQUMvQixXQUFXLENBQUUsSUFEa0IsQ0FFL0IsR0FBRyxDQUFFLENBRjBCLENBRy9CLEdB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LGdDQUFvQixTQUFTLENBQUMsUUFBVixDQUFtQixFQUFuQixDQUFwQixDQUFKLENBQWdELHFEQUM5QyxNQUFPLE1BQVAsQ0FDRCxDQUZELGlDQUdELENBN0IwRCx5QkErQjNELEdBQUksS0FBSyxVQUFMLEdBQW9CLGtCQUFBLENBQUEsVUFBQSxDQUFXLEdBQW5DLENBQXdDLHNEQUN0QyxHQUFJLDZCQUFBLE1BQU0sQ0FBQyxJQUFQLENBQVksQ0FBQyxFQUFJLHdEQUFBLENBQUEsQ0FBQyxDQUFDLElBQUYsQ0FBTyxNQUFQLEdBQWtCLEtBQUssVUFBdkIsQ0FBaUMsQ0FBbEQsaUNBQ0MsTUFBTSxDQUFDLElBQVAsQ0FBWSxDQUFDLEVBQUksd0RBQUEsQ0FBQSxDQUFDLENBQUMsRUFBRixDQUFLLE1BQUwsR0FBZ0IsS0FBSyxVQUFyQixDQUErQixDQUFoRCxDQURELENBQUosQ0FDd0Qsc0RBQ3RELE1BQU8sTUFBUCxDQUNELENBSEQsa0NBSUQsQ0FMRCxrQ0EvQjJELHlCQXNDM0QsR0FBSSw2QkFBQSxNQUFNLENBQUMsSUFBUCxDQUFZLENBQUMsRUFBSSx5REFBQyxLQUFLLEtBQUwsQ0FBVyxRQUFYLENBQW9CLENBQUMsQ0FBQyxJQUFGLENBQU8sSUFBM0IsQ0FBRCxDQUFpQyxDQUFsRCxpQ0FDQyxNQUFNLENBQUMsSUFBUCxDQUFZLENBQUMsRUFBSSwwREFBQyxLQUFLLEtBQUwsQ0FBVyxRQUFYLENBQW9CLENBQUMsQ0FBQyxFQUFGLENBQUssSUFBekIsQ0FBRCxDQUErQixDQUFoRCxDQURELENBQUosQ0FDd0Qsc0RBQ3RELE1BQU8sTUFBUCxDQUNELENBSEQsa0NBdEMyRCx5QkEyQzNELE1BQU8sS0FBUCxDQUNELENBakYyRCxDLHlCQUE5RCxPQUFBLENBQUEsZ0JBQUEsQ0FBQSxnQkFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR2FtZUVycm9yIH0gZnJvbSAnLi4vLi4vZ2FtZS1lcnJvcic7XG5pbXBvcnQgeyBHYW1lTWVzc2FnZSB9IGZyb20gJy4uLy4uL2dhbWUtbWVzc2FnZSc7XG5pbXBvcnQgeyBQcm9tcHQgfSBmcm9tICcuL3Byb21wdCc7XG5pbXBvcnQgeyBQbGF5ZXJUeXBlLCBTbG90VHlwZSwgQ2FyZFRhcmdldCB9IGZyb20gJy4uL2FjdGlvbnMvcGxheS1jYXJkLWFjdGlvbic7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3N0YXRlJztcbmltcG9ydCB7IFN0YXRlVXRpbHMgfSBmcm9tICcuLi9zdGF0ZS11dGlscyc7XG5cbmV4cG9ydCBjb25zdCBNb3ZlRGFtYWdlUHJvbXB0VHlwZSA9ICdNb3ZlIGRhbWFnZSc7XG5cbmV4cG9ydCB0eXBlIE1vdmVEYW1hZ2VSZXN1bHRUeXBlID0gRGFtYWdlVHJhbnNmZXJbXTtcblxuZXhwb3J0IGludGVyZmFjZSBEYW1hZ2VUcmFuc2ZlciB7XG4gIGZyb206IENhcmRUYXJnZXQ7XG4gIHRvOiBDYXJkVGFyZ2V0O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERhbWFnZU1hcCB7XG4gIHRhcmdldDogQ2FyZFRhcmdldDtcbiAgZGFtYWdlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW92ZURhbWFnZU9wdGlvbnMge1xuICBhbGxvd0NhbmNlbDogYm9vbGVhbjtcbiAgbWluOiBudW1iZXI7XG4gIG1heDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuICBibG9ja2VkRnJvbTogQ2FyZFRhcmdldFtdO1xuICBibG9ja2VkVG86IENhcmRUYXJnZXRbXTtcbn1cblxuZXhwb3J0IGNsYXNzIE1vdmVEYW1hZ2VQcm9tcHQgZXh0ZW5kcyBQcm9tcHQ8RGFtYWdlVHJhbnNmZXJbXT4ge1xuXG4gIHJlYWRvbmx5IHR5cGU6IHN0cmluZyA9IE1vdmVEYW1hZ2VQcm9tcHRUeXBlO1xuXG4gIHB1YmxpYyBvcHRpb25zOiBNb3ZlRGFtYWdlT3B0aW9ucztcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwbGF5ZXJJZDogbnVtYmVyLFxuICAgIHB1YmxpYyBtZXNzYWdlOiBHYW1lTWVzc2FnZSxcbiAgICBwdWJsaWMgcGxheWVyVHlwZTogUGxheWVyVHlwZSxcbiAgICBwdWJsaWMgc2xvdHM6IFNsb3RUeXBlW10sXG4gICAgcHVibGljIG1heEFsbG93ZWREYW1hZ2U6IERhbWFnZU1hcFtdLFxuICAgIG9wdGlvbnM/OiBQYXJ0aWFsPE1vdmVEYW1hZ2VPcHRpb25zPlxuICApIHtcbiAgICBzdXBlcihwbGF5ZXJJZCk7XG5cbiAgICAvLyBEZWZhdWx0IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcbiAgICAgIG1pbjogMCxcbiAgICAgIG1heDogdW5kZWZpbmVkLFxuICAgICAgYmxvY2tlZEZyb206IFtdLFxuICAgICAgYmxvY2tlZFRvOiBbXVxuICAgIH0sIG9wdGlvbnMpO1xuICB9XG5cbiAgcHVibGljIGRlY29kZShyZXN1bHQ6IE1vdmVEYW1hZ2VSZXN1bHRUeXBlIHwgbnVsbCwgc3RhdGU6IFN0YXRlKTogRGFtYWdlVHJhbnNmZXJbXSB8IG51bGwge1xuICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiByZXN1bHQ7ICAvLyBvcGVyYXRpb24gY2FuY2VsbGVkXG4gICAgfVxuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHRoaXMucGxheWVySWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEdhbWVFcnJvcihHYW1lTWVzc2FnZS5JTlZBTElEX1BST01QVF9SRVNVTFQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHVibGljIHZhbGlkYXRlKHJlc3VsdDogRGFtYWdlVHJhbnNmZXJbXSB8IG51bGwsIHN0YXRlOiBTdGF0ZSk6IGJvb2xlYW4ge1xuICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYWxsb3dDYW5jZWw7ICAvLyBvcGVyYXRpb24gY2FuY2VsbGVkXG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPCB0aGlzLm9wdGlvbnMubWluKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5tYXggIT09IHVuZGVmaW5lZCAmJiByZXN1bHQubGVuZ3RoID4gdGhpcy5vcHRpb25zLm1heCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IHBsYXllciA9IHN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHRoaXMucGxheWVySWQpO1xuICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBibG9ja2VkRnJvbSA9IHRoaXMub3B0aW9ucy5ibG9ja2VkRnJvbS5tYXAoYiA9PiBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCBiKSk7XG4gICAgY29uc3QgYmxvY2tlZFRvID0gdGhpcy5vcHRpb25zLmJsb2NrZWRUby5tYXAoYiA9PiBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCBiKSk7XG5cbiAgICBmb3IgKGNvbnN0IHIgb2YgcmVzdWx0KSB7XG4gICAgICBjb25zdCBmcm9tID0gU3RhdGVVdGlscy5nZXRUYXJnZXQoc3RhdGUsIHBsYXllciwgci5mcm9tKTtcbiAgICAgIGlmIChmcm9tID09PSB1bmRlZmluZWQgfHwgYmxvY2tlZEZyb20uaW5jbHVkZXMoZnJvbSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgdG8gPSBTdGF0ZVV0aWxzLmdldFRhcmdldChzdGF0ZSwgcGxheWVyLCByLnRvKTtcbiAgICAgIGlmICh0byA9PT0gdW5kZWZpbmVkIHx8IGJsb2NrZWRUby5pbmNsdWRlcyh0bykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLnBsYXllclR5cGUgIT09IFBsYXllclR5cGUuQU5ZKSB7XG4gICAgICBpZiAocmVzdWx0LnNvbWUociA9PiByLmZyb20ucGxheWVyICE9PSB0aGlzLnBsYXllclR5cGUpXG4gICAgICAgIHx8IHJlc3VsdC5zb21lKHIgPT4gci50by5wbGF5ZXIgIT09IHRoaXMucGxheWVyVHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChyZXN1bHQuc29tZShyID0+ICF0aGlzLnNsb3RzLmluY2x1ZGVzKHIuZnJvbS5zbG90KSlcbiAgICAgIHx8IHJlc3VsdC5zb21lKHIgPT4gIXRoaXMuc2xvdHMuaW5jbHVkZXMoci50by5zbG90KSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG59XG4iXX0=