"use strict";function cov_2kn5wpxc9t(){var path="/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/serializer/json-patch.ts";var hash="689c61d26f1808cdae110d32a8e74be55315e28d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/serializer/json-patch.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:27}},"2":{start:{line:4,column:16},end:{line:4,column:38}},"3":{start:{line:7,column:23},end:{line:7,column:52}},"4":{start:{line:8,column:8},end:{line:12,column:12}},"5":{start:{line:8,column:32},end:{line:12,column:9}},"6":{start:{line:15,column:21},end:{line:15,column:24}},"7":{start:{line:16,column:8},end:{line:27,column:9}},"8":{start:{line:17,column:12},end:{line:26,column:13}},"9":{start:{line:18,column:16},end:{line:18,column:59}},"10":{start:{line:21,column:29},end:{line:21,column:62}},"11":{start:{line:22,column:16},end:{line:25,column:17}},"12":{start:{line:23,column:37},end:{line:23,column:74}},"13":{start:{line:24,column:20},end:{line:24,column:53}},"14":{start:{line:28,column:8},end:{line:28,column:22}},"15":{start:{line:31,column:8},end:{line:40,column:9}},"16":{start:{line:32,column:12},end:{line:35,column:13}},"17":{start:{line:33,column:16},end:{line:33,column:61}},"18":{start:{line:34,column:16},end:{line:34,column:31}},"19":{start:{line:36,column:12},end:{line:38,column:13}},"20":{start:{line:37,column:16},end:{line:37,column:65}},"21":{start:{line:39,column:12},end:{line:39,column:62}},"22":{start:{line:41,column:8},end:{line:44,column:9}},"23":{start:{line:42,column:12},end:{line:42,column:57}},"24":{start:{line:43,column:12},end:{line:43,column:27}},"25":{start:{line:45,column:8},end:{line:45,column:23}},"26":{start:{line:48,column:25},end:{line:48,column:27}},"27":{start:{line:49,column:25},end:{line:49,column:27}},"28":{start:{line:50,column:8},end:{line:50,column:26}},"29":{start:{line:51,column:16},end:{line:51,column:17}},"30":{start:{line:52,column:16},end:{line:52,column:17}},"31":{start:{line:53,column:8},end:{line:85,column:9}},"32":{start:{line:54,column:12},end:{line:84,column:13}},"33":{start:{line:55,column:16},end:{line:55,column:23}},"34":{start:{line:56,column:16},end:{line:56,column:23}},"35":{start:{line:59,column:32},end:{line:61,column:18}},"36":{start:{line:60,column:20},end:{line:60,column:69}},"37":{start:{line:62,column:16},end:{line:83,column:17}},"38":{start:{line:63,column:33},end:{line:63,column:47}},"39":{start:{line:64,column:20},end:{line:64,column:44}},"40":{start:{line:65,column:20},end:{line:65,column:34}},"41":{start:{line:66,column:20},end:{line:66,column:77}},"42":{start:{line:67,column:20},end:{line:67,column:27}},"43":{start:{line:68,column:20},end:{line:68,column:27}},"44":{start:{line:71,column:20},end:{line:73,column:23}},"45":{start:{line:72,column:24},end:{line:72,column:72}},"46":{start:{line:74,column:20},end:{line:80,column:21}},"47":{start:{line:75,column:24},end:{line:75,column:84}},"48":{start:{line:78,column:24},end:{line:78,column:50}},"49":{start:{line:79,column:24},end:{line:79,column:78}},"50":{start:{line:81,column:20},end:{line:81,column:27}},"51":{start:{line:82,column:20},end:{line:82,column:27}},"52":{start:{line:86,column:8},end:{line:89,column:9}},"53":{start:{line:87,column:12},end:{line:87,column:66}},"54":{start:{line:88,column:12},end:{line:88,column:19}},"55":{start:{line:90,column:25},end:{line:90,column:27}},"56":{start:{line:91,column:8},end:{line:94,column:9}},"57":{start:{line:92,column:12},end:{line:92,column:29}},"58":{start:{line:93,column:12},end:{line:93,column:19}},"59":{start:{line:95,column:8},end:{line:97,column:9}},"60":{start:{line:96,column:12},end:{line:96,column:62}},"61":{start:{line:98,column:8},end:{line:98,column:54}},"62":{start:{line:99,column:24},end:{line:99,column:48}},"63":{start:{line:100,column:24},end:{line:100,column:48}},"64":{start:{line:101,column:8},end:{line:101,column:81}},"65":{start:{line:102,column:8},end:{line:102,column:23}},"66":{start:{line:105,column:24},end:{line:105,column:40}},"67":{start:{line:106,column:25},end:{line:106,column:42}},"68":{start:{line:107,column:8},end:{line:111,column:9}},"69":{start:{line:108,column:12},end:{line:110,column:13}},"70":{start:{line:109,column:16},end:{line:109,column:73}},"71":{start:{line:112,column:25},end:{line:112,column:27}},"72":{start:{line:113,column:8},end:{line:117,column:9}},"73":{start:{line:114,column:12},end:{line:116,column:13}},"74":{start:{line:115,column:16},end:{line:115,column:35}},"75":{start:{line:118,column:8},end:{line:120,column:9}},"76":{start:{line:119,column:12},end:{line:119,column:61}},"77":{start:{line:121,column:8},end:{line:121,column:23}},"78":{start:{line:124,column:8},end:{line:124,column:46}},"79":{start:{line:127,column:8},end:{line:161,column:9}},"80":{start:{line:129,column:30},end:{line:129,column:42}},"81":{start:{line:130,column:30},end:{line:130,column:42}},"82":{start:{line:131,column:16},end:{line:131,column:45}},"83":{start:{line:132,column:16},end:{line:132,column:22}},"84":{start:{line:135,column:16},end:{line:135,column:33}},"85":{start:{line:136,column:16},end:{line:136,column:22}},"86":{start:{line:138,column:33},end:{line:138,column:50}},"87":{start:{line:139,column:16},end:{line:149,column:17}},"88":{start:{line:140,column:20},end:{line:140,column:51}},"89":{start:{line:140,column:44},end:{line:140,column:49}},"90":{start:{line:141,column:20},end:{line:143,column:23}},"91":{start:{line:142,column:24},end:{line:142,column:44}},"92":{start:{line:146,column:20},end:{line:148,column:23}},"93":{start:{line:147,column:24},end:{line:147,column:41}},"94":{start:{line:150,column:16},end:{line:150,column:22}},"95":{start:{line:153,column:28},end:{line:153,column:32}},"96":{start:{line:154,column:32},end:{line:154,column:44}},"97":{start:{line:155,column:30},end:{line:155,column:42}},"98":{start:{line:156,column:29},end:{line:156,column:41}},"99":{start:{line:157,column:16},end:{line:157,column:42}},"100":{start:{line:158,column:16},end:{line:158,column:34}},"101":{start:{line:159,column:16},end:{line:159,column:22}},"102":{start:{line:162,column:8},end:{line:162,column:20}},"103":{start:{line:165,column:22},end:{line:165,column:37}},"104":{start:{line:166,column:23},end:{line:166,column:61}},"105":{start:{line:167,column:8},end:{line:176,column:9}},"106":{start:{line:168,column:12},end:{line:172,column:13}},"107":{start:{line:169,column:16},end:{line:169,column:45}},"108":{start:{line:170,column:16},end:{line:170,column:50}},"109":{start:{line:171,column:16},end:{line:171,column:34}},"110":{start:{line:175,column:12},end:{line:175,column:19}},"111":{start:{line:177,column:8},end:{line:177,column:22}},"112":{start:{line:180,column:0},end:{line:180,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:4},end:{line:6,column:5}},loc:{start:{line:6,column:20},end:{line:13,column:5}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:26},end:{line:8,column:27}},loc:{start:{line:8,column:32},end:{line:12,column:9}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:14,column:4},end:{line:14,column:5}},loc:{start:{line:14,column:22},end:{line:29,column:5}},line:14},"3":{name:"(anonymous_3)",decl:{start:{line:30,column:4},end:{line:30,column:5}},loc:{start:{line:30,column:36},end:{line:46,column:5}},line:30},"4":{name:"(anonymous_4)",decl:{start:{line:47,column:4},end:{line:47,column:5}},loc:{start:{line:47,column:41},end:{line:103,column:5}},line:47},"5":{name:"(anonymous_5)",decl:{start:{line:59,column:46},end:{line:59,column:47}},loc:{start:{line:59,column:64},end:{line:61,column:17}},line:59},"6":{name:"(anonymous_6)",decl:{start:{line:71,column:47},end:{line:71,column:48}},loc:{start:{line:71,column:65},end:{line:73,column:21}},line:71},"7":{name:"(anonymous_7)",decl:{start:{line:104,column:4},end:{line:104,column:5}},loc:{start:{line:104,column:42},end:{line:122,column:5}},line:104},"8":{name:"(anonymous_8)",decl:{start:{line:123,column:4},end:{line:123,column:5}},loc:{start:{line:123,column:23},end:{line:125,column:5}},line:123},"9":{name:"(anonymous_9)",decl:{start:{line:126,column:4},end:{line:126,column:5}},loc:{start:{line:126,column:31},end:{line:163,column:5}},line:126},"10":{name:"(anonymous_10)",decl:{start:{line:140,column:34},end:{line:140,column:35}},loc:{start:{line:140,column:44},end:{line:140,column:49}},line:140},"11":{name:"(anonymous_11)",decl:{start:{line:141,column:37},end:{line:141,column:38}},loc:{start:{line:141,column:44},end:{line:143,column:21}},line:141},"12":{name:"(anonymous_12)",decl:{start:{line:146,column:37},end:{line:146,column:38}},loc:{start:{line:146,column:44},end:{line:148,column:21}},line:146},"13":{name:"(anonymous_13)",decl:{start:{line:164,column:4},end:{line:164,column:5}},loc:{start:{line:164,column:25},end:{line:178,column:5}},line:164}},branchMap:{"0":{loc:{start:{line:17,column:12},end:{line:26,column:13}},type:"if",locations:[{start:{line:17,column:12},end:{line:26,column:13}},{start:{line:17,column:12},end:{line:26,column:13}}],line:17},"1":{loc:{start:{line:22,column:16},end:{line:25,column:17}},type:"if",locations:[{start:{line:22,column:16},end:{line:25,column:17}},{start:{line:22,column:16},end:{line:25,column:17}}],line:22},"2":{loc:{start:{line:31,column:8},end:{line:40,column:9}},type:"if",locations:[{start:{line:31,column:8},end:{line:40,column:9}},{start:{line:31,column:8},end:{line:40,column:9}}],line:31},"3":{loc:{start:{line:31,column:12},end:{line:31,column:59}},type:"binary-expr",locations:[{start:{line:31,column:12},end:{line:31,column:33}},{start:{line:31,column:37},end:{line:31,column:59}}],line:31},"4":{loc:{start:{line:32,column:12},end:{line:35,column:13}},type:"if",locations:[{start:{line:32,column:12},end:{line:35,column:13}},{start:{line:32,column:12},end:{line:35,column:13}}],line:32},"5":{loc:{start:{line:36,column:12},end:{line:38,column:13}},type:"if",locations:[{start:{line:36,column:12},end:{line:38,column:13}},{start:{line:36,column:12},end:{line:38,column:13}}],line:36},"6":{loc:{start:{line:36,column:16},end:{line:36,column:61}},type:"binary-expr",locations:[{start:{line:36,column:16},end:{line:36,column:36}},{start:{line:36,column:40},end:{line:36,column:61}}],line:36},"7":{loc:{start:{line:41,column:8},end:{line:44,column:9}},type:"if",locations:[{start:{line:41,column:8},end:{line:44,column:9}},{start:{line:41,column:8},end:{line:44,column:9}}],line:41},"8":{loc:{start:{line:53,column:15},end:{line:53,column:48}},type:"binary-expr",locations:[{start:{line:53,column:15},end:{line:53,column:30}},{start:{line:53,column:34},end:{line:53,column:48}}],line:53},"9":{loc:{start:{line:54,column:12},end:{line:84,column:13}},type:"if",locations:[{start:{line:54,column:12},end:{line:84,column:13}},{start:{line:54,column:12},end:{line:84,column:13}}],line:54},"10":{loc:{start:{line:60,column:27},end:{line:60,column:68}},type:"binary-expr",locations:[{start:{line:60,column:27},end:{line:60,column:36}},{start:{line:60,column:40},end:{line:60,column:68}}],line:60},"11":{loc:{start:{line:62,column:16},end:{line:83,column:17}},type:"if",locations:[{start:{line:62,column:16},end:{line:83,column:17}},{start:{line:62,column:16},end:{line:83,column:17}}],line:62},"12":{loc:{start:{line:72,column:31},end:{line:72,column:71}},type:"binary-expr",locations:[{start:{line:72,column:31},end:{line:72,column:40}},{start:{line:72,column:44},end:{line:72,column:71}}],line:72},"13":{loc:{start:{line:74,column:20},end:{line:80,column:21}},type:"if",locations:[{start:{line:74,column:20},end:{line:80,column:21}},{start:{line:74,column:20},end:{line:80,column:21}}],line:74},"14":{loc:{start:{line:95,column:8},end:{line:97,column:9}},type:"if",locations:[{start:{line:95,column:8},end:{line:97,column:9}},{start:{line:95,column:8},end:{line:97,column:9}}],line:95},"15":{loc:{start:{line:101,column:25},end:{line:101,column:78}},type:"cond-expr",locations:[{start:{line:101,column:59},end:{line:101,column:67}},{start:{line:101,column:70},end:{line:101,column:78}}],line:101},"16":{loc:{start:{line:108,column:12},end:{line:110,column:13}},type:"if",locations:[{start:{line:108,column:12},end:{line:110,column:13}},{start:{line:108,column:12},end:{line:110,column:13}}],line:108},"17":{loc:{start:{line:114,column:12},end:{line:116,column:13}},type:"if",locations:[{start:{line:114,column:12},end:{line:116,column:13}},{start:{line:114,column:12},end:{line:116,column:13}}],line:114},"18":{loc:{start:{line:118,column:8},end:{line:120,column:9}},type:"if",locations:[{start:{line:118,column:8},end:{line:120,column:9}},{start:{line:118,column:8},end:{line:120,column:9}}],line:118},"19":{loc:{start:{line:127,column:8},end:{line:161,column:9}},type:"switch",locations:[{start:{line:128,column:12},end:{line:133,column:13}},{start:{line:134,column:12},end:{line:136,column:22}},{start:{line:137,column:12},end:{line:151,column:13}},{start:{line:152,column:12},end:{line:160,column:13}}],line:127},"20":{loc:{start:{line:139,column:16},end:{line:149,column:17}},type:"if",locations:[{start:{line:139,column:16},end:{line:149,column:17}},{start:{line:139,column:16},end:{line:149,column:17}}],line:139}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0,0],"20":[0,0]},inputSourceMap:{version:3,file:"/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/serializer/json-patch.ts",sources:["/Users/joemyerscough/Documents/GitHub/ptcg-epsd/ptcg-server/src/game/serializer/json-patch.ts"],names:[],mappings:"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",sourcesContent:["import { deepCompare } from '../../utils';\nimport { JsonDiff, JsonPathDiff } from './json-patch.interface';\n\nexport class JsonPatch {\n\n  public diff(src: any, dest: any): JsonDiff[] {\n    const deltas = this.delta(src, dest, [], []);\n    return deltas.map(d => ({\n      op: d.op,\n      path: d.path.join('.'),\n      val: d.val\n    }));\n  }\n\n  public apply(src: any, patch: JsonDiff[]) {\n    let result = src;\n    for (const delta of patch) {\n      if (delta.path === '') {\n        result = this.applyToObject(result, delta);\n      } else {\n        const item = this.fromPath(result, delta.path);\n        if (item !== undefined) {\n          const newValue = this.applyToObject(item.value, delta);\n          item.holder[item.key] = newValue;\n        }\n      }\n    }\n    return result;\n  }\n\n  private delta(src: any, dest: any, path: string[], results: JsonPathDiff[]): JsonPathDiff[] {\n    if (src instanceof Object && dest instanceof Object) {\n      if (src.constructor !== dest.constructor) {\n        results.push({op: 'set', path, val: dest});\n        return results;\n      }\n      if (src instanceof Array && dest instanceof Array) {\n        return this.deltaArray(src, dest, path, results);\n      }\n      return this.deltaObject(src, dest, path, results);\n    }\n    if (src !== dest) {\n      results.push({op: 'set', path, val: dest});\n      return results;\n    }\n    return results;\n  }\n\n  private deltaArray(src: any[], dest: any[], path: string[], results: JsonPathDiff[]): JsonPathDiff[] {\n    const results1: JsonPathDiff[] = [];\n    const results2: JsonPathDiff[] = [];\n    src = src.slice();\n\n    let i: number = 0;\n    let j: number = 0;\n    while (i < dest.length && j < src.length) {\n      if (this.isEqual(src[j], dest[i])) {\n        i += 1;\n        j += 1;\n      } else {\n        let fromIndex = src.findIndex((value, index) => {\n          return index > j && this.isEqual(value, dest[i]);\n        });\n        if (fromIndex !== -1) {\n          const temp = src[fromIndex];\n          src[fromIndex] = src[j];\n          src[j] = temp;\n          results1.push({op: 'move', path, val: [fromIndex, i]});\n          j += 1;\n          i += 1;\n        } else {\n          fromIndex = dest.findIndex((value, index) => {\n            return index > i && this.isEqual(value, src[j]);\n          });\n          if (fromIndex === -1) {\n            this.delta(src[j], dest[i], [...path, String(i)], results1);\n          } else {\n            src.splice(j, 0, dest[i]);\n            results1.push({op: 'add', path, val: [i, dest[i]]});\n          }\n          j += 1;\n          i += 1;\n        }\n      }\n    }\n    while (i < dest.length) {\n      results1.push({op: 'add', path, val: [i, dest[i]]});\n      i += 1;\n    }\n    const toDelete: number[] = [];\n    while (j < src.length) {\n      toDelete.push(j);\n      j += 1;\n    }\n    if (toDelete.length > 0) {\n      results1.push({op: 'del', path, val: toDelete});\n    }\n\n    results2.push({op: 'set', path, val: dest});\n\n    const option1 = JSON.stringify(results1);\n    const option2 = JSON.stringify(results2);\n    results.push(...(option1.length < option2.length ? results1 : results2));\n    return results;\n  }\n\n  private deltaObject(src: any, dest: any, path: string[], results: JsonPathDiff[]): JsonPathDiff[] {\n    const srcKeys = Object.keys(src);\n    const destKeys = Object.keys(dest);\n\n    for (const key of destKeys) {\n      if (!this.isEqual(src[key], dest[key])) {\n        this.delta(src[key], dest[key], [...path, key], results);\n      }\n    }\n\n    const toDelete = [];\n    for (const key of srcKeys) {\n      if (!destKeys.includes(key)) {\n        toDelete.push(key);\n      }\n    }\n    if (toDelete.length > 0) {\n      results.push({op: 'del', path, val: toDelete});\n    }\n\n    return results;\n  }\n\n  private isEqual(src: any, dest: any) {\n    return deepCompare(src, dest);\n  }\n\n  private applyToObject(root: any, delta: JsonDiff): any {\n    switch (delta.op) {\n      case 'add': {\n        const index = delta.val[0];\n        const value = delta.val[1];\n        (root as any[]).splice(index, 0, value);\n        break;\n      }\n      case 'set':\n        root = delta.val;\n        break;\n      case 'del': {\n        const toDelete: any[] = delta.val.slice();\n        if (root instanceof Array) {\n          toDelete.sort((a, b) => b - a);\n          toDelete.forEach(idx => {\n            (root as any[]).splice(idx, 1);\n          });\n        } else {\n          toDelete.forEach(key => {\n            delete root[key];\n          });\n        }\n        break;\n      }\n      case 'move': {\n        const arr: any[] = root as any[];\n        const fromKey: number = delta.val[0];\n        const toKey: number = delta.val[1];\n        const temp = arr[fromKey];\n        arr[fromKey] = arr[toKey];\n        arr[toKey] = temp;\n        break;\n      }\n    }\n    return root;\n  }\n\n  private fromPath(root: any, path: string): { holder: any, key: string, value: any } | undefined {\n    const parts = path.split('.');\n    const result = { holder: root, key: '', value: root };\n    try {\n      for (const part of parts) {\n        result.holder = result.value;\n        result.value = result.value[part];\n        result.key = part;\n      }\n    } catch (error) {\n      return;\n    }\n    return result;\n  }\n\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"689c61d26f1808cdae110d32a8e74be55315e28d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2kn5wpxc9t=function(){return actualCoverage;};}return actualCoverage;}cov_2kn5wpxc9t();cov_2kn5wpxc9t().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_2kn5wpxc9t().s[1]++;exports.JsonPatch=void 0;const utils_1=(cov_2kn5wpxc9t().s[2]++,require("../../utils"));class JsonPatch{diff(src,dest){cov_2kn5wpxc9t().f[0]++;const deltas=(cov_2kn5wpxc9t().s[3]++,this.delta(src,dest,[],[]));cov_2kn5wpxc9t().s[4]++;return deltas.map(d=>{cov_2kn5wpxc9t().f[1]++;cov_2kn5wpxc9t().s[5]++;return{op:d.op,path:d.path.join('.'),val:d.val};});}apply(src,patch){cov_2kn5wpxc9t().f[2]++;let result=(cov_2kn5wpxc9t().s[6]++,src);cov_2kn5wpxc9t().s[7]++;for(const delta of patch){cov_2kn5wpxc9t().s[8]++;if(delta.path===''){cov_2kn5wpxc9t().b[0][0]++;cov_2kn5wpxc9t().s[9]++;result=this.applyToObject(result,delta);}else{cov_2kn5wpxc9t().b[0][1]++;const item=(cov_2kn5wpxc9t().s[10]++,this.fromPath(result,delta.path));cov_2kn5wpxc9t().s[11]++;if(item!==undefined){cov_2kn5wpxc9t().b[1][0]++;const newValue=(cov_2kn5wpxc9t().s[12]++,this.applyToObject(item.value,delta));cov_2kn5wpxc9t().s[13]++;item.holder[item.key]=newValue;}else{cov_2kn5wpxc9t().b[1][1]++;}}}cov_2kn5wpxc9t().s[14]++;return result;}delta(src,dest,path,results){cov_2kn5wpxc9t().f[3]++;cov_2kn5wpxc9t().s[15]++;if((cov_2kn5wpxc9t().b[3][0]++,src instanceof Object)&&(cov_2kn5wpxc9t().b[3][1]++,dest instanceof Object)){cov_2kn5wpxc9t().b[2][0]++;cov_2kn5wpxc9t().s[16]++;if(src.constructor!==dest.constructor){cov_2kn5wpxc9t().b[4][0]++;cov_2kn5wpxc9t().s[17]++;results.push({op:'set',path,val:dest});cov_2kn5wpxc9t().s[18]++;return results;}else{cov_2kn5wpxc9t().b[4][1]++;}cov_2kn5wpxc9t().s[19]++;if((cov_2kn5wpxc9t().b[6][0]++,src instanceof Array)&&(cov_2kn5wpxc9t().b[6][1]++,dest instanceof Array)){cov_2kn5wpxc9t().b[5][0]++;cov_2kn5wpxc9t().s[20]++;return this.deltaArray(src,dest,path,results);}else{cov_2kn5wpxc9t().b[5][1]++;}cov_2kn5wpxc9t().s[21]++;return this.deltaObject(src,dest,path,results);}else{cov_2kn5wpxc9t().b[2][1]++;}cov_2kn5wpxc9t().s[22]++;if(src!==dest){cov_2kn5wpxc9t().b[7][0]++;cov_2kn5wpxc9t().s[23]++;results.push({op:'set',path,val:dest});cov_2kn5wpxc9t().s[24]++;return results;}else{cov_2kn5wpxc9t().b[7][1]++;}cov_2kn5wpxc9t().s[25]++;return results;}deltaArray(src,dest,path,results){cov_2kn5wpxc9t().f[4]++;const results1=(cov_2kn5wpxc9t().s[26]++,[]);const results2=(cov_2kn5wpxc9t().s[27]++,[]);cov_2kn5wpxc9t().s[28]++;src=src.slice();let i=(cov_2kn5wpxc9t().s[29]++,0);let j=(cov_2kn5wpxc9t().s[30]++,0);cov_2kn5wpxc9t().s[31]++;while((cov_2kn5wpxc9t().b[8][0]++,i<dest.length)&&(cov_2kn5wpxc9t().b[8][1]++,j<src.length)){cov_2kn5wpxc9t().s[32]++;if(this.isEqual(src[j],dest[i])){cov_2kn5wpxc9t().b[9][0]++;cov_2kn5wpxc9t().s[33]++;i+=1;cov_2kn5wpxc9t().s[34]++;j+=1;}else{cov_2kn5wpxc9t().b[9][1]++;let fromIndex=(cov_2kn5wpxc9t().s[35]++,src.findIndex((value,index)=>{cov_2kn5wpxc9t().f[5]++;cov_2kn5wpxc9t().s[36]++;return(cov_2kn5wpxc9t().b[10][0]++,index>j)&&(cov_2kn5wpxc9t().b[10][1]++,this.isEqual(value,dest[i]));}));cov_2kn5wpxc9t().s[37]++;if(fromIndex!==-1){cov_2kn5wpxc9t().b[11][0]++;const temp=(cov_2kn5wpxc9t().s[38]++,src[fromIndex]);cov_2kn5wpxc9t().s[39]++;src[fromIndex]=src[j];cov_2kn5wpxc9t().s[40]++;src[j]=temp;cov_2kn5wpxc9t().s[41]++;results1.push({op:'move',path,val:[fromIndex,i]});cov_2kn5wpxc9t().s[42]++;j+=1;cov_2kn5wpxc9t().s[43]++;i+=1;}else{cov_2kn5wpxc9t().b[11][1]++;cov_2kn5wpxc9t().s[44]++;fromIndex=dest.findIndex((value,index)=>{cov_2kn5wpxc9t().f[6]++;cov_2kn5wpxc9t().s[45]++;return(cov_2kn5wpxc9t().b[12][0]++,index>i)&&(cov_2kn5wpxc9t().b[12][1]++,this.isEqual(value,src[j]));});cov_2kn5wpxc9t().s[46]++;if(fromIndex===-1){cov_2kn5wpxc9t().b[13][0]++;cov_2kn5wpxc9t().s[47]++;this.delta(src[j],dest[i],[...path,String(i)],results1);}else{cov_2kn5wpxc9t().b[13][1]++;cov_2kn5wpxc9t().s[48]++;src.splice(j,0,dest[i]);cov_2kn5wpxc9t().s[49]++;results1.push({op:'add',path,val:[i,dest[i]]});}cov_2kn5wpxc9t().s[50]++;j+=1;cov_2kn5wpxc9t().s[51]++;i+=1;}}}cov_2kn5wpxc9t().s[52]++;while(i<dest.length){cov_2kn5wpxc9t().s[53]++;results1.push({op:'add',path,val:[i,dest[i]]});cov_2kn5wpxc9t().s[54]++;i+=1;}const toDelete=(cov_2kn5wpxc9t().s[55]++,[]);cov_2kn5wpxc9t().s[56]++;while(j<src.length){cov_2kn5wpxc9t().s[57]++;toDelete.push(j);cov_2kn5wpxc9t().s[58]++;j+=1;}cov_2kn5wpxc9t().s[59]++;if(toDelete.length>0){cov_2kn5wpxc9t().b[14][0]++;cov_2kn5wpxc9t().s[60]++;results1.push({op:'del',path,val:toDelete});}else{cov_2kn5wpxc9t().b[14][1]++;}cov_2kn5wpxc9t().s[61]++;results2.push({op:'set',path,val:dest});const option1=(cov_2kn5wpxc9t().s[62]++,JSON.stringify(results1));const option2=(cov_2kn5wpxc9t().s[63]++,JSON.stringify(results2));cov_2kn5wpxc9t().s[64]++;results.push(...(option1.length<option2.length?(cov_2kn5wpxc9t().b[15][0]++,results1):(cov_2kn5wpxc9t().b[15][1]++,results2)));cov_2kn5wpxc9t().s[65]++;return results;}deltaObject(src,dest,path,results){cov_2kn5wpxc9t().f[7]++;const srcKeys=(cov_2kn5wpxc9t().s[66]++,Object.keys(src));const destKeys=(cov_2kn5wpxc9t().s[67]++,Object.keys(dest));cov_2kn5wpxc9t().s[68]++;for(const key of destKeys){cov_2kn5wpxc9t().s[69]++;if(!this.isEqual(src[key],dest[key])){cov_2kn5wpxc9t().b[16][0]++;cov_2kn5wpxc9t().s[70]++;this.delta(src[key],dest[key],[...path,key],results);}else{cov_2kn5wpxc9t().b[16][1]++;}}const toDelete=(cov_2kn5wpxc9t().s[71]++,[]);cov_2kn5wpxc9t().s[72]++;for(const key of srcKeys){cov_2kn5wpxc9t().s[73]++;if(!destKeys.includes(key)){cov_2kn5wpxc9t().b[17][0]++;cov_2kn5wpxc9t().s[74]++;toDelete.push(key);}else{cov_2kn5wpxc9t().b[17][1]++;}}cov_2kn5wpxc9t().s[75]++;if(toDelete.length>0){cov_2kn5wpxc9t().b[18][0]++;cov_2kn5wpxc9t().s[76]++;results.push({op:'del',path,val:toDelete});}else{cov_2kn5wpxc9t().b[18][1]++;}cov_2kn5wpxc9t().s[77]++;return results;}isEqual(src,dest){cov_2kn5wpxc9t().f[8]++;cov_2kn5wpxc9t().s[78]++;return utils_1.deepCompare(src,dest);}applyToObject(root,delta){cov_2kn5wpxc9t().f[9]++;cov_2kn5wpxc9t().s[79]++;switch(delta.op){case'add':cov_2kn5wpxc9t().b[19][0]++;{const index=(cov_2kn5wpxc9t().s[80]++,delta.val[0]);const value=(cov_2kn5wpxc9t().s[81]++,delta.val[1]);cov_2kn5wpxc9t().s[82]++;root.splice(index,0,value);cov_2kn5wpxc9t().s[83]++;break;}case'set':cov_2kn5wpxc9t().b[19][1]++;cov_2kn5wpxc9t().s[84]++;root=delta.val;cov_2kn5wpxc9t().s[85]++;break;case'del':cov_2kn5wpxc9t().b[19][2]++;{const toDelete=(cov_2kn5wpxc9t().s[86]++,delta.val.slice());cov_2kn5wpxc9t().s[87]++;if(root instanceof Array){cov_2kn5wpxc9t().b[20][0]++;cov_2kn5wpxc9t().s[88]++;toDelete.sort((a,b)=>{cov_2kn5wpxc9t().f[10]++;cov_2kn5wpxc9t().s[89]++;return b-a;});cov_2kn5wpxc9t().s[90]++;toDelete.forEach(idx=>{cov_2kn5wpxc9t().f[11]++;cov_2kn5wpxc9t().s[91]++;root.splice(idx,1);});}else{cov_2kn5wpxc9t().b[20][1]++;cov_2kn5wpxc9t().s[92]++;toDelete.forEach(key=>{cov_2kn5wpxc9t().f[12]++;cov_2kn5wpxc9t().s[93]++;delete root[key];});}cov_2kn5wpxc9t().s[94]++;break;}case'move':cov_2kn5wpxc9t().b[19][3]++;{const arr=(cov_2kn5wpxc9t().s[95]++,root);const fromKey=(cov_2kn5wpxc9t().s[96]++,delta.val[0]);const toKey=(cov_2kn5wpxc9t().s[97]++,delta.val[1]);const temp=(cov_2kn5wpxc9t().s[98]++,arr[fromKey]);cov_2kn5wpxc9t().s[99]++;arr[fromKey]=arr[toKey];cov_2kn5wpxc9t().s[100]++;arr[toKey]=temp;cov_2kn5wpxc9t().s[101]++;break;}}cov_2kn5wpxc9t().s[102]++;return root;}fromPath(root,path){cov_2kn5wpxc9t().f[13]++;const parts=(cov_2kn5wpxc9t().s[103]++,path.split('.'));const result=(cov_2kn5wpxc9t().s[104]++,{holder:root,key:'',value:root});cov_2kn5wpxc9t().s[105]++;try{cov_2kn5wpxc9t().s[106]++;for(const part of parts){cov_2kn5wpxc9t().s[107]++;result.holder=result.value;cov_2kn5wpxc9t().s[108]++;result.value=result.value[part];cov_2kn5wpxc9t().s[109]++;result.key=part;}}catch(error){cov_2kn5wpxc9t().s[110]++;return;}cov_2kn5wpxc9t().s[111]++;return result;}}cov_2kn5wpxc9t().s[112]++;exports.JsonPatch=JsonPatch;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2pvZW15ZXJzY291Z2gvRG9jdW1lbnRzL0dpdEh1Yi9wdGNnLWVwc2QvcHRjZy1zZXJ2ZXIvc3JjL2dhbWUvc2VyaWFsaXplci9qc29uLXBhdGNoLnRzIiwic291cmNlcyI6WyIvVXNlcnMvam9lbXllcnNjb3VnaC9Eb2N1bWVudHMvR2l0SHViL3B0Y2ctZXBzZC9wdGNnLXNlcnZlci9zcmMvZ2FtZS9zZXJpYWxpemVyL2pzb24tcGF0Y2gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsdUNBQTBDO0FBRzFDLE1BQWEsU0FBUztJQUViLElBQUksQ0FBQyxHQUFRLEVBQUUsSUFBUztRQUM3QixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzdDLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDdEIsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFO1lBQ1IsSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztZQUN0QixHQUFHLEVBQUUsQ0FBQyxDQUFDLEdBQUc7U0FDWCxDQUFDLENBQUMsQ0FBQztJQUNOLENBQUM7SUFFTSxLQUFLLENBQUMsR0FBUSxFQUFFLEtBQWlCO1FBQ3RDLElBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQztRQUNqQixLQUFLLE1BQU0sS0FBSyxJQUFJLEtBQUssRUFBRTtZQUN6QixJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQUssRUFBRSxFQUFFO2dCQUNyQixNQUFNLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDNUM7aUJBQU07Z0JBQ0wsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUMvQyxJQUFJLElB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QUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUIsTUFBTSxNQUFNLEdBQUcsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDO1FBQ3RELElBQUk7WUFDRixLQUFLLE1BQU0sSUFBSSxJQUFJLEtBQUssRUFBRTtnQkFDeEIsTUFBTSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDO2dCQUM3QixNQUFNLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ2xDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDO2FBQ25CO1NBQ0Y7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLE9BQU87U0FDUjtRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7Q0FFRjtBQXZMRCw4QkF1TEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWVwQ29tcGFyZSB9IGZyb20gJy4uLy4uL3V0aWxzJztcbmltcG9ydCB7IEpzb25EaWZmLCBKc29uUGF0aERpZmYgfSBmcm9tICcuL2pzb24tcGF0Y2guaW50ZXJmYWNlJztcblxuZXhwb3J0IGNsYXNzIEpzb25QYXRjaCB7XG5cbiAgcHVibGljIGRpZmYoc3JjOiBhbnksIGRlc3Q6IGFueSk6IEpzb25EaWZmW10ge1xuICAgIGNvbnN0IGRlbHRhcyA9IHRoaXMuZGVsdGEoc3JjLCBkZXN0LCBbXSwgW10pO1xuICAgIHJldHVybiBkZWx0YXMubWFwKGQgPT4gKHtcbiAgICAgIG9wOiBkLm9wLFxuICAgICAgcGF0aDogZC5wYXRoLmpvaW4oJy4nKSxcbiAgICAgIHZhbDogZC52YWxcbiAgICB9KSk7XG4gIH1cblxuICBwdWJsaWMgYXBwbHkoc3JjOiBhbnksIHBhdGNoOiBKc29uRGlmZltdKSB7XG4gICAgbGV0IHJlc3VsdCA9IHNyYztcbiAgICBmb3IgKGNvbnN0IGRlbHRhIG9mIHBhdGNoKSB7XG4gICAgICBpZiAoZGVsdGEucGF0aCA9PT0gJycpIHtcbiAgICAgICAgcmVzdWx0ID0gdGhpcy5hcHBseVRvT2JqZWN0KHJlc3VsdCwgZGVsdGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZnJvbVBhdGgocmVzdWx0LCBkZWx0YS5wYXRoKTtcbiAgICAgICAgaWYgKGl0ZW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdGhpcy5hcHBseVRvT2JqZWN0KGl0ZW0udmFsdWUsIGRlbHRhKTtcbiAgICAgICAgICBpdGVtLmhvbGRlcltpdGVtLmtleV0gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJpdmF0ZSBkZWx0YShzcmM6IGFueSwgZGVzdDogYW55LCBwYXRoOiBzdHJpbmdbXSwgcmVzdWx0czogSnNvblBhdGhEaWZmW10pOiBKc29uUGF0aERpZmZbXSB7XG4gICAgaWYgKHNyYyBpbnN0YW5jZW9mIE9iamVjdCAmJiBkZXN0IGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICBpZiAoc3JjLmNvbnN0cnVjdG9yICE9PSBkZXN0LmNvbnN0cnVjdG9yKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaCh7b3A6ICdzZXQnLCBwYXRoLCB2YWw6IGRlc3R9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICB9XG4gICAgICBpZiAoc3JjIGluc3RhbmNlb2YgQXJyYXkgJiYgZGVzdCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbHRhQXJyYXkoc3JjLCBkZXN0LCBwYXRoLCByZXN1bHRzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmRlbHRhT2JqZWN0KHNyYywgZGVzdCwgcGF0aCwgcmVzdWx0cyk7XG4gICAgfVxuICAgIGlmIChzcmMgIT09IGRlc3QpIHtcbiAgICAgIHJlc3VsdHMucHVzaCh7b3A6ICdzZXQnLCBwYXRoLCB2YWw6IGRlc3R9KTtcbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxuXG4gIHByaXZhdGUgZGVsdGFBcnJheShzcmM6IGFueVtdLCBkZXN0OiBhbnlbXSwgcGF0aDogc3RyaW5nW10sIHJlc3VsdHM6IEpzb25QYXRoRGlmZltdKTogSnNvblBhdGhEaWZmW10ge1xuICAgIGNvbnN0IHJlc3VsdHMxOiBKc29uUGF0aERpZmZbXSA9IFtdO1xuICAgIGNvbnN0IHJlc3VsdHMyOiBKc29uUGF0aERpZmZbXSA9IFtdO1xuICAgIHNyYyA9IHNyYy5zbGljZSgpO1xuXG4gICAgbGV0IGk6IG51bWJlciA9IDA7XG4gICAgbGV0IGo6IG51bWJlciA9IDA7XG4gICAgd2hpbGUgKGkgPCBkZXN0Lmxlbmd0aCAmJiBqIDwgc3JjLmxlbmd0aCkge1xuICAgICAgaWYgKHRoaXMuaXNFcXVhbChzcmNbal0sIGRlc3RbaV0pKSB7XG4gICAgICAgIGkgKz0gMTtcbiAgICAgICAgaiArPSAxO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IGZyb21JbmRleCA9IHNyYy5maW5kSW5kZXgoKHZhbHVlLCBpbmRleCkgPT4ge1xuICAgICAgICAgIHJldHVybiBpbmRleCA+IGogJiYgdGhpcy5pc0VxdWFsKHZhbHVlLCBkZXN0W2ldKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChmcm9tSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgY29uc3QgdGVtcCA9IHNyY1tmcm9tSW5kZXhdO1xuICAgICAgICAgIHNyY1tmcm9tSW5kZXhdID0gc3JjW2pdO1xuICAgICAgICAgIHNyY1tqXSA9IHRlbXA7XG4gICAgICAgICAgcmVzdWx0czEucHVzaCh7b3A6ICdtb3ZlJywgcGF0aCwgdmFsOiBbZnJvbUluZGV4LCBpXX0pO1xuICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICBpICs9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZnJvbUluZGV4ID0gZGVzdC5maW5kSW5kZXgoKHZhbHVlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4ID4gaSAmJiB0aGlzLmlzRXF1YWwodmFsdWUsIHNyY1tqXSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKGZyb21JbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsdGEoc3JjW2pdLCBkZXN0W2ldLCBbLi4ucGF0aCwgU3RyaW5nKGkpXSwgcmVzdWx0czEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzcmMuc3BsaWNlKGosIDAsIGRlc3RbaV0pO1xuICAgICAgICAgICAgcmVzdWx0czEucHVzaCh7b3A6ICdhZGQnLCBwYXRoLCB2YWw6IFtpLCBkZXN0W2ldXX0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBqICs9IDE7XG4gICAgICAgICAgaSArPSAxO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChpIDwgZGVzdC5sZW5ndGgpIHtcbiAgICAgIHJlc3VsdHMxLnB1c2goe29wOiAnYWRkJywgcGF0aCwgdmFsOiBbaSwgZGVzdFtpXV19KTtcbiAgICAgIGkgKz0gMTtcbiAgICB9XG4gICAgY29uc3QgdG9EZWxldGU6IG51bWJlcltdID0gW107XG4gICAgd2hpbGUgKGogPCBzcmMubGVuZ3RoKSB7XG4gICAgICB0b0RlbGV0ZS5wdXNoKGopO1xuICAgICAgaiArPSAxO1xuICAgIH1cbiAgICBpZiAodG9EZWxldGUubGVuZ3RoID4gMCkge1xuICAgICAgcmVzdWx0czEucHVzaCh7b3A6ICdkZWwnLCBwYXRoLCB2YWw6IHRvRGVsZXRlfSk7XG4gICAgfVxuXG4gICAgcmVzdWx0czIucHVzaCh7b3A6ICdzZXQnLCBwYXRoLCB2YWw6IGRlc3R9KTtcblxuICAgIGNvbnN0IG9wdGlvbjEgPSBKU09OLnN0cmluZ2lmeShyZXN1bHRzMSk7XG4gICAgY29uc3Qgb3B0aW9uMiA9IEpTT04uc3RyaW5naWZ5KHJlc3VsdHMyKTtcbiAgICByZXN1bHRzLnB1c2goLi4uKG9wdGlvbjEubGVuZ3RoIDwgb3B0aW9uMi5sZW5ndGggPyByZXN1bHRzMSA6IHJlc3VsdHMyKSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcml2YXRlIGRlbHRhT2JqZWN0KHNyYzogYW55LCBkZXN0OiBhbnksIHBhdGg6IHN0cmluZ1tdLCByZXN1bHRzOiBKc29uUGF0aERpZmZbXSk6IEpzb25QYXRoRGlmZltdIHtcbiAgICBjb25zdCBzcmNLZXlzID0gT2JqZWN0LmtleXMoc3JjKTtcbiAgICBjb25zdCBkZXN0S2V5cyA9IE9iamVjdC5rZXlzKGRlc3QpO1xuXG4gICAgZm9yIChjb25zdCBrZXkgb2YgZGVzdEtleXMpIHtcbiAgICAgIGlmICghdGhpcy5pc0VxdWFsKHNyY1trZXldLCBkZXN0W2tleV0pKSB7XG4gICAgICAgIHRoaXMuZGVsdGEoc3JjW2tleV0sIGRlc3Rba2V5XSwgWy4uLnBhdGgsIGtleV0sIHJlc3VsdHMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHRvRGVsZXRlID0gW107XG4gICAgZm9yIChjb25zdCBrZXkgb2Ygc3JjS2V5cykge1xuICAgICAgaWYgKCFkZXN0S2V5cy5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgIHRvRGVsZXRlLnB1c2goa2V5KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRvRGVsZXRlLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlc3VsdHMucHVzaCh7b3A6ICdkZWwnLCBwYXRoLCB2YWw6IHRvRGVsZXRlfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcml2YXRlIGlzRXF1YWwoc3JjOiBhbnksIGRlc3Q6IGFueSkge1xuICAgIHJldHVybiBkZWVwQ29tcGFyZShzcmMsIGRlc3QpO1xuICB9XG5cbiAgcHJpdmF0ZSBhcHBseVRvT2JqZWN0KHJvb3Q6IGFueSwgZGVsdGE6IEpzb25EaWZmKTogYW55IHtcbiAgICBzd2l0Y2ggKGRlbHRhLm9wKSB7XG4gICAgICBjYXNlICdhZGQnOiB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gZGVsdGEudmFsWzBdO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGRlbHRhLnZhbFsxXTtcbiAgICAgICAgKHJvb3QgYXMgYW55W10pLnNwbGljZShpbmRleCwgMCwgdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3NldCc6XG4gICAgICAgIHJvb3QgPSBkZWx0YS52YWw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZGVsJzoge1xuICAgICAgICBjb25zdCB0b0RlbGV0ZTogYW55W10gPSBkZWx0YS52YWwuc2xpY2UoKTtcbiAgICAgICAgaWYgKHJvb3QgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgIHRvRGVsZXRlLnNvcnQoKGEsIGIpID0+IGIgLSBhKTtcbiAgICAgICAgICB0b0RlbGV0ZS5mb3JFYWNoKGlkeCA9PiB7XG4gICAgICAgICAgICAocm9vdCBhcyBhbnlbXSkuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9EZWxldGUuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgZGVsZXRlIHJvb3Rba2V5XTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ21vdmUnOiB7XG4gICAgICAgIGNvbnN0IGFycjogYW55W10gPSByb290IGFzIGFueVtdO1xuICAgICAgICBjb25zdCBmcm9tS2V5OiBudW1iZXIgPSBkZWx0YS52YWxbMF07XG4gICAgICAgIGNvbnN0IHRvS2V5OiBudW1iZXIgPSBkZWx0YS52YWxbMV07XG4gICAgICAgIGNvbnN0IHRlbXAgPSBhcnJbZnJvbUtleV07XG4gICAgICAgIGFycltmcm9tS2V5XSA9IGFyclt0b0tleV07XG4gICAgICAgIGFyclt0b0tleV0gPSB0ZW1wO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJvb3Q7XG4gIH1cblxuICBwcml2YXRlIGZyb21QYXRoKHJvb3Q6IGFueSwgcGF0aDogc3RyaW5nKTogeyBob2xkZXI6IGFueSwga2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkgfSB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcuJyk7XG4gICAgY29uc3QgcmVzdWx0ID0geyBob2xkZXI6IHJvb3QsIGtleTogJycsIHZhbHVlOiByb290IH07XG4gICAgdHJ5IHtcbiAgICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cykge1xuICAgICAgICByZXN1bHQuaG9sZGVyID0gcmVzdWx0LnZhbHVlO1xuICAgICAgICByZXN1bHQudmFsdWUgPSByZXN1bHQudmFsdWVbcGFydF07XG4gICAgICAgIHJlc3VsdC5rZXkgPSBwYXJ0O1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxufVxuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2VteWVyc2NvdWdoL0RvY3VtZW50cy9HaXRIdWIvcHRjZy1lcHNkL3B0Y2ctc2VydmVyL3NyYy9nYW1lL3NlcmlhbGl6ZXIvanNvbi1wYXRjaC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoia3UwQkFnQkk7Nk5BaEJKLEtBQUEsQ0FBQSxPQUFBLDBCQUFBLE9BQUEsQ0FBQSxhQUFBLENBQUEsQ0FBQSxDQUdBLEtBQWEsQ0FBQSxTQUFTLENBRWIsSUFBSSxDQUFDLEdBQUQsQ0FBVyxJQUFYLENBQW9CLHlCQUM3QixLQUFNLENBQUEsTUFBTSwwQkFBRyxLQUFLLEtBQUwsQ0FBVyxHQUFYLENBQWdCLElBQWhCLENBQXNCLEVBQXRCLENBQTBCLEVBQTFCLENBQUgsQ0FBWixDQUQ2Qix3QkFFN0IsTUFBTyxDQUFBLE1BQU0sQ0FBQyxHQUFQLENBQVcsQ0FBQyxFQUFLLHdEQUN0QixFQUFFLENBQUUsQ0FBQyxDQUFDLEVBRGdCLENBRXRCLElBQUksQ0FBRSxDQUFDLENBQUMsSUFBRixDQUFPLElBQVAsQ0FBWSxHQUFaLENBRmdCLENBR3RCLEdBQUcsQ0FBRSxDQUFDLENBQUMsR0FIZSxFQUl2QixDQUpNLENBQVAsQ0FLRCxDQUVNLEtBQUssQ0FBQyxHQUFELENBQVcsS0FBWCxDQUE0Qix5QkFDdEMsR0FBSSxDQUFBLE1BQU0sMEJBQUcsR0FBSCxDQUFWLENBRHNDLHdCQUV0QyxJQUFLLEtBQU0sQ0FBQSxLQUFYLEdBQW9CLENBQUEsS0FBcEIsQ0FBMkIseUJBQ3pCLEdBQUksS0FBSyxDQUFDLElBQU4sR0FBZSxFQUFuQixDQUF1QixvREFDckIsTUFBTSxDQUFHLEtBQUssYUFBTCxDQUFtQixNQUFuQixDQUEyQixLQUEzQixDQUFULENBQ0QsQ0FGRCxJQUVPLDRCQUNMLEtBQU0sQ0FBQSxJQUFJLDJCQUFHLEtBQUssUUFBTCxDQUFjLE1BQWQsQ0FBc0IsS0FBSyxDQUFDLElBQTVCLENBQUgsQ0FBVixDQURLLHlCQUVMLEdBQUksSUFBSSxHQUFL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LEtBQUssQ0FBQyxHQUFOLENBQVUsQ0FBVixDQUFYLENBQVgsQ0FDQSxLQUFNLENBQUEsSUFBSSwyQkFBRyxHQUFHLENBQUMsT0FBRCxDQUFOLENBQVYsQ0FKVyx5QkFLWCxHQUFHLENBQUMsT0FBRCxDQUFILENBQWUsR0FBRyxDQUFDLEtBQUQsQ0FBbEIsQ0FMVywwQkFNWCxHQUFHLENBQUMsS0FBRCxDQUFILENBQWEsSUFBYixDQU5XLDBCQU9YLE1BQ0QsQ0FoQ0gsQ0FEOEMsMEJBbUM5QyxNQUFPLENBQUEsSUFBUCxDQUNELENBRU8sUUFBUSxDQUFDLElBQUQsQ0FBWSxJQUFaLENBQXdCLDBCQUN0QyxLQUFNLENBQUEsS0FBSyw0QkFBRyxJQUFJLENBQUMsS0FBTCxDQUFXLEdBQVgsQ0FBSCxDQUFYLENBQ0EsS0FBTSxDQUFBLE1BQU0sNEJBQUcsQ0FBRSxNQUFNLENBQUUsSUFBVixDQUFnQixHQUFHLENBQUUsRUFBckIsQ0FBeUIsS0FBSyxDQUFFLElBQWhDLENBQUgsQ0FBWixDQUZzQywwQkFHdEMsR0FBSSwyQkFDRixJQUFLLEtBQU0sQ0FBQSxJQUFYLEdBQW1CLENBQUEsS0FBbkIsQ0FBMEIsMkJBQ3hCLE1BQU0sQ0FBQyxNQUFQLENBQWdCLE1BQU0sQ0FBQyxLQUF2QixDQUR3QiwwQkFFeEIsTUFBTSxDQUFDLEtBQVAsQ0FBZSxNQUFNLENBQUMsS0FBUCxDQUFhLElBQWIsQ0FBZixDQUZ3QiwwQkFHeEIsTUFBTSxDQUFDLEdBQVAsQ0FBYSxJQUFiLENBQ0QsQ0FDRixDQUFDLE1BQU8sS0FBUCxDQUFjLDJCQUNkLE9BQ0QsQ0FYcUMsMEJBWXRDLE1BQU8sQ0FBQSxNQUFQLENBQ0QsQ0FyTG1CLEMsMEJBQXRCLE9BQUEsQ0FBQSxTQUFBLENBQUEsU0FBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVlcENvbXBhcmUgfSBmcm9tICcuLi8uLi91dGlscyc7XG5pbXBvcnQgeyBKc29uRGlmZiwgSnNvblBhdGhEaWZmIH0gZnJvbSAnLi9qc29uLXBhdGNoLmludGVyZmFjZSc7XG5cbmV4cG9ydCBjbGFzcyBKc29uUGF0Y2gge1xuXG4gIHB1YmxpYyBkaWZmKHNyYzogYW55LCBkZXN0OiBhbnkpOiBKc29uRGlmZltdIHtcbiAgICBjb25zdCBkZWx0YXMgPSB0aGlzLmRlbHRhKHNyYywgZGVzdCwgW10sIFtdKTtcbiAgICByZXR1cm4gZGVsdGFzLm1hcChkID0+ICh7XG4gICAgICBvcDogZC5vcCxcbiAgICAgIHBhdGg6IGQucGF0aC5qb2luKCcuJyksXG4gICAgICB2YWw6IGQudmFsXG4gICAgfSkpO1xuICB9XG5cbiAgcHVibGljIGFwcGx5KHNyYzogYW55LCBwYXRjaDogSnNvbkRpZmZbXSkge1xuICAgIGxldCByZXN1bHQgPSBzcmM7XG4gICAgZm9yIChjb25zdCBkZWx0YSBvZiBwYXRjaCkge1xuICAgICAgaWYgKGRlbHRhLnBhdGggPT09ICcnKSB7XG4gICAgICAgIHJlc3VsdCA9IHRoaXMuYXBwbHlUb09iamVjdChyZXN1bHQsIGRlbHRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmZyb21QYXRoKHJlc3VsdCwgZGVsdGEucGF0aCk7XG4gICAgICAgIGlmIChpdGVtICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuYXBwbHlUb09iamVjdChpdGVtLnZhbHVlLCBkZWx0YSk7XG4gICAgICAgICAgaXRlbS5ob2xkZXJbaXRlbS5rZXldID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgZGVsdGEoc3JjOiBhbnksIGRlc3Q6IGFueSwgcGF0aDogc3RyaW5nW10sIHJlc3VsdHM6IEpzb25QYXRoRGlmZltdKTogSnNvblBhdGhEaWZmW10ge1xuICAgIGlmIChzcmMgaW5zdGFuY2VvZiBPYmplY3QgJiYgZGVzdCBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgaWYgKHNyYy5jb25zdHJ1Y3RvciAhPT0gZGVzdC5jb25zdHJ1Y3Rvcikge1xuICAgICAgICByZXN1bHRzLnB1c2goe29wOiAnc2V0JywgcGF0aCwgdmFsOiBkZXN0fSk7XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfVxuICAgICAgaWYgKHNyYyBpbnN0YW5jZW9mIEFycmF5ICYmIGRlc3QgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWx0YUFycmF5KHNyYywgZGVzdCwgcGF0aCwgcmVzdWx0cyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5kZWx0YU9iamVjdChzcmMsIGRlc3QsIHBhdGgsIHJlc3VsdHMpO1xuICAgIH1cbiAgICBpZiAoc3JjICE9PSBkZXN0KSB7XG4gICAgICByZXN1bHRzLnB1c2goe29wOiAnc2V0JywgcGF0aCwgdmFsOiBkZXN0fSk7XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcml2YXRlIGRlbHRhQXJyYXkoc3JjOiBhbnlbXSwgZGVzdDogYW55W10sIHBhdGg6IHN0cmluZ1tdLCByZXN1bHRzOiBKc29uUGF0aERpZmZbXSk6IEpzb25QYXRoRGlmZltdIHtcbiAgICBjb25zdCByZXN1bHRzMTogSnNvblBhdGhEaWZmW10gPSBbXTtcbiAgICBjb25zdCByZXN1bHRzMjogSnNvblBhdGhEaWZmW10gPSBbXTtcbiAgICBzcmMgPSBzcmMuc2xpY2UoKTtcblxuICAgIGxldCBpOiBudW1iZXIgPSAwO1xuICAgIGxldCBqOiBudW1iZXIgPSAwO1xuICAgIHdoaWxlIChpIDwgZGVzdC5sZW5ndGggJiYgaiA8IHNyYy5sZW5ndGgpIHtcbiAgICAgIGlmICh0aGlzLmlzRXF1YWwoc3JjW2pdLCBkZXN0W2ldKSkge1xuICAgICAgICBpICs9IDE7XG4gICAgICAgIGogKz0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBmcm9tSW5kZXggPSBzcmMuZmluZEluZGV4KCh2YWx1ZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4gaW5kZXggPiBqICYmIHRoaXMuaXNFcXVhbCh2YWx1ZSwgZGVzdFtpXSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZnJvbUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgIGNvbnN0IHRlbXAgPSBzcmNbZnJvbUluZGV4XTtcbiAgICAgICAgICBzcmNbZnJvbUluZGV4XSA9IHNyY1tqXTtcbiAgICAgICAgICBzcmNbal0gPSB0ZW1wO1xuICAgICAgICAgIHJlc3VsdHMxLnB1c2goe29wOiAnbW92ZScsIHBhdGgsIHZhbDogW2Zyb21JbmRleCwgaV19KTtcbiAgICAgICAgICBqICs9IDE7XG4gICAgICAgICAgaSArPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZyb21JbmRleCA9IGRlc3QuZmluZEluZGV4KCh2YWx1ZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpbmRleCA+IGkgJiYgdGhpcy5pc0VxdWFsKHZhbHVlLCBzcmNbal0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmIChmcm9tSW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmRlbHRhKHNyY1tqXSwgZGVzdFtpXSwgWy4uLnBhdGgsIFN0cmluZyhpKV0sIHJlc3VsdHMxKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3JjLnNwbGljZShqLCAwLCBkZXN0W2ldKTtcbiAgICAgICAgICAgIHJlc3VsdHMxLnB1c2goe29wOiAnYWRkJywgcGF0aCwgdmFsOiBbaSwgZGVzdFtpXV19KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaiArPSAxO1xuICAgICAgICAgIGkgKz0gMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB3aGlsZSAoaSA8IGRlc3QubGVuZ3RoKSB7XG4gICAgICByZXN1bHRzMS5wdXNoKHtvcDogJ2FkZCcsIHBhdGgsIHZhbDogW2ksIGRlc3RbaV1dfSk7XG4gICAgICBpICs9IDE7XG4gICAgfVxuICAgIGNvbnN0IHRvRGVsZXRlOiBudW1iZXJbXSA9IFtdO1xuICAgIHdoaWxlIChqIDwgc3JjLmxlbmd0aCkge1xuICAgICAgdG9EZWxldGUucHVzaChqKTtcbiAgICAgIGogKz0gMTtcbiAgICB9XG4gICAgaWYgKHRvRGVsZXRlLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlc3VsdHMxLnB1c2goe29wOiAnZGVsJywgcGF0aCwgdmFsOiB0b0RlbGV0ZX0pO1xuICAgIH1cblxuICAgIHJlc3VsdHMyLnB1c2goe29wOiAnc2V0JywgcGF0aCwgdmFsOiBkZXN0fSk7XG5cbiAgICBjb25zdCBvcHRpb24xID0gSlNPTi5zdHJpbmdpZnkocmVzdWx0czEpO1xuICAgIGNvbnN0IG9wdGlvbjIgPSBKU09OLnN0cmluZ2lmeShyZXN1bHRzMik7XG4gICAgcmVzdWx0cy5wdXNoKC4uLihvcHRpb24xLmxlbmd0aCA8IG9wdGlvbjIubGVuZ3RoID8gcmVzdWx0czEgOiByZXN1bHRzMikpO1xuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgcHJpdmF0ZSBkZWx0YU9iamVjdChzcmM6IGFueSwgZGVzdDogYW55LCBwYXRoOiBzdHJpbmdbXSwgcmVzdWx0czogSnNvblBhdGhEaWZmW10pOiBKc29uUGF0aERpZmZbXSB7XG4gICAgY29uc3Qgc3JjS2V5cyA9IE9iamVjdC5rZXlzKHNyYyk7XG4gICAgY29uc3QgZGVzdEtleXMgPSBPYmplY3Qua2V5cyhkZXN0KTtcblxuICAgIGZvciAoY29uc3Qga2V5IG9mIGRlc3RLZXlzKSB7XG4gICAgICBpZiAoIXRoaXMuaXNFcXVhbChzcmNba2V5XSwgZGVzdFtrZXldKSkge1xuICAgICAgICB0aGlzLmRlbHRhKHNyY1trZXldLCBkZXN0W2tleV0sIFsuLi5wYXRoLCBrZXldLCByZXN1bHRzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB0b0RlbGV0ZSA9IFtdO1xuICAgIGZvciAoY29uc3Qga2V5IG9mIHNyY0tleXMpIHtcbiAgICAgIGlmICghZGVzdEtleXMuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICB0b0RlbGV0ZS5wdXNoKGtleSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0b0RlbGV0ZS5sZW5ndGggPiAwKSB7XG4gICAgICByZXN1bHRzLnB1c2goe29wOiAnZGVsJywgcGF0aCwgdmFsOiB0b0RlbGV0ZX0pO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgcHJpdmF0ZSBpc0VxdWFsKHNyYzogYW55LCBkZXN0OiBhbnkpIHtcbiAgICByZXR1cm4gZGVlcENvbXBhcmUoc3JjLCBkZXN0KTtcbiAgfVxuXG4gIHByaXZhdGUgYXBwbHlUb09iamVjdChyb290OiBhbnksIGRlbHRhOiBKc29uRGlmZik6IGFueSB7XG4gICAgc3dpdGNoIChkZWx0YS5vcCkge1xuICAgICAgY2FzZSAnYWRkJzoge1xuICAgICAgICBjb25zdCBpbmRleCA9IGRlbHRhLnZhbFswXTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkZWx0YS52YWxbMV07XG4gICAgICAgIChyb290IGFzIGFueVtdKS5zcGxpY2UoaW5kZXgsIDAsIHZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdzZXQnOlxuICAgICAgICByb290ID0gZGVsdGEudmFsO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2RlbCc6IHtcbiAgICAgICAgY29uc3QgdG9EZWxldGU6IGFueVtdID0gZGVsdGEudmFsLnNsaWNlKCk7XG4gICAgICAgIGlmIChyb290IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICB0b0RlbGV0ZS5zb3J0KChhLCBiKSA9PiBiIC0gYSk7XG4gICAgICAgICAgdG9EZWxldGUuZm9yRWFjaChpZHggPT4ge1xuICAgICAgICAgICAgKHJvb3QgYXMgYW55W10pLnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRvRGVsZXRlLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZSByb290W2tleV07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdtb3ZlJzoge1xuICAgICAgICBjb25zdCBhcnI6IGFueVtdID0gcm9vdCBhcyBhbnlbXTtcbiAgICAgICAgY29uc3QgZnJvbUtleTogbnVtYmVyID0gZGVsdGEudmFsWzBdO1xuICAgICAgICBjb25zdCB0b0tleTogbnVtYmVyID0gZGVsdGEudmFsWzFdO1xuICAgICAgICBjb25zdCB0ZW1wID0gYXJyW2Zyb21LZXldO1xuICAgICAgICBhcnJbZnJvbUtleV0gPSBhcnJbdG9LZXldO1xuICAgICAgICBhcnJbdG9LZXldID0gdGVtcDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByb290O1xuICB9XG5cbiAgcHJpdmF0ZSBmcm9tUGF0aChyb290OiBhbnksIHBhdGg6IHN0cmluZyk6IHsgaG9sZGVyOiBhbnksIGtleTogc3RyaW5nLCB2YWx1ZTogYW55IH0gfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLicpO1xuICAgIGNvbnN0IHJlc3VsdCA9IHsgaG9sZGVyOiByb290LCBrZXk6ICcnLCB2YWx1ZTogcm9vdCB9O1xuICAgIHRyeSB7XG4gICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMpIHtcbiAgICAgICAgcmVzdWx0LmhvbGRlciA9IHJlc3VsdC52YWx1ZTtcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gcmVzdWx0LnZhbHVlW3BhcnRdO1xuICAgICAgICByZXN1bHQua2V5ID0gcGFydDtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbn1cbiJdfQ==